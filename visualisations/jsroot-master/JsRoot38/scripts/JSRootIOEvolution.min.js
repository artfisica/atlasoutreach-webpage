(function(a){if(typeof define==="function"&&define.amd){define(["JSRootCore","rawinflate"],a)}else{if(typeof JSROOT=="undefined"){var b=new Error("This extension requires JSRootCore.js");b.source="JSRootIOEvolution.js";throw b}if(typeof JSROOT.IO=="object"){var b=new Error("This JSROOT IO already loaded");b.source="JSRootIOEvolution.js";throw b}a(JSROOT)}}(function(a){a.IO={kBase:0,kOffsetL:20,kOffsetP:40,kCounter:6,kCharStar:7,kChar:1,kShort:2,kInt:3,kLong:4,kFloat:5,kDouble:8,kDouble32:9,kLegacyChar:10,kUChar:11,kUShort:12,kUInt:13,kULong:14,kBits:15,kLong64:16,kULong64:17,kBool:18,kFloat16:19,kObject:61,kAny:62,kObjectp:63,kObjectP:64,kTString:65,kTObject:66,kTNamed:67,kAnyp:68,kAnyP:69,kAnyPnoVT:70,kSTLp:71,kSkip:100,kSkipL:120,kSkipP:140,kConv:200,kConvL:220,kConvP:240,kSTL:300,kSTLstring:365,kStreamer:500,kStreamLoop:501,kMapOffset:2,kByteCountMask:1073741824,kNewClassTag:4294967295,kClassMask:2147483648,Z_DEFLATED:8,Z_HDRSIZE:9};a.fUserStreamers=null;a.addUserStreamer=function(c,b){if(a.fUserStreamers==null){a.fUserStreamers={}}a.fUserStreamers[c]=b};a.R__unzip_header=function(d,c,b){if(c+a.IO.Z_HDRSIZE>d.length){if(!b){alert("Error R__unzip_header: header size exceeds buffer size")}return -1}if(!(d.charAt(c)=="Z"&&d.charAt(c+1)=="L"&&d.charCodeAt(c+2)==a.IO.Z_DEFLATED)&&!(d.charAt(c)=="C"&&d.charAt(c+1)=="S"&&d.charCodeAt(c+2)==a.IO.Z_DEFLATED)&&!(d.charAt(c)=="X"&&d.charAt(c+1)=="Z"&&d.charCodeAt(c+2)==0)){if(!b){alert("Error R__unzip_header: error in header")}return -1}return a.IO.Z_HDRSIZE+((d.charCodeAt(c+3)&255)|((d.charCodeAt(c+4)&255)<<8)|((d.charCodeAt(c+5)&255)<<16))};a.R__unzip=function(g,f,e,b){if(g<a.IO.Z_HDRSIZE){if(!b){alert("R__unzip: too small source")}return null}if(!(f.charAt(e)=="Z"&&f.charAt(e+1)=="L"&&f.charCodeAt(e+2)==a.IO.Z_DEFLATED)&&!(f.charAt(e)=="C"&&f.charAt(e+1)=="S"&&f.charCodeAt(e+2)==a.IO.Z_DEFLATED)&&!(f.charAt(e)=="X"&&f.charAt(e+1)=="Z"&&f.charCodeAt(e+2)==0)){if(!b){alert("Error R__unzip: error in header")}return null}var c=((f.charCodeAt(e+3)&255)|((f.charCodeAt(e+4)&255)<<8)|((f.charCodeAt(e+5)&255)<<16));if(c+a.IO.Z_HDRSIZE!=g){if(!b){alert("R__unzip: discrepancy in source length")}return null}if(f.charAt(e)=="Z"&&f.charAt(e+1)=="L"){var d=f.substr(e+a.IO.Z_HDRSIZE+2,g);return window.RawInflate.inflate(d)}else{if(!b){alert("R__unzip: Old zlib format is not supported!")}return null}return null};a.ReconstructObject=function(f,b,e){var d=new a.TFile;var c=new a.TBuffer(e,0,d);d.ExtractStreamerInfos(c);var g={};c=new a.TBuffer(b,0,d);c.MapObject(g,1);c.ClassStreamer(g,f);return g};a.TBuffer=function(d,b,c){this._typename="TBuffer";this.b=d;this.o=(b==null)?0:b;this.fFile=c;this.ClearObjectMap();this.fTagOffset=0;return this};a.TBuffer.prototype.locate=function(b){this.o=b};a.TBuffer.prototype.shift=function(b){this.o+=b};a.TBuffer.prototype.ntou1=function(){return(this.b.charCodeAt(this.o++)&255)>>>0};a.TBuffer.prototype.ntou2=function(){var b=((this.b.charCodeAt(this.o)&255)<<8)>>>0;b+=(this.b.charCodeAt(this.o+1)&255)>>>0;this.o+=2;return b};a.TBuffer.prototype.ntou4=function(){var b=((this.b.charCodeAt(this.o)&255)<<24)>>>0;b+=((this.b.charCodeAt(this.o+1)&255)<<16)>>>0;b+=((this.b.charCodeAt(this.o+2)&255)<<8)>>>0;b+=(this.b.charCodeAt(this.o+3)&255)>>>0;this.o+=4;return b};a.TBuffer.prototype.ntou8=function(){var b=((this.b.charCodeAt(this.o)&255)<<56)>>>0;b+=((this.b.charCodeAt(this.o+1)&255)<<48)>>>0;b+=((this.b.charCodeAt(this.o+2)&255)<<40)>>>0;b+=((this.b.charCodeAt(this.o+3)&255)<<32)>>>0;b+=((this.b.charCodeAt(this.o+4)&255)<<24)>>>0;b+=((this.b.charCodeAt(this.o+5)&255)<<16)>>>0;b+=((this.b.charCodeAt(this.o+6)&255)<<8)>>>0;b+=(this.b.charCodeAt(this.o+7)&255)>>>0;this.o+=8;return b};a.TBuffer.prototype.ntoi1=function(){return(this.b.charCodeAt(this.o++)&255)};a.TBuffer.prototype.ntoi2=function(){var b=(this.b.charCodeAt(this.o)&255)<<8;b+=(this.b.charCodeAt(this.o+1)&255);this.o+=2;return b};a.TBuffer.prototype.ntoi4=function(){var b=((this.b.charCodeAt(this.o)&255)<<24)+((this.b.charCodeAt(this.o+1)&255)<<16)+((this.b.charCodeAt(this.o+2)&255)<<8)+((this.b.charCodeAt(this.o+3)&255));this.o+=4;return b};a.TBuffer.prototype.ntoi8=function(c,d){var e=(this.b.charCodeAt(this.o)&255)<<56;e+=(this.b.charCodeAt(this.o+1)&255)<<48;e+=(this.b.charCodeAt(this.o+2)&255)<<40;e+=(this.b.charCodeAt(this.o+3)&255)<<32;e+=(this.b.charCodeAt(this.o+4)&255)<<24;e+=(this.b.charCodeAt(this.o+5)&255)<<16;e+=(this.b.charCodeAt(this.o+6)&255)<<8;e+=(this.b.charCodeAt(this.o+7)&255);this.o+=8;return e};a.TBuffer.prototype.ntof=function(){var c=this.b.substring(this.o,this.o+4);this.o+=4;if(c.length<4){return Number.NaN}var k="";for(var d=0;d<4;d++){var b=(c.charCodeAt(d)&255).toString(2);var e=b.length;if(e<8){for(var h=0;h<(8-e);h++){b="0"+b}}k=k+b}var g=(k.charAt(0)=="1")?-1:1;var j=parseInt(k.substring(1,9),2)-127;var f;if(j==-127){f=0}else{f=1;for(var d=0;d<23;d++){if(parseInt(k.substr(9+d,1))==1){f=f+1/Math.pow(2,d+1)}}}return(g*Math.pow(2,j)*f)};a.TBuffer.prototype.ntod=function(){var c=this.b.substring(this.o,this.o+8);this.o+=8;if(c.length<8){return Number.NaN}var k="";for(var d=0;d<8;d++){var b=(c.charCodeAt(d)&255).toString(2);var e=b.length;if(e<8){for(var h=0;h<(8-e);h++){b="0"+b}}k=k+b}var g=(k.charAt(0)=="1")?-1:1;var j=parseInt(k.substring(1,12),2)-1023;var f;if(j==-127){f=0}else{f=1;for(var d=0;d<52;d++){if(parseInt(k.substr(12+d,1))==1){f=f+1/Math.pow(2,d+1)}}}return(g*Math.pow(2,j)*f)};a.TBuffer.prototype.ReadFastArray=function(e,c){var d=new Array();switch(c){case"D":for(var b=0;b<e;++b){d[b]=this.ntod();if(Math.abs(d[b])<1e-300){d[b]=0}}break;case"F":for(var b=0;b<e;++b){d[b]=this.ntof();if(Math.abs(d[b])<1e-300){d[b]=0}}break;case"L":for(var b=0;b<e;++b){d[b]=this.ntoi8()}break;case"LU":for(var b=0;b<e;++b){d[b]=this.ntou8()}break;case"I":for(var b=0;b<e;++b){d[b]=this.ntoi4()}break;case"U":for(var b=0;b<e;++b){d[b]=this.ntou4()}break;case"S":for(var b=0;b<e;++b){d[b]=this.ntoi2()}break;case"C":for(var b=0;b<e;++b){d[b]=this.b.charCodeAt(this.o++)&255}break;case"TString":for(var b=0;b<e;++b){d[b]=this.ReadTString()}break;default:for(var b=0;b<e;++b){d[b]=this.ntou4()}break}return d};a.TBuffer.prototype.ReadBasicPointer=function(b,d){var c=this.b.charCodeAt(this.o++);if(c===1){return this.ReadFastArray(b,d)}return new Array()};a.TBuffer.prototype.ReadString=function(d){d=typeof(d)!="undefined"?d:0;var b=0;var c=this.o;while((d==0)||(b<d)){if((this.b.charCodeAt(this.o++)&255)==0){break}b++}return(b==0)?"":this.b.substring(c,c+b)};a.TBuffer.prototype.ReadTString=function(){var b=this.b.charCodeAt(this.o++)&255;if(b==255){b=this.ntou4()}var c=this.o;this.o+=b;return(this.b.charCodeAt(c)==0)?"":this.b.substring(c,c+b)};a.TBuffer.prototype.ReadSpecial=function(f,e){var b=this.ReadVersion();var d=null;if(e=="vector<double>"){d=this.ReadFastArray(this.ntoi4(),"D")}else{if(e=="vector<int>"){d=this.ReadFastArray(this.ntoi4(),"I")}else{if(e=="vector<float>"){d=this.ReadFastArray(this.ntoi4(),"F")}else{if(e=="vector<TObject*>"){var j=this.ntoi4();d=[];for(var c=0;c<j;c++){d.push(this.ReadObjectAny())}}else{if(e.indexOf("map<TString,int")==0){var j=this.ntoi4();d=[];for(var c=0;c<j;c++){var h=this.ReadTString();var g=this.ntoi4();d.push({first:h,second:g})}}else{a.console("failed to stream element of type "+e)}}}}}if(!this.CheckBytecount(b,"Reading "+e)){d=null}return d};a.TBuffer.prototype.GetMappedObject=function(b){return this.fObjectMap[b]};a.TBuffer.prototype.MapObject=function(b,c){if(c==null){return}this.fObjectMap[b]=c};a.TBuffer.prototype.MapClass=function(b,c){this.fClassMap[b]=c};a.TBuffer.prototype.GetMappedClass=function(b){if(b in this.fClassMap){return this.fClassMap[b]}return -1};a.TBuffer.prototype.ClearObjectMap=function(){this.fObjectMap={};this.fClassMap={};this.fObjectMap[0]=null};a.TBuffer.prototype.ReadVersion=function(){var b={};var c=this.ntou4();if(c&a.IO.kByteCountMask){b.bytecnt=c-a.IO.kByteCountMask-2}else{this.o-=4}b.val=this.ntou2();b.off=this.o;return b};a.TBuffer.prototype.CheckBytecount=function(b,c){if(("bytecnt" in b)&&(b.off+b.bytecnt!=this.o)){if(c!=null){alert("Missmatch in "+c+" bytecount expected = "+b.bytecnt+"  got = "+(this.o-b.off))}this.o=b.off+b.bytecnt;return false}return true};a.TBuffer.prototype.ReadTObject=function(b){this.o+=2;if((!"_typename" in b)||(b._typename=="")){b._typename="TObject"}b.fUniqueID=this.ntou4();b.fBits=this.ntou4();return true};a.TBuffer.prototype.ReadTNamed=function(c){var b=this.ReadVersion();this.ReadTObject(c);c.fName=this.ReadTString();c.fTitle=this.ReadTString();return this.CheckBytecount(b,"ReadTNamed")};a.TBuffer.prototype.ReadTObjString=function(c){var b=this.ReadVersion();this.ReadTObject(c);c.fString=this.ReadTString();return this.CheckBytecount(b,"ReadTObjString")};a.TBuffer.prototype.ReadTList=function(e){e._typename="TList";e.name="";e.arr=new Array;e.opt=new Array;var b=this.ReadVersion();if(b.val>3){this.ReadTObject(e);e.name=this.ReadTString();var g=this.ntou4();for(var d=0;d<g;++d){var f=this.ReadObjectAny();e.arr.push(f);var c=this.ReadTString();e.opt.push(c)}}return this.CheckBytecount(b)};a.TBuffer.prototype.ReadTObjArray=function(e){e._typename="TObjArray";e.name="";e.arr=new Array();var b=this.ReadVersion();if(b.val>2){this.ReadTObject(e)}if(b.val>1){e.name=this.ReadTString()}var g=this.ntou4();var c=this.ntou4();for(var d=0;d<g;d++){var f=this.ReadObjectAny();e.arr.push(f)}return this.CheckBytecount(b,"ReadTObjArray")};a.TBuffer.prototype.ReadTClonesArray=function(h){h._typename="TClonesArray";h.name="";h.arr=new Array();var g=this.ReadVersion();if(g.val>2){this.ReadTObject(h)}if(g.val>1){h.name=this.ReadTString()}var l=this.ReadTString();var f=l;var k=0;var j=l.indexOf(";");if(j!=-1){f=l.slice(0,j);l=l.slice(j+1,l.length()-j-1);k=parseInt(l)}var b=this.ntou4();if(b<0){b=-b}var c=this.ntou4();for(var e=0;e<b;e++){var d={};this.ClassStreamer(d,f);h.arr.push(d)}return this.CheckBytecount(g,"ReadTClonesArray")};a.TBuffer.prototype.ReadTPolyMarker3D=function(c){var b=this.ReadVersion();this.ReadTObject(c);this.ClassStreamer(c,"TAttMarker");c.fN=this.ntoi4();c.fP=this.ReadFastArray(c.fN*3,"F");c.fOption=this.ReadTString();if(b.val>1){c.fName=this.ReadTString()}else{c.fName="TPolyMarker3D"}return this.CheckBytecount(b,"ReadTPolyMarker3D")};a.TBuffer.prototype.ReadTCollection=function(d,g,f){d._typename="TCollection";d.name="";d.arr=new Array();var b=this.ReadVersion();if(b.val>2){this.ReadTObject(d)}if(b.val>1){d.name=this.ReadTString()}var e=this.ntou4();for(var c=0;c<e;c++){f+=10;d.arr.push(null)}return this.CheckBytecount(b,"ReadTCollection")};a.TBuffer.prototype.ReadTKey=function(c){c.fNbytes=this.ntoi4();c.fVersion=this.ntoi2();c.fObjlen=this.ntou4();var d=this.ntou4();c.fDatime=new Date();c.fDatime.setFullYear((d>>>26)+1995);c.fDatime.setMonth((d<<6)>>>28);c.fDatime.setDate((d<<10)>>>27);c.fDatime.setHours((d<<15)>>>27);c.fDatime.setMinutes((d<<20)>>>26);c.fDatime.setSeconds((d<<26)>>>26);c.fDatime.setMilliseconds(0);c.fKeylen=this.ntou2();c.fCycle=this.ntou2();if(c.fVersion>1000){c.fSeekKey=this.ntou8();this.shift(8)}else{c.fSeekKey=this.ntou4();this.shift(4)}c.fClassName=this.ReadTString();c.fName=this.ReadTString();c.fTitle=this.ReadTString();var b=c.fName.replace(/['"]/g,"");if(b!=c.fName){c.fRealName=c.fName;c.fName=b}return true};a.TBuffer.prototype.ReadTBasket=function(e){this.ReadTKey(e);var b=this.ReadVersion();e.fBufferSize=this.ntoi4();e.fNevBufSize=this.ntoi4();e.fNevBuf=this.ntoi4();e.fLast=this.ntoi4();var c=this.ntoi1();if((c%10)!=2){var d=this.ntoi4();this.o+=d*4;if(c>40){d=this.ntoi4();this.o+=d*4}}if(c==1||c>10){var d=e.fLast;if(b.val<=1){d=this.ntoi4()}this.o+=d}return this.CheckBytecount(b,"ReadTBasket")};a.TBuffer.prototype.ReadTCanvas=function(c){var b=this.ReadVersion();this.ClassStreamer(c,"TPad");c.fDISPLAY=this.ReadTString();c.fDoubleBuffer=this.ntoi4();c.fRetained=this.ntou1()!=0;c.fXsizeUser=this.ntoi4();c.fYsizeUser=this.ntoi4();c.fXsizeReal=this.ntoi4();c.fYsizeReal=this.ntoi4();c.fWindowTopX=this.ntoi4();c.fWindowTopY=this.ntoi4();c.fWindowWidth=this.ntoi4();c.fWindowHeight=this.ntoi4();c.fCw=this.ntou4();c.fCh=this.ntou4();c.fCatt={};this.ClassStreamer(c.fCatt,"TAttCanvas");this.ntou1();this.ntou1();c.fHighLightColor=this.ntoi2();c.fBatch=this.ntou1()!=0;this.ntou1();this.ntou1();this.ntou1();return this.CheckBytecount(b,"TCanvas")};a.TBuffer.prototype.ReadTStreamerInfo=function(c){var b=this.ReadVersion();if(b.val>1){this.ReadTNamed(c);c.fCheckSum=this.ntou4();c.fClassVersion=this.ntou4();c.fElements=this.ReadObjectAny()}return this.CheckBytecount(b,"ReadTStreamerInfo")};a.TBuffer.prototype.ReadStreamerElement=function(b){var c=this.ReadVersion();this.ReadTNamed(b);b.type=this.ntou4();b.size=this.ntou4();b.length=this.ntou4();b.dim=this.ntou4();if(c.val==1){var d=this.ntou4();b.maxindex=this.ReadFastArray(d,"U")}else{b.maxindex=this.ReadFastArray(5,"U")}b.fTypeName=this.ReadTString();b.typename=b.fTypeName;if((b.type==11)&&(b.typename=="Bool_t"||b.typename=="bool")){b.type=18}if(c.val>1){b.uuid=0}if(c.val<=2){}if(c.val==3){b.xmin=this.ntou4();b.xmax=this.ntou4();b.factor=this.ntou4()}if(c.val>3){}return this.CheckBytecount(c,"ReadStreamerElement")};a.TBuffer.prototype.ReadStreamerBase=function(c){var b=this.ReadVersion();this.ReadStreamerElement(c);if(b.val>2){c.baseversion=this.ntou4()}return this.CheckBytecount(b,"ReadStreamerBase")};a.TBuffer.prototype.ReadStreamerSubElement=function(c,d){if(d==null){d=1}var b=this.ReadVersion();if(b.val>d){this.ReadStreamerElement(c)}return this.CheckBytecount(b,"ReadStreamerSubElement")};a.TBuffer.prototype.ReadStreamerBasicPointer=function(c){var b=this.ReadVersion();if(b.val>1){this.ReadStreamerElement(c);c.countversion=this.ntou4();c.countName=this.ReadTString();c.countClass=this.ReadTString()}return this.CheckBytecount(b,"ReadStreamerBasicPointer")};a.TBuffer.prototype.ReadStreamerSTL=function(b){var c=this.ReadVersion();if(c.val>1){this.ReadStreamerElement(b);b.stltype=this.ntou4();b.ctype=this.ntou4()}return this.CheckBytecount(c,"ReadStreamerSTL")};a.TBuffer.prototype.ReadClass=function(){var f={};f.name=-1;var b=0;var e=this.ntou4();var d=this.o;if(!(e&a.IO.kByteCountMask)||(e==a.IO.kNewClassTag)){b=e;e=0}else{b=this.ntou4()}if(!(b&a.IO.kClassMask)){f.objtag=b;return f}if(b==a.IO.kNewClassTag){f.name=this.ReadString();if(this.GetMappedClass(this.fTagOffset+d+a.IO.kMapOffset)==-1){this.MapClass(this.fTagOffset+d+a.IO.kMapOffset,f.name)}}else{var c=(b&~a.IO.kClassMask);f.name=this.GetMappedClass(c);if(f.name==-1){alert("Did not found class with tag "+c)}}return f};a.TBuffer.prototype.ReadObjectAny=function(){var b=this.o;var d=this.ReadClass();if("objtag" in d){return this.GetMappedObject(d.objtag)}if(d.name==-1){return null}var c={};this.MapObject(this.fTagOffset+b+a.IO.kMapOffset,c);this.ClassStreamer(c,d.name);return c};a.TBuffer.prototype.ClassStreamer=function(e,d){if(!("_typename" in e)){e._typename=d}if(d=="TObject"||d=="TMethodCall"){this.ReadTObject(e)}else{if(d=="TQObject"){}else{if(d=="TObjString"){this.ReadTObjString(e)}else{if(d=="TObjArray"){this.ReadTObjArray(e)}else{if(d=="TClonesArray"){this.ReadTClonesArray(e)}else{if((d=="TList")||(d=="THashList")){this.ReadTList(e)}else{if(d=="TCollection"){this.ReadTCollection(e);alert("Trying to read TCollection - wrong!!!")}else{if(d=="TCanvas"){this.ReadTCanvas(e)}else{if(d=="TPolyMarker3D"){this.ReadTPolyMarker3D(e)}else{if(d=="TStreamerInfo"){this.ReadTStreamerInfo(e)}else{if(d=="TStreamerBase"){this.ReadStreamerBase(e)}else{if((d=="TStreamerBasicPointer")||(d=="TStreamerLoop")){this.ReadStreamerBasicPointer(e)}else{if(d=="TStreamerSTL"){this.ReadStreamerSTL(e)}else{if(d=="TStreamerObject"||d=="TStreamerBasicType"||d=="TStreamerObjectAny"||d=="TStreamerString"||d=="TStreamerObjectPointer"){this.ReadStreamerSubElement(e)}else{if(d=="TStreamerObjectAnyPointer"){this.ReadStreamerSubElement(e,0)}else{if(d=="TBasket"){this.ReadTBasket(e)}else{var c=this.fFile.GetStreamer(d);if(c!=null){c.Stream(e,this)}else{a.console("Did not found streamer for class "+d+" try to skip data");var b=this.ReadVersion();this.CheckBytecount(b)}}}}}}}}}}}}}}}}}a.addMethods(e)};a.TStreamer=function(b){this.fFile=b;this._typename="TStreamer";return this};a.TStreamer.prototype.ReadBasicType=function(b,d,f){switch(this[f]["type"]){case a.IO.kBase:break;case a.IO.kOffsetL:break;case a.IO.kOffsetP:break;case a.IO.kCharStar:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"C");break;case a.IO.kChar:case a.IO.kLegacyChar:d[f]=b.b.charCodeAt(b.o++)&255;break;case a.IO.kShort:d[f]=b.ntoi2();break;case a.IO.kInt:case a.IO.kCounter:d[f]=b.ntoi4();break;case a.IO.kLong:d[f]=b.ntoi8();break;case a.IO.kFloat:case a.IO.kDouble32:d[f]=b.ntof();if(Math.abs(d[f])<1e-300){d[f]=0}break;case a.IO.kDouble:d[f]=b.ntod();if(Math.abs(d[f])<1e-300){d[f]=0}break;case a.IO.kUChar:d[f]=(b.b.charCodeAt(b.o++)&255)>>>0;break;case a.IO.kUShort:d[f]=b.ntou2();break;case a.IO.kUInt:d[f]=b.ntou4();break;case a.IO.kULong:d[f]=b.ntou8();break;case a.IO.kBits:alert("failed to stream bits "+f+" ("+this[f]["typename"]+")");break;case a.IO.kLong64:d[f]=b.ntoi8();break;case a.IO.kULong64:d[f]=b.ntou8();break;case a.IO.kBool:d[f]=(b.b.charCodeAt(b.o++)&255)!=0;break;case a.IO.kFloat16:d[f]=0;b.o+=2;break;case a.IO.kAny:case a.IO.kAnyp:case a.IO.kObjectp:case a.IO.kObject:var c=this[f]["typename"];if(c.charAt(c.length-1)=="*"){c=c.substr(0,c.length-1)}d[f]={};b.ClassStreamer(d[f],c);break;case a.IO.kAnyP:case a.IO.kObjectP:d[f]=b.ReadObjectAny();break;case a.IO.kTString:d[f]=b.ReadTString();break;case a.IO.kTObject:b.ReadTObject(d);break;case a.IO.kTNamed:b.ReadTNamed(d);break;case a.IO.kStreamer:d[f]=b.ReadSpecial(this[f]["type"],this[f]["typename"]);break;case a.IO.kOffsetL+a.IO.kShort:case a.IO.kOffsetL+a.IO.kUShort:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"S");break;case a.IO.kOffsetL+a.IO.kInt:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"I");break;case a.IO.kOffsetL+a.IO.kUInt:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"U");break;case a.IO.kOffsetL+a.IO.kULong:case a.IO.kOffsetL+a.IO.kULong64:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"LU");break;case a.IO.kOffsetL+a.IO.kLong:case a.IO.kOffsetL+a.IO.kLong64:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"L");break;case a.IO.kOffsetL+a.IO.kFloat:case a.IO.kOffsetL+a.IO.kDouble32:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"F");break;case a.IO.kOffsetL+a.IO.kDouble:var e=this[f]["length"];d[f]=b.ReadFastArray(e,"D");break;case a.IO.kOffsetP+a.IO.kChar:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"C");break;case a.IO.kOffsetP+a.IO.kShort:case a.IO.kOffsetP+a.IO.kUShort:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"S");break;case a.IO.kOffsetP+a.IO.kInt:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"I");break;case a.IO.kOffsetP+a.IO.kUInt:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"U");break;case a.IO.kOffsetP+a.IO.kULong:case a.IO.kOffsetP+a.IO.kULong64:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"LU");break;case a.IO.kOffsetP+a.IO.kLong:case a.IO.kOffsetP+a.IO.kLong64:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"L");break;case a.IO.kOffsetP+a.IO.kFloat:case a.IO.kOffsetP+a.IO.kDouble32:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"F");break;case a.IO.kOffsetP+a.IO.kDouble:var e=d[this[f]["cntname"]];d[f]=b.ReadBasicPointer(e,"D");break;default:alert("failed to stream "+f+" ("+this[f]["typename"]+")");break}};a.TStreamer.prototype.Stream=function(h,e){var j=e.ReadVersion();for(var b in this){if(!this[b]||typeof(this[b])==="function"){continue}if(this[b]["typename"]!="BASE"){continue}var c=this[b]["class"];if(this[b]["class"].indexOf("TArray")==0){var o=this[b]["class"].charAt(6);var k=e.ntou4();h.fArray=e.ReadFastArray(k,o)}else{e.ClassStreamer(h,this[b]["class"])}}for(var b in this){if(!this[b]||typeof(this[b])==="function"){continue}var d=this[b]["typename"];if(typeof(d)==="undefined"||d==="BASE"){continue}if(a.fUserStreamers!==null){var m=a.fUserStreamers[d];if(m!==undefined){m(e,h,b,this);continue}}switch(d){case"TString*":var l=e.ReadVersion();h[b]=new Array();for(var g=0;g<h[this[b]["cntname"]];++g){h[b][g]=e.ReadTString()}e.CheckBytecount(l,"TString* array");break;case"TArrayC":case"TArrayD":case"TArrayF":case"TArrayI":case"TArrayL":case"TArrayL64":case"TArrayS":var o=this[b]["typename"].charAt(6);var f=e.ntou4();h[b]=e.ReadFastArray(f,o);break;case"TObject":e.ReadTObject(h);break;case"TQObject":break;default:this.ReadBasicType(e,h,b);break}}if(("fBits" in h)&&!("TestBit" in h)){h.TestBit=function(i){return((h.fBits&i)!=0)}}e.CheckBytecount(j,"TStreamer.Stream");return e.o};a.TDirectory=function(d,e,c){if(!(this instanceof arguments.callee)){var b=new Error("you must use new to instantiate this class");b.source="JSROOT.TDirectory.ctor";throw b}this.fFile=d;this._typename="TDirectory";this["dir_name"]=e;this["dir_cycle"]=c;this.fKeys=new Array();return this};a.TDirectory.prototype.GetKey=function(g,c,e){for(var b in this.fKeys){if(this.fKeys[b]["fName"]==g&&this.fKeys[b]["fCycle"]==c){a.CallBack(e,this.fKeys[b]);return this.fKeys[b]}}var j=g.lastIndexOf("/");while(j>0){var f=g.substr(0,j);var h=g.substr(j+1);var d=this.GetKey(f,1);if((d!=null)&&(typeof e=="function")&&(d.fClassName.indexOf("TDirectory")==0)){this.fFile.ReadObject(this["dir_name"]+"/"+f,1,function(i){if(i){i.GetKey(h,c,e)}});return null}j=g.lastIndexOf("/",j-1)}a.CallBack(e,null);return null};a.TDirectory.prototype.ReadKeys=function(b){var e=this;var d=this.fFile;var c=this.fNbytesName+22;c+=4;c+=4;c+=18;if(d.fVersion>=40000){c+=12}d.Seek(this.fSeekDir,this.fFile.ERelativeTo.kBeg);d.ReadBuffer(c,function(h){if(h==null){return a.CallBack(b,null)}var f=new a.TBuffer(h,e.fNbytesName,d);e.StreamHeader(f);f.locate(4);var g=f.ntoi2();if(g>1000){f.shift(28)}else{f.shift(20)}f.ReadTString();f.ReadTString();e.fTitle=f.ReadTString();if(e.fNbytesName<10||e.fNbytesName>10000){a.console("Cannot read directory info of file "+d.fURL);return a.CallBack(b,null)}if(e.fSeekKeys<=0){return a.CallBack(b,null)}d.Seek(e.fSeekKeys,d.ERelativeTo.kBeg);d.ReadBuffer(e.fNbytesKeys,function(n){if(n==null){return a.CallBack(b,null)}var j=new a.TBuffer(n,0,d);var l=d.ReadKey(j);var m=j.ntoi4();for(var k=0;k<m;k++){l=d.ReadKey(j);e.fKeys.push(l)}d.fDirectories.push(e);delete j;a.CallBack(b,e)});delete f})};a.TDirectory.prototype.StreamHeader=function(c){var b=c.ntou2();var d=b%1000;c.shift(8);this.fNbytesKeys=c.ntou4();this.fNbytesName=c.ntou4();this.fSeekDir=(b>1000)?c.ntou8():c.ntou4();this.fSeekParent=(b>1000)?c.ntou8():c.ntou4();this.fSeekKeys=(b>1000)?c.ntou8():c.ntou4();if(d>2){c.shift(18)}};a.TFile=function(d,b){if(!(this instanceof arguments.callee)){var c=new Error("you must use new to instantiate this class");c.source="JSROOT.TFile.ctor";throw c}this._typename="TFile";this.fOffset=0;this.fEND=0;this.fFullURL=d;this.fURL=d;this.fAcceptRanges=true;this.fUseStampPar=new Date;this.fFileContent="";this.ERelativeTo={kBeg:0,kCur:1,kEnd:2};this.fDirectories=new Array();this.fKeys=new Array();this.fSeekInfo=0;this.fNbytesInfo=0;this.fTagOffset=0;this.fStreamers=0;this.fStreamerInfos=null;this.fFileName="";this.fStreamers=new Array;if(typeof this.fURL!="string"){return this}if(this.fURL.charAt(this.fURL.length-1)=="+"){this.fURL=this.fURL.substr(0,this.fURL.length-1);this.fAcceptRanges=false}var g=Math.max(this.fURL.lastIndexOf("/"),this.fURL.lastIndexOf("\\"));this.fFileName=g>=0?this.fURL.substr(g+1):this.fURL;if(!this.fAcceptRanges){this.ReadKeys(b)}else{var e=this;var f=a.NewHttpRequest(this.fURL,"head",function(i){if(i==null){return a.CallBack(b,null)}var j=i.getResponseHeader("Accept-Ranges");if(j==null){e.fAcceptRanges=false}var h=i.getResponseHeader("Content-Length");if(h!=null){e.fEND=parseInt(h)}else{e.fAcceptRanges=false}e.ReadKeys(b)});f.send(null)}return this};a.TFile.prototype.ReadBuffer=function(b,g){if((this.fFileContent.length>0)&&(!this.fAcceptRanges||(this.fOffset+b<=this.fFileContent.length))){return g(this.fFileContent.substr(this.fOffset,b))}var d=this;var c=this.fURL;if(this.fUseStampPar){if(c.indexOf("?")>0){c+="&stamp="}else{c+="?stamp="}c+=this.fUseStampPar.getTime()}function e(h){if((h==null)&&d.fUseStampPar&&(d.fOffset==0)){d.fUseStampPar=false;var i=a.NewHttpRequest(this.fURL,"bin",e);if(this.fAcceptRanges){i.setRequestHeader("Range","bytes="+this.fOffset+"-"+(this.fOffset+b-1))}i.send(null);return}else{if((h!=null)&&(d.fOffset==0)&&(d.fFileContent.length==0)){d.fFileContent=h;if(!this.fAcceptRanges){d.fEND=h.length;h=d.fFileContent.substr(d.fOffset,b)}}}g(h)}var f=a.NewHttpRequest(c,"bin",e);if(this.fAcceptRanges){f.setRequestHeader("Range","bytes="+this.fOffset+"-"+(this.fOffset+b-1))}f.send(null)};a.TFile.prototype.Seek=function(b,c){switch(c){case this.ERelativeTo.kBeg:this.fOffset=b;break;case this.ERelativeTo.kCur:this.fOffset+=b;break;case this.ERelativeTo.kEnd:if(this.fEND==0){throw"Seek : seeking from end in file with fEND==0 is not supported"}this.fOffset=this.fEND-b;break;default:throw"Seek : unknown seek option ("+c+")";break}};a.TFile.prototype.ReadKey=function(b){var c={};b.ReadTKey(c);return c};a.TFile.prototype.GetDir=function(e,d){if((d==null)&&(typeof e=="string")){var f=e.lastIndexOf(";");if(f>0){d=e.substr(f+1);e=e.substr(0,f)}}for(var c in this.fDirectories){var b=this.fDirectories[c];if(b.dir_name!=e){continue}if((d!=null)&&(b.dir_cycle!=d)){continue}return b}return null};a.TFile.prototype.GetKey=function(f,d,b){for(var e in this.fKeys){if(this.fKeys[e]["fName"]==f&&this.fKeys[e]["fCycle"]==d){a.CallBack(b,this.fKeys[e]);return this.fKeys[e]}}var j=f.lastIndexOf("/");while(j>0){var g=f.substr(0,j);var k=f.substr(j+1);var c=this.GetDir(g);if(c!=null){return c.GetKey(k,d,b)}var h=this.GetKey(g,1);if((h!=null)&&(b!=null)&&(h.fClassName.indexOf("TDirectory")==0)){this.ReadObject(g,function(i){if(i){i.GetKey(k,d,b)}});return null}j=f.lastIndexOf("/",j-1)}a.CallBack(b,null);return null};a.TFile.prototype.ReadObjBuffer=function(c,d){var b=this;this.Seek(c.fSeekKey+c.fKeylen,this.ERelativeTo.kBeg);this.ReadBuffer(c.fNbytes-c.fKeylen,function(h){if(h==null){d(null)}var e=null;if(c.fObjlen<=c.fNbytes-c.fKeylen){e=new a.TBuffer(h,0,b)}else{var f=a.R__unzip_header(h,0);if(f<0){return d(null)}var g=a.R__unzip(f,h,0);e=new a.TBuffer(g,0,b)}e.fTagOffset=c.fKeylen;d(e);delete e})};a.TFile.prototype.ReadObject=function(b,e,d){if(typeof e=="function"){d=e;e=1}var f=b.lastIndexOf(";");if(f>0){e=parseInt(b.slice(f+1));b=b.slice(0,f)}if((typeof e!="number")||(e<0)){e=1}while((b.length>0)&&(b[0]=="/")){b=b.substr(1)}var c=this;this.GetKey(b,e,function(i){if(i==null){return a.CallBack(d,null)}if((b=="StreamerInfo")&&(i.fClassName=="TList")){return c.fStreamerInfos}var g=false;if((i.fClassName=="TDirectory"||i.fClassName=="TDirectoryFile")){g=true;var h=c.GetDir(b,e);if(h!=null){return a.CallBack(d,h)}}c.ReadObjBuffer(i,function(k){if(!k){return a.CallBack(d,null)}if(g){var j=new a.TDirectory(c,b,e);j.StreamHeader(k);if(j.fSeekKeys){j.ReadKeys(d)}else{a.CallBack(d,j)}return}var l={};k.MapObject(1,l);k.ClassStreamer(l,i.fClassName);a.CallBack(d,l)})})};a.TFile.prototype.ExtractStreamerInfos=function(c){if(!c){return}var b={};c.MapObject(1,b);c.ClassStreamer(b,"TList");b._typename="TStreamerInfoList";this.fStreamerInfos=b};a.TFile.prototype.ReadFormulas=function(){for(var b in this.fKeys){if(this.fKeys[b]["fClassName"]=="TFormula"){this.ReadObject(this.fKeys[b]["fName"],this.fKeys[b]["fCycle"],function(c){a.addFormula(c)})}}};a.TFile.prototype.ReadStreamerInfos=function(c){if(this.fSeekInfo==0||this.fNbytesInfo==0){return c(null)}this.Seek(this.fSeekInfo,this.ERelativeTo.kBeg);var b=this;b.ReadBuffer(b.fNbytesInfo,function(f){var d=new a.TBuffer(f,0,b);var e=b.ReadKey(d);if(e==null){return c(null)}b.fKeys.push(e);b.ReadObjBuffer(e,function(g){if(g==null){return c(null)}b.ExtractStreamerInfos(g);b.ReadFormulas();c(b)})})};a.TFile.prototype.ReadKeys=function(b){var c=this;this.ReadBuffer(1024,function(g){if(g==null){return a.CallBack(b,null)}if(g.substring(0,4)!="root"){alert("NOT A ROOT FILE! "+c.fURL);return a.CallBack(b,null)}var e=new a.TBuffer(g,4,c);c.fVersion=e.ntou4();c.fBEGIN=e.ntou4();if(c.fVersion<1000000){c.fEND=e.ntou4();c.fSeekFree=e.ntou4();c.fNbytesFree=e.ntou4();var f=e.ntoi4();c.fNbytesName=e.ntou4();c.fUnits=e.ntou1();c.fCompress=e.ntou4();c.fSeekInfo=e.ntou4();c.fNbytesInfo=e.ntou4()}else{c.fEND=e.ntou8();c.fSeekFree=e.ntou8();c.fNbytesFree=e.ntou4();var f=e.ntou4();c.fNbytesName=e.ntou4();c.fUnits=e.ntou1();c.fCompress=e.ntou4();c.fSeekInfo=e.ntou8();c.fNbytesInfo=e.ntou4()}if(!c.fSeekInfo&&!c.fNbytesInfo){return a.CallBack(b,null)}var d=c.fNbytesName+22;d+=4;d+=4;d+=18;if(c.fVersion>=40000){d+=12}c.Seek(c.fBEGIN,c.ERelativeTo.kBeg);c.ReadBuffer(Math.max(300,d),function(j){if(j==null){return a.CallBack(b,null)}var i=new a.TBuffer(j,c.fNbytesName,c);a.TDirectory.prototype.StreamHeader.call(c,i);i.o=4;var h=i.ntoi2();if(h>1000){i.shift(28)}else{i.shift(20)}i.ReadTString();i.ReadTString();c.fTitle=i.ReadTString();if(c.fNbytesName<10||this.fNbytesName>10000){a.console("Init : cannot read directory info of file "+c.fURL);return a.CallBack(b,null)}if(c.fSeekKeys<=0){a.console("Empty keys list - not supported"+c.fURL);return a.CallBack(b,null)}c.Seek(c.fSeekKeys,c.ERelativeTo.kBeg);c.ReadBuffer(c.fNbytesKeys,function(o){if(o==null){return a.CallBack(b,null)}var m=new a.TBuffer(o,0,c);var l=c.ReadKey(m);var n=m.ntoi4();for(var k=0;k<n;k++){l=c.ReadKey(m);c.fKeys.push(l)}c.ReadStreamerInfos(b);delete m});delete i});delete e})};a.TFile.prototype.ReadDirectory=function(d,c,b){return this.ReadObject(d,c,b)};a.TFile.prototype.GetStreamer=function(e){var f=this.fStreamers[e];if(typeof(f)!="undefined"){return f}var g;if(this.fStreamerInfos){for(var d in this.fStreamerInfos.arr){if(this.fStreamerInfos.arr[d].fName==e){g=this.fStreamerInfos.arr[d];break}}}if(typeof g=="undefined"){return null}this.fStreamers[e]=new a.TStreamer(this);if(typeof(g.fElements)!="undefined"){var h=g.fElements["arr"].length;for(var b=0;b<h;++b){var c=g.fElements["arr"][b];if(c.typename==="BASE"){this.GetStreamer(c.fName)}}}if(typeof(g.fElements)!="undefined"){var h=g.fElements["arr"].length;for(var b=0;b<h;++b){var c=g.fElements["arr"][b];var f={};f.typename=c.typename;f["class"]=c.fName;f.cntname=c.countName;f.type=c.type;f.length=c.length;this.fStreamers[e][c.fName]=f}}return this.fStreamers[e]};a.TFile.prototype.Delete=function(){if(this.fDirectories){this.fDirectories.splice(0,this.fDirectories.length)}this.fDirectories=null;if(this.fKeys){this.fKeys.splice(0,this.fKeys.length)}this.fKeys=null;if(this.fStreamers){this.fStreamers.splice(0,this.fStreamers.length)}this.fStreamers=null;this.fSeekInfo=0;this.fNbytesInfo=0;this.fTagOffset=0};return a}));