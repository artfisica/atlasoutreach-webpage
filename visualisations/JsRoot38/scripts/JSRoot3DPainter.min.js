(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui","d3","JSRootPainter","THREE","jquery.mousewheel"],a)}else{if(typeof JSROOT=="undefined"){var b=new Error("JSROOT is not defined");b.source="JSRoot3DPainter.js";throw b}if(typeof d3!="object"){var b=new Error("This extension requires d3.v3.js");b.source="JSRoot3DPainter.js";throw b}if(typeof JSROOT.Painter!="object"){var b=new Error("JSROOT.Painter is not defined");b.source="JSRoot3DPainter.js";throw b}if(typeof THREE=="undefined"){var b=new Error("THREE is not defined");b.source="JSRoot3DPainter.js";throw b}a(jQuery,jQuery.ui,d3,JSROOT)}}(function(c,d,b,a){a.Painter.add3DInteraction=function(m,h,l,r,p){var g,f,i=false;var k={x:0,y:0},o;var s=function(){var v="tt";var G=3;var x=3;var F=150;var y=10;var w=20;var B=95;var z=0;var C,H,D,E,A;var u=document.all?true:false;return{show:function(I,t){if(C==null){C=document.createElement("div");C.setAttribute("id",v);H=document.createElement("div");H.setAttribute("id",v+"top");D=document.createElement("div");D.setAttribute("id",v+"cont");E=document.createElement("div");E.setAttribute("id",v+"bot");C.appendChild(H);C.appendChild(D);C.appendChild(E);document.body.appendChild(C);C.style.opacity=0;C.style.filter="alpha(opacity=0)";document.onmousemove=this.pos}C.style.display="block";D.innerHTML=I;C.style.width=t?t+"px":"auto";C.style.width="auto";if(!t&&u){H.style.display="none";E.style.display="none";C.style.width=C.offsetWidth;H.style.display="block";E.style.display="block"}A=parseInt(C.offsetHeight)+G;clearInterval(C.timer);C.timer=setInterval(function(){s.fade(1)},w)},pos:function(J){var I=u?event.clientY+document.documentElement.scrollTop:J.pageY;var t=u?event.clientX+document.documentElement.scrollLeft:J.pageX;C.style.top=I+15+"px";C.style.left=(t+x)+"px"},fade:function(J){var t=z;if((t!=B&&J==1)||(t!=0&&J==-1)){var I=y;if(B-t<y&&J==1){I=B-t}else{if(z<y&&J==-1){I=t}}z=t+(I*J);C.style.opacity=z*0.01;C.style.filter="alpha(opacity="+z+")"}else{clearInterval(C.timer);if(J==-1){C.style.display="none"}}},hide:function(){if(C==null){return}clearInterval(C.timer);C.timer=setInterval(function(){s.fade(-1)},w)}}}();var j=100;var e=0;var n=new THREE.Projector();function q(){if(i){if(o){o.material.emissive.setHex(o.currentHex);m.render(h,l)}o=null;if(a.gStyle.Tooltip){s.hide()}return}var t=new THREE.Vector3(k.x,k.y,1);n.unprojectVector(t,l);var u=new THREE.Raycaster(l.position,t.sub(l.position).normalize());var x=u.intersectObjects(h.children,true);if(x.length>0){var w=null;for(var v=0;v<x.length;++v){if("emissive" in x[v].object.material){w=x[v];break}}if(w&&o!=w.object){if(o){o.material.emissive.setHex(o.currentHex)}o=w.object;o.currentHex=o.material.emissive.getHex();o.material.emissive.setHex(6250335);m.render(h,l);if(a.gStyle.Tooltip){s.show(o.name.length>0?o.name:o.parent.name,200)}}}else{if(o){o.material.emissive.setHex(o.currentHex);m.render(h,l)}o=null;if(a.gStyle.Tooltip){s.hide()}}}c(m.domElement).on("touchstart mousedown",function(t){if(a.gStyle.Tooltip){s.hide()}t.preventDefault();var u=t;if("changedTouches" in t){u=t.changedTouches[0]}else{if("touches" in t){u=t.touches[0]}else{if("originalEvent" in t){if("changedTouches" in t.originalEvent){u=t.originalEvent.changedTouches[0]}else{if("touches" in t.originalEvent){u=t.originalEvent.touches[0]}}}}}g=u.pageX;f=u.pageY;i=true});c(m.domElement).on("touchmove mousemove",function(x){if(i){var y=x;if("changedTouches" in x){y=x.changedTouches[0]}else{if("touches" in x){y=x.touches[0]}else{if("originalEvent" in x){if("changedTouches" in x.originalEvent){y=x.originalEvent.changedTouches[0]}else{if("touches" in x.originalEvent){y=x.originalEvent.touches[0]}}}}}var w=y.pageX-g;var v=y.pageY-f;if((v>0&&r.rotation.x<Math.PI*3/4)||(v<0&&r.rotation.x>-Math.PI/4)){r.rotation.x+=v*0.02}r.rotation.y+=w*0.02;m.render(h,l);g=y.pageX;f=y.pageY}else{x.preventDefault();var u="offsetX" in x.originalEvent?x.originalEvent.offsetX:x.originalEvent.layerX;var t="offsetY" in x.originalEvent?x.originalEvent.offsetY:x.originalEvent.layerY;k.x=(u/m.domElement.width)*2-1;k.y=-(t/m.domElement.height)*2+1;q()}});c(m.domElement).on("touchend mouseup",function(t){i=false});c(m.domElement).on("mousewheel",function(t,u){t.preventDefault();l.position.z+=u*20;m.render(h,l)});c(m.domElement).on("contextmenu",function(t){t.preventDefault();if(a.gStyle.Tooltip){s.hide()}a.Painter.createMenu(function(u){if(p){u.add("header:"+p.histo.fName)}u.add(a.gStyle.Tooltip?"Disable tooltip":"Enable tooltip",function(){a.gStyle.Tooltip=!a.gStyle.Tooltip;s.hide()});if(p){u.add("Switch to 2D",function(){c(p.svg_pad().node()).show().parent().find(m.domElement).remove();s.hide();p.Draw2D()})}u.add("Close");u.show(t.originalEvent)})})};a.Painter.real_drawHistogram2D=function(o){var ae=o.pad_width(),ao=o.pad_height(),q=100;var s=o.xmin,ac=o.xmax;if(o.zoom_xmin!=o.zoom_xmax){s=o.zoom_xmin;ac=o.zoom_xmax}var V=o.ymin,m=o.ymax;if(o.zoom_ymin!=o.zoom_ymax){V=o.zoom_ymin;m=o.zoom_ymax}var am,H,ak,G,ai,E;if(o.options.Logx){am=b.scale.log().domain([s,ac]).range([-q,q]);H=b.scale.log().domain([-q,q]).range([s,ac])}else{am=b.scale.linear().domain([s,ac]).range([-q,q]);H=b.scale.linear().domain([-q,q]).range([s,ac])}if(o.options.Logy){ak=b.scale.log().domain([V,m]).range([-q,q]);G=b.scale.log().domain([q,-q]).range([V,m])}else{ak=b.scale.linear().domain([V,m]).range([-q,q]);G=b.scale.linear().domain([q,-q]).range([V,m])}if(o.options.Logz){ai=b.scale.log().domain([o.gminbin,Math.ceil(o.gmaxbin/100)*105]).range([0,q*2]);E=b.scale.log().domain([0,q*2]).range([o.gminbin,Math.ceil(o.gmaxbin/100)*105])}else{ai=b.scale.linear().domain([o.gminbin,Math.ceil(o.gmaxbin/100)*105]).range([0,q*2]);E=b.scale.linear().domain([0,q*2]).range([o.gminbin,Math.ceil(o.gmaxbin/100)*105])}var Q=(q*2/o.nbinsx)/o.gmaxbin;var P=(q*2/o.nbinsy)/o.gmaxbin;var Z=(o.options.Color>0);var r=b.rgb(a.Painter.root_colors[o.histo.fFillColor]);var N=o.CreateDrawBins(100,100,2,(a.gStyle.Tooltip?1:0));var R=new THREE.Scene();var D=new THREE.Object3D();D.rotation.x=30*Math.PI/180;D.rotation.y=30*Math.PI/180;R.add(D);var e=new THREE.MeshBasicMaterial({color:0,wireframe:true,wireframeLinewidth:0.5,side:THREE.DoubleSide});var f=new THREE.Mesh(new THREE.BoxGeometry(q*2,q*2,q*2),e);var x=new THREE.BoxHelper(f);x.material.color.set(0);var p=new THREE.Object3D();p.add(x);p.position.y=q;D.add(p);var C=new THREE.MeshBasicMaterial({color:0});var z=new THREE.LineBasicMaterial({color:0});var F;var af=new Array();var T,ap,M=3,J,K=Math.sin(45);var I,S;var B=am.ticks(8);var ab=am.ticks(50);for(var an=-q,al=0,aj=0;an<q;++an){var ah=(H(an)<=B[al]&&H(an+1)>B[al])?true:false;var W=(H(an)<=ab[aj]&&H(an+1)>ab[aj])?true:false;J=(ah?M+2:M)*K;if(ah){I=new THREE.TextGeometry(B[al],{size:7,height:0,curveSegments:10});++al;I.computeBoundingBox();var g=0.5*(I.boundingBox.max.x-I.boundingBox.min.x);S=new THREE.Mesh(I,C);S.position.set(an-g,-13,q+J);D.add(S);S=new THREE.Mesh(I,C);S.position.set(an+g,-13,-q-J);S.rotation.y=Math.PI;D.add(S)}if(ah||W){++aj;F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(an,0,q));F.vertices.push(new THREE.Vector3(an,-J,q+J));D.add(new THREE.Line(F,z));af.push(F);F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(an,0,-q));F.vertices.push(new THREE.Vector3(an,-J,-q-J));D.add(new THREE.Line(F,z));af.push(F)}}var A=ak.ticks(8);var aa=ak.ticks(50);for(var an=q,al=0,aj=0;an>-q;--an){var ah=(G(an)<=A[al]&&G(an-1)>A[al])?true:false;var W=(G(an)<=aa[aj]&&G(an-1)>aa[aj])?true:false;J=(ah?M+2:M)*K;if(ah){I=new THREE.TextGeometry(A[al],{size:7,height:0,curveSegments:10});++al;I.computeBoundingBox();var g=0.5*(I.boundingBox.max.x-I.boundingBox.min.x);S=new THREE.Mesh(I,C);S.position.set(q+J,-13,an+g);S.rotation.y=Math.PI/2;D.add(S);S=new THREE.Mesh(I,C);S.position.set(-q-J,-13,an-g);S.rotation.y=-Math.PI/2;D.add(S)}if(ah||W){++aj;F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(q,0,an));F.vertices.push(new THREE.Vector3(q+J,-J,an));D.add(new THREE.Line(F,z));af.push(F);F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(-q,0,an));F.vertices.push(new THREE.Vector3(-q-J,-J,an));D.add(new THREE.Line(F,z));af.push(F)}}var y=ai.ticks(8);var Y=ai.ticks(50);for(var an=0,al=0,aj=0;an<(q*2);++an){var ah=(E(an)<=y[al]&&E(an+1)>y[al])?true:false;var W=(E(an)<=Y[aj]&&E(an+1)>Y[aj])?true:false;J=(ah?M+2:M)*K;if(ah){I=new THREE.TextGeometry(y[al],{size:7,height:0,curveSegments:10});++al;I.computeBoundingBox();var ad=0.8*(I.boundingBox.max.x-I.boundingBox.min.x);S=new THREE.Mesh(I,C);S.position.set(q+ad+5,an-2.5,q+ad+5);S.rotation.y=Math.PI*3/4;D.add(S);S=new THREE.Mesh(I,C);S.position.set(q+ad+5,an-2.5,-q-ad-5);S.rotation.y=-Math.PI*3/4;D.add(S);S=new THREE.Mesh(I,C);S.position.set(-q-ad-5,an-2.5,q+ad+5);S.rotation.y=Math.PI/4;D.add(S);S=new THREE.Mesh(I,C);S.position.set(-q-ad-5,an-2.5,-q-ad-5);S.rotation.y=-Math.PI/4;D.add(S)}if(ah||W){++aj;F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(q,an,q));F.vertices.push(new THREE.Vector3(q+J,an,q+J));D.add(new THREE.Line(F,z));af.push(F);F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(q,an,-q));F.vertices.push(new THREE.Vector3(q+J,an,-q-J));D.add(new THREE.Line(F,z));af.push(F);F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(-q,an,q));F.vertices.push(new THREE.Vector3(-q-J,an,q+J));D.add(new THREE.Line(F,z));af.push(F);F=new THREE.Geometry();F.vertices.push(new THREE.Vector3(-q,an,-q));F.vertices.push(new THREE.Vector3(-q-J,an,-q-J));D.add(new THREE.Line(F,z));af.push(F)}}var ag=0;while(af[ag]){af[ag].dispose();ag++}var v=new THREE.Color(14540253);v.setRGB(r.r/255,r.g/255,r.b/255);var u,O,n,aq;for(var an=0;an<N.length;++an){aq=N[an];n=ai(aq.z);u=new THREE.Mesh(new THREE.BoxGeometry(2*q/o.nbinsx,n,2*q/o.nbinsy),new THREE.MeshLambertMaterial({color:v.getHex(),shading:THREE.NoShading}));x=new THREE.BoxHelper(u);x.material.color.set(0);x.material.linewidth=1;u.position.x=am(aq.x);u.position.y=n/2;u.position.z=-(ak(aq.y));if(a.gStyle.Tooltip){u.name=aq.tip}D.add(u);R.add(x)}delete N;N=null;var L=new THREE.PerspectiveCamera(45,ae/ao,1,4000);var l=new THREE.PointLight(13619151);L.add(l);l.position.set(10,10,10);L.position.set(0,q/2,500);L.lookat=f;R.add(L);var U={canvas:!!window.CanvasRenderingContext2D,webgl:(function(){try{return !!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(h){return false}})(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob};var X=U.webgl?new THREE.WebGLRenderer({antialias:true}):new THREE.CanvasRenderer({antialias:true});X.setClearColor(16777215,1);X.setSize(ae,ao);c(o.svg_pad().node()).hide().parent().append(X.domElement);X.render(R,L);a.Painter.add3DInteraction(X,R,L,D,o)};a.Painter.drawHistogram3D=function(aj,m,ap,ah){var aI=false,aH=false,aG=false,M=false,K=false,I=false;ah.SetDivId(aj,-1);var s=ah.root_pad();var n;if(!ah.svg_pad().empty()){n=c(ah.svg_pad().node()).hide().parent()}else{n=c("#"+aj)}var ap=m.fOption.toLowerCase();if(s){aI=s.fLogx;aH=s.fLogy;aG=s.fLogz;M=s.fGridx;K=s.fGridy;I=s.fGridz}var ai=a.Painter.root_colors[m.fFillColor];var aF=a.Painter.root_colors[m.fLineColor];if(m.fFillColor==0){ai="#4572A7"}if(m.fLineColor==0){aF="#4572A7"}var an=m.fXaxis["fNbins"];var am=m.fYaxis["fNbins"];var al=m.fZaxis["fNbins"];var N=(m.fXaxis["fXmax"]-m.fXaxis["fXmin"])/m.fXaxis["fNbins"];var L=(m.fYaxis["fXmax"]-m.fYaxis["fXmin"])/m.fYaxis["fNbins"];var J=(m.fZaxis["fXmax"]-m.fZaxis["fXmin"])/m.fZaxis["fNbins"];var q=-1e+32,H=1e+32;q=b.max(m.fArray);H=b.min(m.fArray);var av=new Array();for(var U=0;U<=an+2;++U){for(var T=0;T<am+2;++T){for(var R=0;R<al+2;++R){var O=m.getBinContent(U,T,R);if(O>H){var f={x:m.fXaxis["fXmin"]+(U*N),y:m.fYaxis["fXmin"]+(T*L),z:m.fZaxis["fXmin"]+(R*J),n:O};av.push(f)}}}}var D=n.width(),W=n.height(),E=100;if(W<10){n.height(0.66*D);W=n.height()}if(aI){var ac=b.scale.log().domain([m.fXaxis["fXmin"],m.fXaxis["fXmax"]]).range([-E,E]);var az=b.scale.log().domain([-E,E]).range([m.fXaxis["fXmin"],m.fXaxis["fXmax"]])}else{var ac=b.scale.linear().domain([m.fXaxis["fXmin"],m.fXaxis["fXmax"]]).range([-E,E]);var az=b.scale.linear().domain([-E,E]).range([m.fXaxis["fXmin"],m.fXaxis["fXmax"]])}if(aH){var ab=b.scale.log().domain([m.fYaxis["fXmin"],m.fYaxis["fXmax"]]).range([-E,E]);var ay=b.scale.log().domain([E,-E]).range([m.fYaxis["fXmin"],m.fYaxis["fXmax"]])}else{var ab=b.scale.linear().domain([m.fYaxis["fXmin"],m.fYaxis["fXmax"]]).range([-E,E]);var ay=b.scale.linear().domain([E,-E]).range([m.fYaxis["fXmin"],m.fYaxis["fXmax"]])}if(aG){var aa=b.scale.log().domain([m.fZaxis["fXmin"],m.fZaxis["fXmax"]]).range([-E,E]);var ax=b.scale.log().domain([-E,E]).range([m.fZaxis["fXmin"],m.fZaxis["fXmax"]])}else{var aa=b.scale.linear().domain([m.fZaxis["fXmin"],m.fZaxis["fXmax"]]).range([-E,E]);var ax=b.scale.linear().domain([-E,E]).range([m.fZaxis["fXmin"],m.fZaxis["fXmax"]])}var C=new THREE.Scene();var P=new THREE.Object3D();P.rotation.x=30*Math.PI/180;P.rotation.y=30*Math.PI/180;C.add(P);var ad=new THREE.MeshBasicMaterial({color:0,wireframe:true,wireframeLinewidth:0.5,side:THREE.DoubleSide});var Y=new THREE.Mesh(new THREE.BoxGeometry(E*2,E*2,E*2),ad);var Z=new THREE.BoxHelper(Y);Z.material.color.set(0);P.add(Z);var V=new THREE.MeshBasicMaterial({color:0});var aA=new THREE.LineBasicMaterial({color:0});var ao;var au=new Array();var aE,ag,ak=3,ae,aB=Math.sin(45);var aq,at;var S=ac.ticks(5);var e=ac.ticks(25);for(var U=-E,T=0,R=0;U<=E;++U){var v=(az(U)<=S[T]&&az(U+1)>S[T])?true:false;var G=(az(U)<=e[R]&&az(U+1)>e[R])?true:false;ae=(v?ak+2:ak)*aB;if(v){aq=new THREE.TextGeometry(S[T],{size:7,height:0,curveSegments:10});++T;aq.computeBoundingBox();var l=0.5*(aq.boundingBox.max.x-aq.boundingBox.min.x);at=new THREE.Mesh(aq,V);at.position.set(U-l,-E-13,E+ae);P.add(at);at=new THREE.Mesh(aq,V);at.position.set(U+l,-E-13,-E-ae);at.rotation.y=Math.PI;P.add(at)}if(v||G){++R;ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(U,-E,E));ao.vertices.push(new THREE.Vector3(U,-E-ae,E+ae));P.add(new THREE.Line(ao,aA));au.push(ao);ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(U,-E,-E));ao.vertices.push(new THREE.Vector3(U,-E-ae,-E-ae));P.add(new THREE.Line(ao,aA));au.push(ao)}}var x=ab.ticks(5);var aC=ab.ticks(25);for(var U=E,T=0,R=0;U>-E;--U){var v=(ay(U)<=x[T]&&ay(U-1)>x[T])?true:false;var G=(ay(U)<=aC[R]&&ay(U-1)>aC[R])?true:false;ae=(v?ak+2:ak)*aB;if(v){aq=new THREE.TextGeometry(x[T],{size:7,height:0,curveSegments:10});++T;aq.computeBoundingBox();var l=0.5*(aq.boundingBox.max.x-aq.boundingBox.min.x);at=new THREE.Mesh(aq,V);at.position.set(E+ae,-E-13,U+l);at.rotation.y=Math.PI/2;P.add(at);at=new THREE.Mesh(aq,V);at.position.set(-E-ae,-E-13,U-l);at.rotation.y=-Math.PI/2;P.add(at)}if(v||G){++R;ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(E,-E,U));ao.vertices.push(new THREE.Vector3(E+ae,-E-ae,U));P.add(new THREE.Line(ao,aA));au.push(ao);ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(-E,-E,U));ao.vertices.push(new THREE.Vector3(-E-ae,-E-ae,U));P.add(new THREE.Line(ao,aA));au.push(ao)}}var r=aa.ticks(5);var ar=aa.ticks(25);for(var U=-E,T=0,R=0;U<=E;++U){var v=(ax(U)<=r[T]&&ax(U+1)>r[T])?true:false;var G=(ax(U)<=ar[R]&&ax(U+1)>ar[R])?true:false;ae=(v?ak+2:ak)*aB;if(v){aq=new THREE.TextGeometry(r[T],{size:7,height:0,curveSegments:10});++T;aq.computeBoundingBox();var p=0.6*(aq.boundingBox.max.x-aq.boundingBox.min.x);at=new THREE.Mesh(aq,V);at.position.set(E+p+7,U-2.5,E+p+7);at.rotation.y=Math.PI*3/4;P.add(at);at=new THREE.Mesh(aq,V);at.position.set(E+p+7,U-2.5,-E-p-7);at.rotation.y=-Math.PI*3/4;P.add(at);at=new THREE.Mesh(aq,V);at.position.set(-E-p-7,U-2.5,E+p+7);at.rotation.y=Math.PI/4;P.add(at);at=new THREE.Mesh(aq,V);at.position.set(-E-p-7,U-2.5,-E-p-7);at.rotation.y=-Math.PI/4;P.add(at)}if(v||G){++R;ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(E,U,E));ao.vertices.push(new THREE.Vector3(E+ae,U,E+ae));P.add(new THREE.Line(ao,aA));au.push(ao);ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(E,U,-E));ao.vertices.push(new THREE.Vector3(E+ae,U,-E-ae));P.add(new THREE.Line(ao,aA));au.push(ao);ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(-E,U,E));ao.vertices.push(new THREE.Vector3(-E-ae,U,E+ae));P.add(new THREE.Line(ao,aA));au.push(ao);ao=new THREE.Geometry();ao.vertices.push(new THREE.Vector3(-E,U,-E));ao.vertices.push(new THREE.Vector3(-E-ae,U,-E-ae));P.add(new THREE.Line(ao,aA));au.push(ao)}}var F=0;while(au[F]){au[F].dispose();F++}var B=(E*2/m.fXaxis["fNbins"])/q;var A=(E*2/m.fYaxis["fNbins"])/q;var y=(E*2/m.fZaxis["fNbins"])/q;var aD=(ap.indexOf("colz")!=-1||ap.indexOf("col")!=-1);var o=b.rgb(a.Painter.root_colors[m.fFillColor]);var ai=new THREE.Color(14540253);ai.setRGB(o.r/255,o.g/255,o.b/255);var u,X,z;for(var U=0;U<av.length;++U){z=(aD?q:av[U].n);if(ap.indexOf("box1")!=-1){u=new THREE.Mesh(new THREE.SphereGeometry(0.5*z*B),new THREE.MeshPhongMaterial({color:ai.getHex(),specular:5197647}))}else{u=new THREE.Mesh(new THREE.BoxGeometry(z*B,z*y,z*A),new THREE.MeshLambertMaterial({color:ai.getHex(),shading:THREE.NoShading}));Z=new THREE.BoxHelper(u);Z.material.color.set(0);Z.material.linewidth=1;C.add(Z)}u.position.x=ac(av[U].x-(N/2));u.position.y=aa(av[U].z-(J/2));u.position.z=-(ab(av[U].y-(L/2)));u.name="x: ["+av[U].x.toPrecision(4)+", "+(av[U].x+N).toPrecision(4)+"]<br/>y: ["+av[U].y.toPrecision(4)+", "+(av[U].y+L).toPrecision(4)+"]<br/>z: ["+av[U].z.toPrecision(4)+", "+(av[U].z+J).toPrecision(4)+"]<br/>entries: "+av[U].n.toFixed();P.add(u)}var aw=new THREE.PerspectiveCamera(45,D/W,1,4000);var Q=new THREE.PointLight(15724527);aw.add(Q);Q.position.set(10,10,10);aw.position.set(0,0,500);aw.lookat=Y;C.add(aw);var g={canvas:!!window.CanvasRenderingContext2D,webgl:(function(){try{return !!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(h){return false}})(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob};var af=g.webgl?new THREE.WebGLRenderer({antialias:true}):new THREE.CanvasRenderer({antialias:true});af.setClearColor(16777215,1);af.setSize(D,W);n.append(af.domElement);af.render(C,aw);a.Painter.add3DInteraction(af,C,aw,P,null);return ah.DrawingReady()};return a.Painter}));