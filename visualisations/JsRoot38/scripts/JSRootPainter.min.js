(function(a){if(typeof define==="function"&&define.amd){define(["JSRootCore","d3"],a)}else{if(typeof JSROOT=="undefined"){var b=new Error("JSROOT is not defined");b.source="JSRootPainter.js";throw b}if(typeof d3!="object"){var b=new Error("d3 is not defined");b.source="JSRootPainter.js";throw b}if(typeof JSROOT.Painter=="object"){var b=new Error("JSROOT.Painter already defined");b.source="JSRootPainter.js";throw b}a(JSROOT,d3)}}(function(a,b){if(typeof define==="function"&&define.amd){a.loadScript("$$$style/JSRootPainter.css")}a.DrawFuncs={lst:[],cache:{}};a.addDrawFunc=function(c,d,e){if((arguments.length==1)&&(typeof arguments[0]=="object")){a.DrawFuncs.lst.push(arguments[0]);return arguments[0]}var f={name:c,func:d,opt:e};a.DrawFuncs.lst.push(f);return f};a.gStyle={Tooltip:true,ContextMenu:true,Zooming:true,MoveResize:true,DragAndDrop:true,OptimizeDraw:1,DefaultCol:1,AutoStat:true,OptStat:1111,OptFit:0,FrameNDC:{fX1NDC:0.07,fY1NDC:0.12,fX2NDC:0.95,fY2NDC:0.88},StatNDC:{fX1NDC:0.78,fY1NDC:0.75,fX2NDC:0.98,fY2NDC:0.91},StatText:{fTextAngle:0,fTextSize:9,fTextAlign:12,fTextColor:1,fTextFont:42},StatFill:{fFillColor:0,fFillStyle:1001},TimeOffset:788918400000,StatFormat:"6.4g",FitFormat:"5.4g",MathJax:0,Palette:null,Interpolate:"basis"};a.Painter={};a.Painter.HLStoRGB=function(j,i,n){var c,k,m;if(n<1e-300){c=k=m=i}else{function f(l,h,g){if(g<0){g+=1}if(g>1){g-=1}if(g<1/6){return l+(h-l)*6*g}if(g<1/2){return h}if(g<2/3){return l+(h-l)*(2/3-g)*6}return l}var d=i<0.5?i*(1+n):i+n-i*n;var e=2*i-d;c=f(e,d,j+1/3);k=f(e,d,j);m=f(e,d,j-1/3)}return"rgb("+Math.round(c*255)+","+Math.round(k*255)+","+Math.round(m*255)+")"};a.gStyle.GetColorPalette=function(g){if(this.Palette==null){this.Palette=[];var f=1,l=0.5,d=280,c=0,k=50;for(var e=0;e<k;e++){var h=(d-(e+1)*((d-c)/k))/360;var j=a.Painter.HLStoRGB(h,l,f);this.Palette.push(j)}}if(g==null){return this.Palette}if(g<0){return this.Palette[0]}if(g>=this.Palette.length){return this.Palette[this.Palette.length-1]}return this.Palette[g]};a.Painter.createMenu=function(c,d){document.body.style.cursor="wait";a.AssertPrerequisites("jq2d",function(){document.body.style.cursor="auto";a.Painter.createMenu(c,d)})};a.Painter.closeMenu=function(d){if(!d){d="root_ctx_menu"}var c=document.getElementById(d);if(c){c.parentNode.removeChild(c)}};a.Painter.readStyleFromURL=function(f){var h=a.GetUrlOption("optimize",f);if(h==""){a.gStyle.OptimizeDraw=2}else{if(h!=null){a.gStyle.OptimizeDraw=parseInt(h);if(isNaN(a.gStyle.OptimizeDraw)){a.gStyle.OptimizeDraw=2}}}var c=a.GetUrlOption("interactive",f);if((c=="")||(c=="1")){c="11111"}else{if(c=="0"){c="00000"}}if((c!=null)&&(c.length==5)){a.gStyle.Tooltip=(c.charAt(0)!="0");a.gStyle.ContextMenu=(c.charAt(1)!="0");a.gStyle.Zooming=(c.charAt(2)!="0");a.gStyle.MoveResize=(c.charAt(3)!="0");a.gStyle.DragAndDrop=(c.charAt(4)!="0")}var e=a.GetUrlOption("col",f);if(e!=null){e=parseInt(e);if(!isNaN(e)&&(e>0)&&(e<4)){a.gStyle.DefaultCol=e}}var g=a.GetUrlOption("mathjax",f);if((g!=null)&&(g!="0")){a.MathJax=1}if(a.GetUrlOption("nomenu",f)!=null){a.gStyle.ContextMenu=false}a.gStyle.OptStat=a.GetUrlOption("optstat",f,a.gStyle.OptStat);a.gStyle.OptFit=a.GetUrlOption("optfit",f,a.gStyle.OptFit);a.gStyle.StatFormat=a.GetUrlOption("statfmt",f,a.gStyle.StatFormat);a.gStyle.FitFormat=a.GetUrlOption("fitfmt",f,a.gStyle.FitFormat);var d=a.GetUrlOption("interpolate",f);if(d!=null){a.gStyle.Interpolate=d}};a.Painter.Coord={kCARTESIAN:1,kPOLAR:2,kCYLINDRICAL:3,kSPHERICAL:4,kRAPIDITY:5};a.Painter.root_colors=function(){var q=new Array("white","black","red","green","blue","rgb(255,255,0)","rgb(255,0,255)","rgb(0,255,255)","rgb(89, 211,84)","rgb(89,84,216)","rgb(254,254,254)","rgb(191,181,173)","rgb(76,76,76)","rgb(102,102,102)","rgb(127,127,127)","rgb(153,153,153)","rgb(178,178,178)","rgb(204,204,204)","rgb(229,229,229)","rgb(242,242,242)","rgb(204,198,170)","rgb(204,198,170)","rgb(193,191,168)","rgb(186,181,163)","rgb(178,165,150)","rgb(183,163,155)","rgb(173,153,140)","rgb(155,142,130)","rgb(135,102,86)","rgb(175,206,198)","rgb(132,193,163)","rgb(137,168,160)","rgb(130,158,140)","rgb(173,188,198)","rgb(122,142,153)","rgb(117,137,145)","rgb(104,130,150)","rgb(109,122,132)","rgb(124,153,209)","rgb(127,127,155)","rgb(170,165,191)","rgb(211,206,135)","rgb(221,186,135)","rgb(188,158,130)","rgb(198,153,124)","rgb(191,130,119)","rgb(206,94,96)","rgb(170,142,147)","rgb(165,119,122)","rgb(147,104,112)","rgb(211,89,84)");var c=[632,416,600,400,616,432];var w=[800,820,840,860,880,900];var o=[255,204,204,255,153,153,204,153,153,255,102,102,204,102,102,153,102,102,255,51,51,204,51,51,153,51,51,102,51,51,255,0,0,204,0,0,153,0,0,102,0,0,51,0,0];var n=[204,255,204,153,255,153,153,204,153,102,255,102,102,204,102,102,153,102,51,255,51,51,204,51,51,153,51,51,102,51,0,255,0,0,204,0,0,153,0,0,102,0,0,51,0];var m=[204,204,255,153,153,255,153,153,204,102,102,255,102,102,204,102,102,153,51,51,255,51,51,204,51,51,153,51,51,102,0,0,255,0,0,204,0,0,153,0,0,102,0,0,51];var l=[255,255,204,255,255,153,204,204,153,255,255,102,204,204,102,153,153,102,255,255,51,204,204,51,153,153,51,102,102,51,255,255,0,204,204,0,153,153,0,102,102,0,51,51,0];var k=[255,204,255,255,153,255,204,153,204,255,102,255,204,102,204,153,102,153,255,51,255,204,51,204,153,51,153,102,51,102,255,0,255,204,0,204,153,0,153,102,0,102,51,0,51];var g=[204,255,255,153,255,255,153,204,204,102,255,255,102,204,204,102,153,153,51,255,255,51,204,204,51,153,153,51,102,102,0,255,255,0,204,204,0,153,153,0,102,102,0,51,51];var x=new Array(o,n,m,l,k,g);var f=[255,204,153,204,153,102,153,102,51,153,102,0,204,153,51,255,204,102,255,153,0,255,204,51,204,153,0,255,204,0,255,153,51,204,102,0,102,51,0,153,51,0,204,102,51,255,153,102,255,102,0,255,102,51,204,51,0,255,51,0];var e=[153,255,51,102,204,0,51,102,0,51,153,0,102,204,51,153,255,102,102,255,0,102,255,51,51,204,0,51,255,0,204,255,153,153,204,102,102,153,51,102,153,0,153,204,51,204,255,102,153,255,0,204,255,51,153,204,0,204,255,0];var d=[153,255,204,102,204,153,51,153,102,0,153,102,51,204,153,102,255,204,0,255,102,51,255,204,0,204,153,0,255,204,51,255,153,0,204,102,0,102,51,0,153,51,51,204,102,102,255,153,0,255,153,51,255,102,0,204,51,0,255,51];var v=[153,204,255,102,153,204,51,102,153,0,51,153,51,102,204,102,153,255,0,102,255,51,102,255,0,51,204,0,51,255,51,153,255,0,102,204,0,51,102,0,102,153,51,153,204,102,204,255,0,153,255,51,204,255,0,153,204,0,204,255];var u=[204,153,255,153,102,204,102,51,153,102,0,153,153,51,204,204,102,255,153,0,255,204,51,255,153,0,204,204,0,255,153,51,255,102,0,204,51,0,102,51,0,153,102,51,204,153,102,255,102,0,255,102,51,255,51,0,204,51,0,255];var t=[255,51,153,204,0,102,102,0,51,153,0,51,204,51,102,255,102,153,255,0,102,255,51,102,204,0,51,255,0,51,255,153,204,204,102,153,153,51,102,153,0,102,204,51,153,255,102,204,255,0,153,204,0,153,255,51,204,255,0,153];var h=new Array(f,e,d,v,u,t);for(var s=0;s<6;s++){for(var r=0;r<15;r++){var p=c[s]+r-10;q[p]="rgb("+x[s][3*r]+","+x[s][3*r+1]+","+x[s][3*r+2]+")";p=w[s]+r-9;q[p]="rgb("+h[s][3*r]+","+h[s][3*r+1]+","+h[s][3*r+2]+")"}}return q}();a.Painter.adoptRootColors=function(f){if(!f||!f.arr){return}for(var g in f.arr){var e=f.arr[g];if((e==null)||(e._typename!="TColor")){continue}var d=e.fNumber;if((d<0)||(d>4096)){continue}var c="rgb("+(e.fRed*255).toFixed(0)+","+(e.fGreen*255).toFixed(0)+","+(e.fBlue*255).toFixed(0)+")";if(c=="rgb(255,255,255)"){c="white"}while(d>a.Painter.root_colors.length){a.Painter.root_colors.push(c)}if(a.Painter.root_colors[d]!=c){a.Painter.root_colors[d]=c}}};a.Painter.root_line_styles=new Array("","","3, 3","1, 2","3, 4, 1, 4","5, 3, 1, 3","5, 3, 1, 3, 1, 3, 1, 3","5, 5","5, 3, 1, 3, 1, 3","20, 5","20, 10, 1, 10","1, 2");a.Painter.root_markers=new Array("fcircle","fcircle","oplus","oasterisk","ocircle","omult","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fcircle","fsquare","ftriangle-up","ftriangle-down","ocircle","osquare","otriangle-up","odiamond","ocross","fstar","ostar","dcross","otriangle-down","fdiamond","fcross");a.Painter.createAttMarker=function(f,c){if(c==null){c=f.fMarkerStyle}var d=(c<a.Painter.root_markers.length)?a.Painter.root_markers[c]:"fcircle";var i=0,e=true;if(typeof(d)!="undefined"){if(d.charAt(0)=="0"){e=false}switch(d.substr(1)){case"circle":i=0;break;case"cross":i=1;break;case"diamond":i=2;break;case"square":i=3;break;case"triangle-up":i=4;break;case"triangle-down":i=5;break;case"star":i=6;break;case"asterisk":i=7;break;case"plus":i=8;break;case"mult":i=9;break}}var k=f.fMarkerSize;var g=64;if(c==1){g=1}var h=a.Painter.root_colors[f.fMarkerColor];var j={stroke:h,fill:h,marker:""};if(!e){j.fill="none"}switch(i){case 6:j.marker="M"+(-4*k)+","+(-1*k)+" L"+4*k+","+(-1*k)+" L"+(-2.4*k)+","+4*k+" L0,"+(-4*k)+" L"+2.8*k+","+4*k+" z";break;case 7:j.marker="M "+(-4*k)+","+(-4*k)+" L"+4*k+","+4*k+" M 0,"+(-4*k)+" L 0,"+4*k+" M "+4*k+","+(-4*k)+" L "+(-4*k)+","+4*k+" M "+(-4*k)+",0 L "+4*k+",0";break;case 8:j.marker="M 0,"+(-4*k)+" L 0,"+4*k+" M "+(-4*k)+",0 L "+4*k+",0";break;case 9:j.marker="M "+(-4*k)+","+(-4*k)+" L"+4*k+","+4*k+" M "+4*k+","+(-4*k)+" L "+(-4*k)+","+4*k;break;default:j.marker=b.svg.symbol().type(b.svg.symbolTypes[i]).size(k*g)}j.SetMarker=function(l){l.style("fill",this.fill).style("stroke",this.stroke).style("pointer-events","visibleFill").attr("d",this.marker)};j.func=j.SetMarker.bind(j);return j};a.Painter.createAttLine=function(h,f){var e=0,c=0,g=0;if(h=="black"){e=1;c=1}else{if(h=="none"){c=0}else{if(typeof h=="object"){if("fLineColor" in h){e=h.fLineColor}if("fLineWidth" in h){c=h.fLineWidth}if("fLineStyle" in h){g=h.fLineStyle}}}}if(f!=null){c=f}var d={color:a.Painter.root_colors[e],width:c,dash:a.Painter.root_line_styles[g]};if((c==0)||(e==0)){d.color="none"}d.SetLine=function(i){i.style("stroke",this.color);if(this.color!="none"){i.style("stroke-width",this.width);i.style("stroke-dasharray",this.dash)}};d.func=d.SetLine.bind(d);return d};a.Painter.clearCuts=function(c){var f=c.indexOf("[");var e=c.indexOf("]");if((f>=0)&&(e>=0)&&(f<e)){for(var d=f;d<=e;d++){c[d]=" "}}return c};a.Painter.root_fonts=new Array("Arial","Times New Roman","bold Times New Roman","bold italic Times New Roman","Arial","oblique Arial","bold Arial","bold oblique Arial","Courier New","oblique Courier New","bold Courier New","bold oblique Courier New","Symbol","Times New Roman","Wingdings","Symbol");a.Painter.getFontDetails=function(f,d){var e=a.Painter.root_fonts[Math.floor(f/10)];var c={name:"Arial",size:11,weight:null,style:null};if(d!=null){c.size=Math.round(d)}if(e==null){e=""}if(e.indexOf("bold")!=-1){c.weight="bold";e=e.substring(5,e.length)}if(e.charAt(0)=="i"){c.style="italic";e=e.substring(7,e.length)}else{if(e.charAt(0)=="o"){c.style="oblique";e=e.substring(8,e.length)}}if(name=="Symbol"){c.weight=null;c.style=null}c.name=e;c.SetFont=function(g){g.attr("font-family",this.name).attr("font-size",this.size).attr("xml:space","preserve");if(this.weight!=null){g.attr("font-weight",this.weight)}if(this.style!=null){g.attr("font-style",this.style)}};c.asStyle=function(g){return((g!=null)?g:this.size)+"px "+this.name};c.stringWidth=function(i,h){var j=i.append("svg:text").attr("xml:space","preserve").style("opacity",0).text(h);this.SetFont(j);var g=j.node().getBBox().width;j.remove();return g};c.func=c.SetFont.bind(c);return c};a.Painter.padtoX=function(d,c){if(d.fLogx&&c<50){return Math.exp(2.302585092994*c)}return c};a.Painter.ytoPad=function(d,c){if(c.fLogy){if(d>0){d=a.Math.log10(d)}else{d=c.fUymin}}return d};a.Painter.chooseTimeFormat=function(d,e){if(e<1){e=1}var f=d/e;var c=0;if(f>=0.5){c=1;if(f>=30){f/=60;c=2;if(f>=30){f/=60;c=3;if(f>=12){f/=24;c=4;if(f>=15.218425){f/=30.43685;c=5;if(f>=6){f/=12;c=6;if(f>=2){f/=12;c=7}}}}}}}switch(c){case 0:return"%S";case 1:return"%Mm%S";case 2:return"%Hh%M";case 3:return"%d-%Hh";case 4:return"%d/%m";case 5:return"%d/%m/%y";case 6:return"%d/%m/%y";case 7:return"%m/%y"}return"%Y"};a.Painter.getTimeFormat=function(c){var e=c.fTimeFormat;var d=e.indexOf("%F");if(d>=0){return e.substr(0,d)}return e};a.Painter.getTimeOffset=function(d){var f=d.fTimeFormat.indexOf("%F");if(f<0){return a.gStyle.TimeOffset}var c=d.fTimeFormat.substr(f+2);if(c=="1995-01-01 00:00:00s0"){return 788918400000}if((c=="0")||(c=="")){return 0}var e=new Date(0);var g=c.indexOf("-");e.setFullYear(c.substr(0,g));c=c.substr(g+1);g=c.indexOf("-");e.setMonth(parseInt(c.substr(0,g))-1);c=c.substr(g+1);g=c.indexOf(" ");e.setDate(c.substr(0,g));c=c.substr(g+1);g=c.indexOf(":");e.setHours(c.substr(0,g));c=c.substr(g+1);g=c.indexOf(":");e.setMinutes(c.substr(0,g));c=c.substr(g+1);g=c.indexOf("s");e.setSeconds(c.substr(0,g));if(g>0){c=c.substr(g+1);e.setMilliseconds(c)}return e.getTime()};a.Painter.formatExp=function(l){var k=l;if(parseFloat(k)==1){return"1"}if(parseFloat(k)==10){return"10"}var k=k.replace("e+","x10@");var k=k.replace("e-","x10@-");var f=k.substring(0,k.indexOf("@"));var g=k.substr(k.indexOf("@"));f=f.replace("@","");g=g.replace("@","");var m,n=g.length;for(var d=0;d<n;++d){var m,i=g.charAt(d);if(i=="+"){m="\u207A"}else{if(i=="-"){m="\u207B"}else{var h=parseInt(i);if(h==1){m=String.fromCharCode(185)}else{if(h>1&&h<4){m=String.fromCharCode(176+h)}else{m=String.fromCharCode(8304+h)}}}}g=g.replace(i,m)}f=f.replace("1x","");return f+g};a.Painter.translateExp=function(m){var h=m.match(/\^{[0-9]*}/gi);if(h!=null){var d="";for(var g=0;g<h.length;++g){d=h[g].replace(" ","");d=d.replace("^{","");d=d.replace("}","");var o=d.length;for(var f=0;f<o;++f){var l=d.charAt(f);var n,k=parseInt(l);if(k==1){n=String.fromCharCode(185)}else{if(k>1&&k<4){n=String.fromCharCode(176+k)}else{n=String.fromCharCode(8304+k)}}d=d.replace(l,n)}m=m.replace(h[g],d)}}return m};a.Painter.symbols_map={"#alpha":"\u03B1","#beta":"\u03B2","#chi":"\u03C7","#delta":"\u03B4","#varepsilon":"\u03B5","#phi":"\u03C6","#gamma":"\u03B3","#eta":"\u03B7","#iota":"\u03B9","#varphi":"\u03C6","#kappa":"\u03BA","#lambda":"\u03BB","#mu":"\u03BC","#nu":"\u03BD","#omicron":"\u03BF","#pi":"\u03C0","#theta":"\u03B8","#rho":"\u03C1","#sigma":"\u03C3","#tau":"\u03C4","#upsilon":"\u03C5","#varomega":"\u03D6","#omega":"\u03C9","#xi":"\u03BE","#psi":"\u03C8","#zeta":"\u03B6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03A7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03A6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03D1","#Kappa":"\u039A","#Lambda":"\u039B","#Mu":"\u039C","#Nu":"\u039D","#Omicron":"\u039F","#Pi":"\u03A0","#Theta":"\u0398","#Rho":"\u03A1","#Sigma":"\u03A3","#Tau":"\u03A4","#Upsilon":"\u03A5","#varsigma":"\u03C2","#Omega":"\u03A9","#Xi":"\u039E","#Psi":"\u03A8","#Zeta":"\u0396","#varUpsilon":"\u03D2","#epsilon":"\u03B5","#sqrt":"\u221A","#leq":"\u2264","#/":"\u2044","#infty":"\u221E","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u02C6","#pm":"\xB1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xD7","#propto":"\u221D","#partial":"\u2202","#bullet":"\u2022","#divide":"\xF7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"\u007C","#topbar":"\xAF","#downleftarrow":"\u21B5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211C","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222A","#supseteq":"\u2287","#supset":"\u2283","#notsubset":"\u2284","#subseteq":"\u2286","#subset":"\u2282","#int":"\u222B","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xAE","#ocopyright":"\xA9","#trademark":"\u2122","#prod":"\u220F","#surd":"\u221A","#upoint":"\u22C5","#corner":"\xAC","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21D4","#Leftarrow":"\u21D0","#Uparrow":"\u21D1","#Rightarrow":"\u21D2","#Downarrow":"\u21D3","#LT":"\x3C","#void1":"\xAE","#copyright":"\xA9","#void3":"\u2122","#sum":"\u2211","#arctop":"","#lbar":"","#arcbottom":"","#void8":"","#bottombar":"\u230A","#arcbar":"","#ltbar":"","#AA":"\u212B","#aa":"\u00E5","#void06":"","#GT":"\x3E","#forall":"\u2200","#exists":"\u2203","#bar":"","#vec":"","#dot":"\u22C5","#hat":"\xB7","#ddot":"","#acute":"acute","#grave":"","#check":"\u2713","#tilde":"\u02DC","#slash":"\u2044","#hbar":"\u0127","#box":"","#Box":"","#parallel":"","#perp":"\u22A5","#odot":"","#left":"","#right":""};a.Painter.translateLaTeX=function(d){var h=d;h=this.translateExp(h);while(h.indexOf("^{o}")!=-1){h=h.replace("^{o}","\xBA")}var f=h.match(/\#sqrt{(.*?)}/gi);if(f!=null){for(var e=0;e<f.length;++e){var g=f[e].replace(" ","");g=g.replace("#sqrt{","#sqrt");g=g.replace("}","");h=h.replace(f[e],g)}}f=h.match(/\_{(.*?)}/gi);if(f!=null){for(var e=0;e<f.length;++e){var g=f[e].replace(" ","");g=g.replace("_{","");g=g.replace("}","");h=h.replace(f[e],g)}}f=h.match(/\^{(.*?)}/gi);if(f!=null){for(e=0;e<f.length;++e){var g=f[e].replace(" ","");g=g.replace("^{","");g=g.replace("}","");h=h.replace(f[e],g)}}while(h.indexOf("#/")!=-1){h=h.replace("#/",a.Painter.symbols_map["#/"])}for(var c in a.Painter.symbols_map){while(h.indexOf(c)!=-1){h=h.replace(c,a.Painter.symbols_map[c])}}return h};a.Painter.isAnyLatex=function(c){return(c.indexOf("#")>=0)||(c.indexOf("\\")>=0)||(c.indexOf("{")>=0)};a.Painter.translateMath=function(f,e,d){if(e!=2){f=f.replace(/#LT/g,"\\langle");f=f.replace(/#GT/g,"\\rangle");f=f.replace(/#club/g,"\\clubsuit");f=f.replace(/#spade/g,"\\spadesuit");f=f.replace(/#heart/g,"\\heartsuit");f=f.replace(/#diamond/g,"\\diamondsuit");f=f.replace(/#voidn/g,"\\wp");f=f.replace(/#voidb/g,"f");f=f.replace(/#copyright/g,"(c)");f=f.replace(/#ocopyright/g,"(c)");f=f.replace(/#trademark/g,"TM");f=f.replace(/#void3/g,"TM");f=f.replace(/#oright/g,"R");f=f.replace(/#void1/g,"R");f=f.replace(/#3dots/g,"\\ldots");f=f.replace(/#lbar/g,"\\mid");f=f.replace(/#void8/g,"\\mid");f=f.replace(/#divide/g,"\\div");f=f.replace(/#Jgothic/g,"\\Im");f=f.replace(/#Rgothic/g,"\\Re");f=f.replace(/#doublequote/g,'"');f=f.replace(/#plus/g,"+");f=f.replace(/#diamond/g,"\\diamondsuit");f=f.replace(/#voidn/g,"\\wp");f=f.replace(/#voidb/g,"f");f=f.replace(/#copyright/g,"(c)");f=f.replace(/#ocopyright/g,"(c)");f=f.replace(/#trademark/g,"TM");f=f.replace(/#void3/g,"TM");f=f.replace(/#oright/g,"R");f=f.replace(/#void1/g,"R");f=f.replace(/#3dots/g,"\\ldots");f=f.replace(/#lbar/g,"\\mid");f=f.replace(/#void8/g,"\\mid");f=f.replace(/#divide/g,"\\div");f=f.replace(/#Jgothic/g,"\\Im");f=f.replace(/#Rgothic/g,"\\Re");f=f.replace(/#doublequote/g,'"');f=f.replace(/#plus/g,"+");f=f.replace(/#minus/g,"-");f=f.replace(/#\//g,"/");f=f.replace(/#upoint/g,".");f=f.replace(/#aa/g,"\\mathring{a}");f=f.replace(/#AA/g,"\\mathring{A}");f=f.replace(/#omicron/g,"o");f=f.replace(/#Alpha/g,"A");f=f.replace(/#Beta/g,"B");f=f.replace(/#Epsilon/g,"E");f=f.replace(/#Zeta/g,"Z");f=f.replace(/#Eta/g,"H");f=f.replace(/#Iota/g,"I");f=f.replace(/#Kappa/g,"K");f=f.replace(/#Mu/g,"M");f=f.replace(/#Nu/g,"N");f=f.replace(/#Omicron/g,"O");f=f.replace(/#Rho/g,"P");f=f.replace(/#Tau/g,"T");f=f.replace(/#Chi/g,"X");f=f.replace(/#varomega/g,"\\varpi");f=f.replace(/#corner/g,"?");f=f.replace(/#ltbar/g,"?");f=f.replace(/#bottombar/g,"?");f=f.replace(/#notsubset/g,"?");f=f.replace(/#arcbottom/g,"?");f=f.replace(/#cbar/g,"?");f=f.replace(/#arctop/g,"?");f=f.replace(/#topbar/g,"?");f=f.replace(/#arcbar/g,"?");f=f.replace(/#downleftarrow/g,"?");f=f.replace(/#splitline/g,"\\genfrac{}{}{0pt}{}");f=f.replace(/#frac/g,"\\frac");f=f.replace(/#left{/g,"\\lbrace");f=f.replace(/#right}/g,"\\rbrace");f=f.replace(/#left\[/g,"\\lbrack");f=f.replace(/#right\]/g,"\\rbrack");f=f.replace(/#\[\]{/g,"\\lbrack");f=f.replace(/ } /g,"\\rbrack");f=f.replace(/#\[/g,"\\lbrack");f=f.replace(/#\]/g,"\\rbrack");f=f.replace(/#{/g,"\\lbrace");f=f.replace(/#}/g,"\\rbrace");f=f.replace(/ /g,"\\;");for(var c in a.Painter.symbols_map){var g="\\"+c.substr(1);f=f.replace(new RegExp(c,"g"),g)}}else{f=f.replace(/\\\^/g,"\\hat")}if(typeof d!="string"){return"\\("+f+"\\)"}mathcolor=d;mathcolor=mathcolor.replace(/rgb/g,"[RGB]");mathcolor=mathcolor.replace(/\(/g,"{");mathcolor=mathcolor.replace(/\)/g,"}");return"\\(\\color "+mathcolor+f+"\\)"};a.TBasePainter=function(){this.divid=null};a.TBasePainter.prototype.Cleanup=function(){};a.TBasePainter.prototype.DrawingReady=function(){this["_ready_called_"]=true;if("_ready_callback_" in this){a.CallBack(this["_ready_callback_"],this);delete this["_ready_callback_"];this["_ready_callback_"]=null}return this};a.TBasePainter.prototype.WhenReady=function(c){if("_ready_called_" in this){return a.CallBack(c,this)}this["_ready_callback_"]=c};a.TBasePainter.prototype.GetObject=function(){return null};a.TBasePainter.prototype.UpdateObject=function(c){return false};a.TBasePainter.prototype.RedrawPad=function(c){};a.TBasePainter.prototype.RedrawObject=function(d){if(this.UpdateObject(d)){var c=document.body.style.cursor;document.body.style.cursor="wait";this.RedrawPad();document.body.style.cursor=c}};a.TBasePainter.prototype.CheckResize=function(c){};a.TBasePainter.prototype.select_main=function(){if(this.divid==null){return b.select(null)}if((typeof this.divid=="string")&&(this.divid.charAt(0)!="#")){return b.select("#"+this.divid)}return b.select(this.divid)};a.TBasePainter.prototype.SetDivId=function(d){this["divid"]=d;var c=this.select_main();if(c.node()&&c.node().firstChild){c.node().firstChild.painter=this}};a.TBasePainter.prototype.SetItemName=function(c,d){if(c==null){delete this["_hitemname"]}else{this["_hitemname"]=c}if(d!=null){this["_hdrawopt"]=d}};a.TBasePainter.prototype.GetItemName=function(){return("_hitemname" in this)?this["_hitemname"]:null};a.TBasePainter.prototype.GetItemDrawOpt=function(){return("_hdrawopt" in this)?this["_hdrawopt"]:""};a.TObjectPainter=function(c){a.TBasePainter.call(this);this.obj_typename=(c!=null)&&("_typename" in c)?c._typename:"";this.draw_g=null;this.pad_name="";this.main=null};a.TObjectPainter.prototype=Object.create(a.TBasePainter.prototype);a.TObjectPainter.prototype.pad_painter=function(c){var d=c?this.svg_pad():this.svg_canvas();return d.empty()?null:d.property("pad_painter")};a.TObjectPainter.prototype.CheckResize=function(d){var c=this.pad_painter();if(c){c.CheckCanvasResize()}};a.TObjectPainter.prototype.RemoveDrawG=function(){if(this.draw_g!=null){this.draw_g.remove();this.draw_g=null}};a.TObjectPainter.prototype.RecreateDrawG=function(d,e,g){if(this.draw_g){this.draw_g.selectAll("*").remove()}if(g==null){g=true}if(d){if(e==null){e=".text_layer"}if(!this.draw_g){this.draw_g=this.svg_pad().select(e).append("svg:g")}}else{var i=this.svg_frame();var c=i.attr("width");var f=i.attr("height");if(!this.draw_g){if(e==null){e=".main_layer"}if(g){this.draw_g=i.select(e).append("g")}else{this.draw_g=i.select(e).append("svg")}}if(!g){this.draw_g.attr("x",0).attr("y",0).attr("width",c).attr("height",f).attr("viewBox","0 0 "+c+" "+f).attr("overflow","hidden")}}};a.TObjectPainter.prototype.svg_canvas=function(){return this.select_main().select(".root_canvas")};a.TObjectPainter.prototype.svg_pad=function(){var d=this.svg_canvas();if((this.pad_name!="")&&!d.empty()){d=d.select("[pad="+this.pad_name+"]")}return d};a.TObjectPainter.prototype.root_pad=function(){var c=this.pad_painter(true);return c?c.pad:null};a.TObjectPainter.prototype.ConvertToNDC=function(d,e,c){var f=this.root_pad();if(c==null){c=false}if(c||(f==null)){return e}if(d=="y"){if(f.fLogy){e=(e>0)?a.Math.log10(e):f.fUymin}return(e-f.fY1)/(f.fY2-f.fY1)}if(f.fLogx){e=(e>0)?a.Math.log10(e):f.fUxmin}return(e-f.fX1)/(f.fX2-f.fX1)};a.TObjectPainter.prototype.AxisToSvg=function(e,f,d){var c=this.main_painter();if((c!=null)&&!d){return e=="y"?c.gry(f):c.grx(f)}if(!d){f=this.ConvertToNDC(e,f)}if(e=="y"){return(1-f)*this.pad_height()}return f*this.pad_width()};a.TObjectPainter.prototype.PadToSvg=function(d,e,c){return this.AxisToSvg(d,e,c)};a.TObjectPainter.prototype.svg_frame=function(){return this.svg_pad().select(".root_frame")};a.TObjectPainter.prototype.pad_width=function(){var c=parseInt(this.svg_pad().attr("width"));return isNaN(c)?0:c};a.TObjectPainter.prototype.pad_height=function(){var c=parseInt(this.svg_pad().attr("height"));return isNaN(c)?0:c};a.TObjectPainter.prototype.frame_width=function(){var c=parseInt(this.svg_frame().attr("width"));return isNaN(c)?0:c};a.TObjectPainter.prototype.frame_height=function(){var c=parseInt(this.svg_frame().attr("height"));return isNaN(c)?0:c};a.TObjectPainter.prototype.main_painter=function(){if(!this.main){var c=this.svg_pad();if(!c.empty()){this.main=c.property("mainpainter")}}return this.main};a.TObjectPainter.prototype.is_main_painter=function(){return this==this.main_painter()};a.TObjectPainter.prototype.SetDivId=function(g,f){this["divid"]=g;if(f==null){f=0}this["create_canvas"]=false;var e=this.svg_canvas();if(e.empty()&&(f>0)){a.Painter.drawCanvas(g,null);e=this.svg_canvas();this["create_canvas"]=true}if(e.empty()){if((f<0)||(this.obj_typename=="TCanvas")){return}a.console("Special case for "+this.obj_typename+" assign painter to first DOM element");var c=b.select("#"+g);if(c.node()&&c.node().firstChild){c.node().firstChild.painter=this}return}this.pad_name=e.property("current_pad");if(f<0){return}if((f>0)&&this.svg_frame().empty()){a.Painter.drawFrame(g,null);if(this.svg_frame().empty()){return alert("Fail to draw dummy TFrame")}this["create_canvas"]=true}var d=this.svg_pad();if(d.empty()){return}if(d.property("pad_painter")!=this){d.property("pad_painter").painters.push(this)}if((f>0)&&(d.property("mainpainter")==null)){d.property("mainpainter",this)}};a.TObjectPainter.prototype.SetForeignObjectPosition=function(d,c,f){var e=d;if(a.browser.isWebKit){this.svg_canvas().property("redraw_by_resize",true);while(e&&e.attr("class")!="root_canvas"){if((e.attr("class")=="root_frame")||(e.attr("class")=="root_pad")){c+=parseInt(e.attr("x"));f+=parseInt(e.attr("y"))}e=b.select(e.node().parentNode)}}d.attr("x",c).attr("y",f)};a.TObjectPainter.prototype.createAttFill=function(f,g,d){if((g==null)&&f){g=f.fFillStyle}if((d==null)&&f){d=f.fFillColor}var h={color:"none"};h.SetFill=function(j){j.style("fill",this.color);if("antialias" in this){j.style("antialias",this.antialias)}};h.func=h.SetFill.bind(h);if(typeof f=="string"){h.color=f;return h}if((g<1001)||((g>=4000)&&(g<=4100))){return h}h.color=a.Painter.root_colors[d];if(typeof h.color!="string"){h.color="none"}var c=this.svg_canvas();if((g<3000)||(g>3025)||c.empty()){return h}var i="pat_"+g+"_"+d;h.color="url(#"+i+")";h.antialias=false;if(document.getElementById(i)!=null){return h}var e=a.Painter.root_colors[d];switch(g){case 3001:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","3px").attr("height","2px").style("stroke",e).append("svg:rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1).style("stroke",e).append("svg:rect").attr("x",2).attr("y",0).attr("width",1).attr("height",1).style("stroke",e).append("svg:rect").attr("x",1).attr("y",1).attr("width",1).attr("height",1).style("stroke",e);break;case 3002:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","4px").attr("height","2px").style("stroke",e).append("svg:rect").attr("x",1).attr("y",0).attr("width",1).attr("height",1).style("stroke",e).append("svg:rect").attr("x",3).attr("y",1).attr("width",1).attr("height",1).style("stroke",e);break;case 3003:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","4px").attr("height","4px").style("stroke",e).append("svg:rect").attr("x",2).attr("y",1).attr("width",1).attr("height",1).style("stroke",e).append("svg:rect").attr("x",0).attr("y",3).attr("width",1).attr("height",1).style("stroke",e);break;case 3004:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","8px").attr("height","8px").style("stroke",e).append("svg:line").attr("x1",8).attr("y1",0).attr("x2",0).attr("y2",8).style("stroke",e).style("stroke-width",1);break;case 3005:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","8px").attr("height","8px").style("stroke",e).append("svg:line").attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8).style("stroke",e).style("stroke-width",1);break;case 3006:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","4px").attr("height","4px").style("stroke",e).append("svg:line").attr("x1",1).attr("y1",0).attr("x2",1).attr("y2",3).style("stroke",e).style("stroke-width",1);break;case 3007:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","4px").attr("height","4px").style("stroke",e).append("svg:line").attr("x1",0).attr("y1",1).attr("x2",3).attr("y2",1).style("stroke",e).style("stroke-width",1);break;default:c.append("svg:pattern").attr("id",i).attr("patternUnits","userSpaceOnUse").attr("width","8px").attr("height","8px").style("stroke",e).append("svg:line").attr("x1",8).attr("y1",0).attr("x2",0).attr("y2",8).style("stroke",e).style("stroke-width",1);break}return h};a.TObjectPainter.prototype.ForEachPainter=function(f){var c=this.select_main();var d=(c.node()&&c.node().firstChild)?c.node().firstChild.painter:null;if(d!=null){f(d);return}var g=this.pad_painter();if(g==null){return}f(g);if("painters" in g){for(var e in g.painters){f(g.painters[e])}}};a.TObjectPainter.prototype.Cleanup=function(){this.select_main().html("")};a.TObjectPainter.prototype.RedrawPad=function(){var c=this.pad_painter(true);if(c){c.Redraw()}};a.TObjectPainter.prototype.AddDrag=function(l){if(!a.gStyle.MoveResize){return}var d=this;var c=function(){return Number(d.draw_g.attr("width"))};var n=function(){return Number(d.draw_g.attr("height"))};var o=0,m=0,h=1,e=1;function j(p){if("buttons" in p){return p.buttons===2}else{if("which" in p){return p.which===2}else{if("button" in p){return p.button===2}}}return false}var f=d.draw_g.append("rect").style("opacity","0").style("cursor","se-resize").attr("x",c()-20).attr("y",n()-20).attr("width",20).attr("height",20);var g=null;var k=b.behavior.drag().origin(Object).on("dragstart",function(){if(j(b.event.sourceEvent)){return}b.event.sourceEvent.preventDefault();o=0;m=0;h=d.pad_width()-c();e=d.pad_height()-n();g=b.select(d.draw_g.node().parentNode).append("rect").classed("zoom",true).attr("x",d.draw_g.attr("x")).attr("y",d.draw_g.attr("y")).attr("width",c()).attr("height",n()).style("cursor","move")}).on("drag",function(){if(g==null){return}b.event.sourceEvent.preventDefault();var p=Number(g.attr("x")),s=Number(g.attr("y"));var r=b.event.dx,q=b.event.dy;if((o<0)&&(r>0)){o+=r;r=0;if(o>0){r=o;o=0}}if((o>0)&&(r<0)){o+=r;r=0;if(o<0){r=o;o=0}}if((m<0)&&(q>0)){m+=q;q=0;if(m>0){q=m;m=0}}if((m>0)&&(q<0)){m+=q;q=0;if(m<0){q=m;m=0}}if(p+r<0){o+=(p+r);p=0}else{if(p+r>h){o+=(p+r-h);p=h}else{p+=r}}if(s+q<0){m+=(s+q);s=0}else{if(s+q>e){m+=(s+q-e);s=e}else{s+=q}}g.attr("x",p).attr("y",s);b.event.sourceEvent.stopPropagation()}).on("dragend",function(){if(g==null){return}b.event.sourceEvent.preventDefault();g.style("cursor","auto");var p=Number(g.attr("x")),s=Number(g.attr("y"));var r=p-Number(d.draw_g.attr("x")),q=s-Number(d.draw_g.attr("y"));g.remove();g=null;d.draw_g.attr("x",p).attr("y",s).attr("transform","translate("+p+","+s+")");f.attr("x",c()-20).attr("y",n()-20);if("move" in l){l.move(p,s,r,q)}else{if("obj" in l){l.obj.fX1NDC+=r/d.pad_width();l.obj.fX2NDC+=r/d.pad_width();l.obj.fY1NDC-=q/d.pad_height();l.obj.fY2NDC-=q/d.pad_height()}}});var i=b.behavior.drag().origin(Object).on("dragstart",function(){if(j(b.event.sourceEvent)){return}b.event.sourceEvent.stopPropagation();b.event.sourceEvent.preventDefault();o=0;m=0;h=d.pad_width()-Number(d.draw_g.attr("x"));e=d.pad_height()-Number(d.draw_g.attr("y"));g=b.select(d.draw_g.node().parentNode).append("rect").classed("zoom",true).attr("x",d.draw_g.attr("x")).attr("y",d.draw_g.attr("y")).attr("width",c()).attr("height",n()).style("cursor","se-resize")}).on("drag",function(){if(g==null){return}b.event.sourceEvent.preventDefault();var q=Number(g.attr("width")),s=Number(g.attr("height"));var r=b.event.dx,p=b.event.dy;if((o<0)&&(r>0)){o+=r;r=0;if(o>0){r=o;o=0}}if((o>0)&&(r<0)){o+=r;r=0;if(o<0){r=o;o=0}}if((m<0)&&(p>0)){m+=p;p=0;if(m>0){p=m;m=0}}if((m>0)&&(p<0)){m+=p;p=0;if(m<0){p=m;m=0}}if(q+r>h){o+=(q+r-h);q=h}else{if(q+r<0){o+=(q+r);q=0}else{q+=r}}if(s+p>e){m+=(s+p-e);s=e}else{if(s+p<0){m+=(s+p);s=0}else{s+=p}}g.attr("width",q).attr("height",s);b.event.sourceEvent.stopPropagation()}).on("dragend",function(){if(g==null){return}b.event.sourceEvent.preventDefault();g.style("cursor","auto");var p=Number(g.attr("width"));var q=Number(g.attr("height"));d.draw_g.attr("width",p).attr("height",q);g.remove();g=null;f.attr("x",p-20).attr("y",q-20);if("resize" in l){l.resize(p,q)}else{if("obj" in l){l.obj.fX2NDC=l.obj.fX1NDC+p/d.pad_width();l.obj.fY1NDC=l.obj.fY2NDC-q/d.pad_height()}if(("redraw" in l)&&(typeof d[l.redraw]=="function")){d[l.redraw]()}}});d.draw_g.style("cursor","move").call(k);f.call(i)};a.TObjectPainter.prototype.FindPainterFor=function(d,g){var c=this.pad_painter(true);var f=c==null?null:c.painters;if(f==null){return null}for(var h in f){var e=f[h].GetObject();if(e==null){continue}if(d&&(e===d)){return f[h]}if(g&&("fName" in e)&&(e.fName==g)){return f[h]}}return null};a.TObjectPainter.prototype.Redraw=function(){};a.TObjectPainter.prototype.StartTextDrawing=function(e,c,f){if(!f){f=this.draw_g}var d=a.Painter.getFontDetails(e,c);f.call(d.func);f.property("text_font",d);f.property("mathjax_use",false);f.property("text_factor",0);f.property("max_text_width",0)};a.TObjectPainter.prototype.TextScaleFactor=function(d,c){if(!c){c=this.draw_g}if(d&&(d>c.property("text_factor"))){c.property("text_factor",d)}};a.TObjectPainter.prototype.GetBoundarySizes=function(d){var c=d.getBoundingClientRect();if(parseInt(c.width)>0){c=d.getBBox()}return{width:parseInt(c.width),height:parseInt(c.height)}};a.TObjectPainter.prototype.FinishTextDrawing=function(g){if(!g){g=this.draw_g}var i=null;if(g.property("mathjax_use")){g.property("mathjax_use",false);g.property("_painter",this);var e=false;i=g.selectAll(".math_svg");i.each(function(){var j=b.select(this);if(j.node().parentNode!==g.node()){return}var f=j.property("_element");if(b.select(f).select("svg").empty()){e=true}});if(e){return a.AssertPrerequisites("mathjax",{_this:g,func:function(){if(typeof MathJax!="object"){return}MathJax.Hub.Queue(["FinishTextDrawing",this.property("_painter"),this])}})}}if(i==null){i=g.selectAll(".math_svg")}var c=this;i.each(function(){var k=b.select(this);if(k.node().parentNode!==g.node()){return}var j=k.property("_element");k.property("_element",null);var l=b.select(j).select("svg");if(l.empty()){a.console("MathJax SVG ouptut error");return}l.remove();document.body.removeChild(j);k.append(function(){return l.node()});if(k.property("_scale")){var f=c.GetBoundarySizes(k.node());c.TextScaleFactor(1*f.width/parseInt(k.attr("width")),g);c.TextScaleFactor(1*f.height/parseInt(k.attr("height")),g)}});var h=g.property("text_factor");var d=g.property("text_font");if((h>0)&&((h<0.9)||(h>1))){d.size=Math.floor(d.size/h);g.call(d.func)}i.each(function(){var o=b.select(this);if(o.node().parentNode!==g.node()){return}var n=c.GetBoundarySizes(o.node());var p=o.property("_align");var l=o.property("_rotate");var k=parseInt(o.attr("width")),m=parseInt(o.attr("height"));var j=parseInt(o.attr("x")),f=parseInt(o.attr("y"));if(o.property("_scale")){if(p[0]=="middle"){j+=(k-n.width)/2}else{if(p[0]=="end"){j+=(k-n.width)}}if(p[1]=="middle"){f+=(m-n.height)/2}else{if(p[1]=="top"&&!l){f+=(m-n.height)}else{if(p[1]=="bottom"&&l){f+=(m-n.height)}}}}else{if(p[0]=="middle"){j-=n.width/2}else{if(p[0]=="end"){j-=n.width}}if(p[1]=="middle"){f-=n.height/2}else{if(p[1]=="bottom"&&!l){f-=n.height}else{if(p[1]=="top"&&l){f-=n.height}}}}o.attr("x",j).attr("y",f).attr("width",n.width+10).attr("height",n.height+10).attr("visibility",null)});g.selectAll(".hidden_text").attr("opacity","1").classed("hidden_text",false);return g.property("max_text_width")};a.TObjectPainter.prototype.DrawText=function(p,l,j,m,u,g,v,n,z){if(!z){z=this.draw_g}var r;if(typeof p=="string"){r=p.split(";");if(r.length==1){r.push("middle")}}else{r=["start","middle"];if((p/10)>=3){r[0]="end"}else{if((p/10)>=2){r[0]="middle"}}if((p%10)==0){r[1]="bottom"}else{if((p%10)==1){r[1]="bottom"}else{if((p%10)==3){r[1]="top"}}}}var A=(m>0)&&(u>0);if(n==null){n=1}if(n<2){if(!a.Painter.isAnyLatex(g)){n=0}}var t=((a.MathJax<1)&&(n!=2))||(n<1);if(!t&&(u<0)&&!a.browser.isFirefox){t=true}if(t){if(n>0){g=a.Painter.translateLaTeX(g)}var d=l.toFixed(1),c=j.toFixed(1),i=null,f=false;if(m>0){if(r[0]=="middle"){d=(l+m*0.5).toFixed(1)}else{if(r[0]=="end"){d=(l+m).toFixed(1)}}}if(u>0){if(r[1]=="bottom"){c=(j+u).toFixed(1)}else{if(r[1]=="top"){i=".8em"}else{c=(j+u/2).toFixed(1);if(a.browser.isIE){i=".4em"}else{f=true}}}}else{if(u==0){if(r[1]=="top"){i=".8em"}else{if(r[1]=="middle"){if(a.browser.isIE){i=".4em"}else{f=true}}}}}var o=z.append("text").attr("text-anchor",r[0]).attr("x",d).attr("y",c).attr("fill",v?v:null).text(g);if(i!=null){o.attr("dy",i)}if(f){o.attr("dominant-baseline","middle")}if((!A)&&(u==-270)){o.attr("transform","rotate(270, 0, 0)")}var k=this.GetBoundarySizes(o.node());if(A){o.classed("hidden_text",true).attr("opacity","0")}if(k.width>z.property("max_text_width")){z.property("max_text_width",k.width)}if((m>0)&&A){this.TextScaleFactor(1*k.width/m,z)}if((u>0)&&A){this.TextScaleFactor(1*k.height/u,z)}return k.width}m=Math.round(m);u=Math.round(u);l=Math.round(l);j=Math.round(j);var s=false;if(!A){if(u==-270){s=true}m=this.pad_width();u=this.pad_height()}var q=z.append("svg").attr("x",l).attr("y",j).attr("width",m).attr("height",u).attr("class","math_svg").attr("visibility","hidden").property("_scale",A).property("_rotate",s).property("_align",r);if(s){q.attr("transform","rotate(270, 0, 0)")}var e=document.createElement("div");b.select(e).style("visibility","hidden").style("overflow","hidden").style("position","absolute").html(a.Painter.translateMath(g,n,v));document.body.appendChild(e);z.property("mathjax_use",true);q.property("_element",e);a.AssertPrerequisites("mathjax",{_this:e,func:function(){if(typeof MathJax=="object"){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this])}}});return 0};a.TFramePainter=function(c){a.TObjectPainter.call(this,c);this.tframe=c};a.TFramePainter.prototype=Object.create(a.TObjectPainter.prototype);a.TFramePainter.prototype.GetObject=function(){return this.tframe};a.TFramePainter.prototype.Shrink=function(e,c){var d=this.svg_frame().property("NDC");if(d){d.fX1NDC+=e;d.fX2NDC-=c}};a.TFramePainter.prototype.DrawFrameSvg=function(){var t=this.pad_width(),s=this.pad_height();var n=t,z=s;var y=this.svg_frame().empty()?null:this.svg_frame().property("NDC");if(y==null){y=a.clone(a.gStyle.FrameNDC)}var D=this.root_pad();var m=t*y.fX1NDC;var o=t*(1-y.fX2NDC);var f=s*y.fY1NDC;var c=s*(1-y.fY2NDC);var r=this.createAttFill("white"),C=a.Painter.createAttLine("black"),g=0,j=0;if(this.tframe){g=this.tframe.fBorderMode;j=this.tframe.fBorderSize;C=a.Painter.createAttLine(this.tframe);if(D){var A=t/Math.abs(D.fX2-D.fX1);var l=s/Math.abs(D.fY2-D.fY1);var x=(this.tframe.fX1-D.fX1)*A;var e=(this.tframe.fY1-D.fY1)*l;var v=(this.tframe.fX2-D.fX1)*A;var d=(this.tframe.fY2-D.fY1)*l;var p,k,B,u;if(x<v){p=x;k=v}else{p=v;k=x}if(e<d){B=e;u=d}else{B=d;u=e}m=p;c=B;n=k-p;z=u-B;f=s-u;o=t-k}else{m=this.tframe.fX1*t;f=this.tframe.fY1*s;c=(1-this.tframe.fY2)*s;o=(1-this.tframe.fX2+shrink_right)*t;n-=(m+o);z-=(f+c)}r=this.createAttFill(this.tframe)}else{if(D){r=this.createAttFill(null,D.fFrameFillStyle,D.fFrameFillColor)}n-=(m+o);z-=(f+c)}if(r.color=="none"){r.color="white"}var q=this.svg_pad().select(".root_frame");var i=null;if(q.empty()){q=this.svg_pad().select(".frame_layer").append("svg:g").attr("class","root_frame");i=q.append("svg:rect");q.append("svg:g").attr("class","grid_layer");q.append("svg:g").attr("class","main_layer");q.append("svg:g").attr("class","axis_layer");q.append("svg:g").attr("class","upper_layer")}else{i=q.select("rect")}q.property("NDC",{fX1NDC:m/t,fX2NDC:(m+n)/t,fY1NDC:f/s,fY2NDC:(f+z)/s});q.property("frame_painter",this);m=Math.round(m);f=Math.round(f);n=Math.round(n);z=Math.round(z);q.attr("x",m).attr("y",f).attr("width",n).attr("height",z).attr("transform","translate("+m+","+f+")");i.attr("x",0).attr("y",0).attr("width",n).attr("height",z).call(r.func).call(C.func)};a.TFramePainter.prototype.Redraw=function(){this.DrawFrameSvg()};a.Painter.drawFrame=function(e,d){var c=new a.TFramePainter(d);c.SetDivId(e);c.DrawFrameSvg();return c.DrawingReady()};a.TF1Painter=function(c){a.TObjectPainter.call(this,c);this.tf1=c};a.TF1Painter.prototype=Object.create(a.TObjectPainter.prototype);a.TF1Painter.prototype.GetObject=function(){return this.tf1};a.TF1Painter.prototype.Redraw=function(){this.DrawBins()};a.TF1Painter.prototype.Eval=function(c){return this.tf1.evalPar(c)};a.TF1Painter.prototype.CreateDummyHisto=function(){var c=0,l=0,n=0,d=0;if(this.tf1.fSave.length>0){var g=this.tf1.fNpx;for(var k=0;k<g;++k){var m=this.tf1.fSave[k];if((k==0)||(m>d)){d=m}if((k==0)||(m<n)){n=m}}c=this.tf1.fSave[g+1];l=this.tf1.fSave[g+2]}else{if(this.tf1.fNpfits<=103){this.tf1.fNpfits=103}c=this.tf1.fXmin;l=this.tf1.fXmax;var g=Math.max(this.tf1.fNpx,this.tf1.fNpfits);var f=(l-c)/g;var e=-1,o=-1;for(var k=0;k<g;++k){var m=this.Eval(c+(k*f));if(isNaN(m)){continue}if(e<0){e=k;d=m;n=m}if((o<0)||(o==k-1)){o=k}if(m>d){d=m}if(m<n){n=m}}if(e<o){l=c+o*f;c=c+e*f}}if(d>0){d*=1.05}if(n<0){n*=1.05}var j=a.Create("TH1I");j.fName=this.tf1.fName+"_hist";j.fTitle=this.tf1.fTitle;j.fXaxis["fXmin"]=c;j.fXaxis["fXmax"]=l;j.fYaxis["fXmin"]=n;j.fYaxis["fXmax"]=d;return j};a.TF1Painter.prototype.CreateBins=function(){var c=this;if(this.tf1.fSave.length>0){var g=this.tf1.fNpx;var f=this.tf1.fSave[g+1];var d=this.tf1.fSave[g+2];var e=(d-f)/g;this["bins"]=b.range(g).map(function(h){return{x:f+(h*e),y:c.tf1.fSave[h]}});this["interpolate_method"]="monotone"}else{if(this.tf1.fNpfits<=103){this.tf1.fNpfits=333}var f=this.tf1.fXmin;var d=this.tf1.fXmax;var g=Math.max(this.tf1.fNpx,this.tf1.fNpfits);var e=(d-f)/g;this["bins"]=b.range(g).map(function(h){var i=f+(h*e);var j=c.Eval(i);if(isNaN(j)){j=0}return{x:i,y:j}});this["interpolate_method"]="cardinal-open"}};a.TF1Painter.prototype.DrawBins=function(){var e=this.frame_width(),g=this.frame_height();this.RecreateDrawG(false,".main_layer",false);var f=this;var d=this.main_painter();var k=a.Painter.createAttLine(this.tf1);var j=this.createAttFill(this.tf1);if(j.color=="white"){j.color="none"}var c=b.svg.line().x(function(h){return d.grx(h.x).toFixed(1)}).y(function(h){return d.gry(h.y).toFixed(1)}).interpolate(this.interpolate_method);var i=b.svg.area().x(function(h){return d.grx(h.x).toFixed(1)}).y1(g).y0(function(h){return d.gry(h.y).toFixed(1)});if(k.color!="none"){this.draw_g.append("svg:path").attr("class","line").attr("d",c(f.bins)).style("fill","none").call(k.func)}if(j.color!="none"){this.draw_g.append("svg:path").attr("class","area").attr("d",i(f.bins)).style("stroke","none").style("pointer-events","none").call(j.func)}if(a.gStyle.Tooltip){this.draw_g.selectAll().data(this.bins).enter().append("svg:circle").attr("cx",function(h){return d.grx(h.x).toFixed(1)}).attr("cy",function(h){return d.gry(h.y).toFixed(1)}).attr("r",4).style("opacity",0).append("svg:title").text(function(h){return"x = "+d.AxisAsText("x",h.x)+" \ny = "+d.AxisAsText("y",h.y)})}};a.TF1Painter.prototype.UpdateObject=function(c){if(c._typename!=this.tf1._typename){return false}this.tf1=c;this.CreateBins();return true};a.Painter.drawFunction=function(f,e){var c=new a.TF1Painter(e);c.SetDivId(f,-1);if(c.main_painter()==null){var d=c.CreateDummyHisto();a.Painter.drawHistogram1D(f,d)}c.SetDivId(f);c.CreateBins();c.DrawBins();return c.DrawingReady()};a.TGraphPainter=function(c){a.TObjectPainter.call(this,c);this.graph=c;this.ownhisto=false;this.bins=null};a.TGraphPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TGraphPainter.prototype.GetObject=function(){return this.graph};a.TGraphPainter.prototype.Redraw=function(){this.DrawBins()};a.TGraphPainter.prototype.DecodeOptions=function(c){this.draw_all=true;a.extend(this,{optionLine:0,optionAxis:0,optionCurve:0,optionRect:0,optionMark:0,optionBar:0,optionR:0,optionE:0,optionEF:0,optionFill:0,optionZ:0,optionBrackets:0,opt:"LP",out_of_range:false,has_errors:false,draw_errors:false,is_bent:false});this.is_bent=this.graph._typename=="TGraphBentErrors";this.has_errors=(this.graph._typename=="TGraphErrors"||this.graph._typename=="TGraphAsymmErrors"||this.is_bent||this.graph._typename.match(/^RooHist/));this.draw_errors=this.has_errors;if((c!=null)&&(c!="")){this.opt=c.toUpperCase();this.opt.replace("SAME","")}if(this.opt.indexOf("L")!=-1){this.optionLine=1}if(this.opt.indexOf("F")!=-1){this.optionFill=1}if(this.opt.indexOf("A")!=-1){this.optionAxis=1}if(this.opt.indexOf("C")!=-1){this.optionCurve=1;if(this.optionFill==0){this.optionLine=1}}if(this.opt.indexOf("*")!=-1){this.optionMark=2}if(this.opt.indexOf("P")!=-1){this.optionMark=1}if(this.opt.indexOf("B")!=-1){this.optionBar=1;this.draw_errors=false}if(this.opt.indexOf("R")!=-1){this.optionR=1}if(this.opt.indexOf("[]")!=-1){this.optionBrackets=1;this.draw_errors=false}if(this.opt.indexOf("0")!=-1){this.optionMark=1;this.draw_errors=true;this.out_of_range=true}if(this.opt.indexOf("1")!=-1){if(this.optionBar==1){this.optionBar=2}}if(this.opt.indexOf("2")!=-1){this.optionRect=1}if(this.opt.indexOf("3")!=-1){this.optionEF=1;this.optionLine=0;this.draw_errors=false}if(this.opt.indexOf("4")!=-1){this.optionEF=2;this.optionLine=0;this.draw_errors=false}if(this.opt.indexOf("2")!=-1||this.opt.indexOf("5")!=-1){this.optionE=1}if(this.optionLine+this.optionFill+this.optionMark+this.optionBar+this.optionE+this.optionEF+this.optionRect+this.optionBrackets==0){if(this.opt.length==0){this.optionLine=1}}if(this.graph._typename=="TGraphErrors"){var e=b.max(this.graph.fEX);var d=b.max(this.graph.fEY);if(e<1e-300&&d<1e-300){this.draw_errors=false}}};a.TGraphPainter.prototype.CreateBins=function(){var c=this.graph;if(c==null){return}var e=c.fNpoints;if((c._typename=="TCutG")&&(e>3)){e--}var d=0;if(c._typename=="TGraphErrors"){d=1}else{if(c._typename=="TGraphAsymmErrors"||c._typename=="TGraphBentErrors"||c._typename.match(/^RooHist/)){d=2}}this.bins=b.range(e).map(function(f){if(d==1){return{x:c.fX[f],y:c.fY[f],exlow:c.fEX[f],exhigh:c.fEX[f],eylow:c.fEY[f],eyhigh:c.fEY[f]}}if(d==2){return{x:c.fX[f],y:c.fY[f],exlow:c.fEXlow[f],exhigh:c.fEXhigh[f],eylow:c.fEYlow[f],eyhigh:c.fEYhigh[f]}}return{x:c.fX[f],y:c.fY[f]}})};a.TGraphPainter.prototype.CreateHistogram=function(){var d,j,l,e;if(this.bins==null){d=0;j=1;l=0;e=1}else{for(var f in this.bins){var c=this.bins[f];if((d==null)||(c.x<d)){d=c.x}if((j==null)||(c.x>j)){j=c.x}if((l==null)||(c.y<l)){l=c.y}if((e==null)||(c.y>e)){e=c.y}if("exlow" in c){d=Math.min(d,c.x-c.exlow,c.x+c.exhigh);j=Math.max(j,c.x-c.exlow,c.x+c.exhigh);l=Math.min(l,c.y-c.eylow,c.y+c.eylow);e=Math.max(e,c.y-c.eylow,c.y+c.eylow)}}}if(d==j){j+=1}if(l==e){e+=1}var p=(j-d)*0.1;var o=(e-l)*0.1;var m=d-p,g=j+p;var k=l-o,h=e+o;if((m<0)&&(d>=0)){m=d*0.9}if((g>0)&&(j<=0)){g=0}if(this.graph.fMinimum!=-1111){k=l=this.graph.fMinimum}if(this.graph.fMaximum!=-1111){h=e=this.graph.fMaximum}if((k<0)&&(l>=0)){k=0.9*l}var i=a.CreateTH1(100);i.fName=this.graph.fName+"_h";i.fTitle=this.graph.fTitle;i.fXaxis.fXmin=m;i.fXaxis.fXmax=g;i.fYaxis.fXmin=k;i.fYaxis.fXmax=h;i.fXaxis.fMinimum=k;i.fXaxis.fMaximum=h;i.fBits=i.fBits|a.TH1StatusBits.kNoStats;return i};a.TGraphPainter.prototype.DrawBars=function(){var e=this.bins;if(e.length==1){var f=(this.graph.fHistogram["fXaxis"]["fXmax"]-this.graph.fHistogram["fXaxis"]["fXmin"]);e[0].xl=e[0].x-f/2;e[0].xr=e[0].x+f/2}else{for(var i=0;i<e.length;i++){if(i>0){e[i].xl=(e[i].x+e[i-1].x)/2}if(i<e.length-1){e[i].xr=(e[i].x+e[i+1].x)/2}else{e[i].xr=2*e[i].x-e[i].xl}if(i==0){e[i].xl=2*e[0].x-e[0].xr}}}var d=this.frame_height();var g=(this.optionBar!=1);var c=this.main_painter();return this.draw_g.selectAll("bar_graph").data(e).enter().append("svg:rect").attr("x",function(h){return(c.grx(h.xl)+0.5).toFixed(1)}).attr("y",function(h){if(g||(h.y>=0)){return c.gry(h.y).toFixed(1)}return c.gry(0).toFixed(1)}).attr("width",function(h){return(c.grx(h.xr)-c.grx(h.xl)-1).toFixed(1)}).attr("height",function(j){var h=c.gry(j.y);if(g){return h>d?0:(d-h).toFixed(1)}return(j.y<0)?(h-c.gry(0)).toFixed(1):(c.gry(0)-h).toFixed(1)}).call(this.fillatt.func)};a.TGraphPainter.prototype.DrawBins=function(){var m=this.frame_width(),q=this.frame_height();this.RecreateDrawG(false,".main_layer",false);var f=this;var k=this.main_painter();this.lineatt=a.Painter.createAttLine(this.graph);this.fillatt=this.createAttFill(this.graph);function s(i){var h="x = "+k.AxisAsText("x",i.x)+"\ny = "+k.AxisAsText("y",i.y);if(f.draw_errors&&(k.x_kind=="normal")&&("exlow" in i)&&((i.exlow!=0)||(i.exhigh!=0))){h+="\nerror x = -"+k.AxisAsText("x",i.exlow)+"/+"+k.AxisAsText("x",i.exhigh)}if(f.draw_errors&&(k.y_kind=="normal")&&("eylow" in i)&&((i.eylow!=0)||(i.eyhigh!=0))){h+="\nerror y = -"+k.AxisAsText("y",i.eylow)+"/+"+k.AxisAsText("y",i.eyhigh)}return h}if(this.optionEF>0){var t=b.svg.area().x(function(h){return k.grx(h.x).toFixed(1)}).y0(function(h){return k.gry(h.y-h.eylow).toFixed(1)}).y1(function(h){return k.gry(h.y+h.eyhigh).toFixed(1)});if(this.optionEF>1){t=t.interpolate(a.gStyle.Interpolate)}this.draw_g.append("svg:path").attr("d",t(this.bins)).style("stroke","none").call(this.fillatt.func)}var l=b.svg.line().x(function(h){return k.grx(h.x).toFixed(1)}).y(function(h){return k.gry(h.y).toFixed(1)});if(this.optionCurve==1){l=l.interpolate(a.gStyle.Interpolate)}if(this.optionBar){var n=this.DrawBars();if(a.gStyle.Tooltip){n.append("svg:title").text(s)}}if(this.lineatt.width>99){this.optionMark=0;this.DrawExclusion(l)}if(this.optionLine==1||this.optionFill==1){var c="";if(this.graph._typename=="TCutG"){c=" Z"}var v=this.lineatt;if(this.optionLine==0){v=a.Painter.createAttLine("none")}if(this.optionFill!=1){this.fillatt.color="none"}this.draw_g.append("svg:path").attr("d",l(f.bins)+c).attr("class","draw_line").style("pointer-events","none").call(v.func).call(this.fillatt.func);if(a.gStyle.Tooltip&&(this.optionMark==0)){this.draw_g.selectAll("draw_line").data(f.bins).enter().append("svg:circle").attr("cx",function(h){return k.grx(h.x).toFixed(1)}).attr("cy",function(h){return Math.round(k.gry(h.y))}).attr("r",3).style("opacity",0).append("svg:title").text(s)}}var n=null;if(this.draw_errors||this.optionMark||this.optionRect||this.optionBrackets){var d=new Array;for(var p in this.bins){var u=this.bins[p];var g=k.grx(u.x);var e=k.gry(u.y);if(!this.out_of_range&&((g<0)||(g>m)||(e<0)||(e>q))){continue}u.grx1=g.toFixed(1);u.gry1=e.toFixed(1);if(this.has_errors){u.grx0=(k.grx(u.x-u.exlow)-g).toFixed(1);u.grx2=(k.grx(u.x+u.exhigh)-g).toFixed(1);u.gry0=(k.gry(u.y-u.eylow)-e).toFixed(1);u.gry2=(k.gry(u.y+u.eyhigh)-e).toFixed(1);if(this.is_bent){u.grdx0=k.gry(u.y+this.graph.fEXlowd[p])-e;u.grdx2=k.gry(u.y+this.graph.fEXhighd[p])-e;u.grdy0=k.grx(u.x+this.graph.fEYlowd[p])-g;u.grdy2=k.grx(u.x+this.graph.fEYhighd[p])-g}else{u.grdx0=0;u.grdx2=0;u.grdy0=0;u.grdy2=0}}d.push(u)}n=this.draw_g.selectAll("g.node").data(d).enter().append("svg:g").attr("transform",function(h){return"translate("+h.grx1+","+h.gry1+")"})}if(a.gStyle.Tooltip&&n){n.append("svg:title").text(s)}if(this.optionRect){n.filter(function(h){return(h.exlow>0)&&(h.exhigh>0)&&(h.eylow>0)&&(h.eyhigh>0)}).append("svg:rect").attr("x",function(h){return h.grx0}).attr("y",function(h){return h.gry2}).attr("width",function(h){return h.grx2-h.grx0}).attr("height",function(h){return h.gry0-h.gry2}).call(this.fillatt.func)}if(this.optionBrackets){var o=n.filter(function(h){return(h.eylow>0)});o.append("svg:line").attr("x1",-5).attr("y1",function(h){return h.gry0}).attr("x2",5).attr("y2",function(h){return h.gry0}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",-5).attr("y1",function(h){return h.gry0}).attr("x2",-5).attr("y2",function(h){return Number(h.gry0)-3}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",5).attr("y1",function(h){return h.gry0}).attr("x2",5).attr("y2",function(h){return Number(h.gry0)-3}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o=n.filter(function(h){return(h.eyhigh>0)});o.append("svg:line").attr("x1",-5).attr("y1",function(h){return h.gry2}).attr("x2",5).attr("y2",function(h){return h.gry2}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",-5).attr("y1",function(h){return h.gry2}).attr("x2",-5).attr("y2",function(h){return Number(h.gry2)+3}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",5).attr("y1",function(h){return h.gry2}).attr("x2",5).attr("y2",function(h){return Number(h.gry2)+3}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width)}if(this.draw_errors){var o=n.filter(function(h){return(h.exlow>0)});o.append("svg:line").attr("y1",0).attr("x1",0).attr("x2",function(h){return h.grx0}).attr("y2",function(h){return h.grdx0.toFixed(1)}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("y1",function(h){return(h.grdx0-3).toFixed(1)}).attr("x1",function(h){return h.grx0}).attr("y2",function(h){return(h.grdx0+3).toFixed(1)}).attr("x2",function(h){return h.grx0}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o=n.filter(function(h){return(h.exhigh>0)});o.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",function(h){return h.grx2}).attr("y2",function(h){return h.grdx2.toFixed(1)}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",function(h){return h.grx2}).attr("y1",function(h){return(h.grdx2-3).toFixed(1)}).attr("x2",function(h){return h.grx2}).attr("y2",function(h){return(h.grdx2+3).toFixed(1)}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o=n.filter(function(h){return(h.eylow>0)});o.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",function(h){return h.grdy0.toFixed(1)}).attr("y2",function(h){return h.gry0}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",function(h){return(h.grdy0-3).toFixed(1)}).attr("y1",function(h){return h.gry0}).attr("x2",function(h){return(h.grdy0+3).toFixed(1)}).attr("y2",function(h){return h.gry0}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o=n.filter(function(h){return(h.eyhigh>0)});o.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",function(h){return h.grdy2.toFixed(1)}).attr("y2",function(h){return h.gry2}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width);o.append("svg:line").attr("x1",function(h){return(h.grdy2-3).toFixed(1)}).attr("y1",function(h){return h.gry2}).attr("x2",function(h){return(h.grdy2+3).toFixed(1)}).attr("y2",function(h){return h.gry2}).style("stroke",this.lineatt.color).style("stroke-width",this.lineatt.width)}if(this.optionMark){var r=(this.optionMark==2)?3:null;var j=a.Painter.createAttMarker(this.graph,r);n.append("svg:path").call(j.func)}};a.TGraphPainter.prototype.DrawExclusion=function(r){var z,y;var Q=this.graph.fNpoints;var H=new Array(Q+2),x=new Array(Q+2),F=new Array(Q+2),s=new Array(Q+2),L=new Array(2*Q+2),A=new Array(2*Q+2);var U,S,R,c,d=1;if(this.lineatt.width>32767){this.lineatt.width=65536-this.lineatt.width;d=-1}d*=(this.lineatt.width/100)*0.005;this.lineatt.width=this.lineatt.width%100;if(this.lineatt.width>0){this.optionLine=1}var J=this.frame_width(),T=this.frame_height();var K=J/T;var q=this.main_painter().xmin,I=this.main_painter().xmax,G=this.main_painter().ymin,g=this.main_painter().ymax;for(S=0;S<Q;S++){H[S]=(this.graph.fX[S]-q)/(I-q);x[S]=(this.graph.fY[S]-G)/(g-G);if(J>T){x[S]=x[S]/K}else{if(T>J){H[S]=H[S]/K}}}L[0]=H[0];A[0]=x[0];c=0;for(S=1;S<Q;S++){if(H[S]==H[S-1]&&x[S]==x[S-1]){continue}c++;L[c]=H[S];if(L[S]==L[S-1]){L[S]+=0.000001}A[c]=x[S]}if(L[1]==L[0]){U=Math.PI/2}else{U=Math.atan((A[1]-A[0])/(L[1]-L[0]))}if(L[0]<=L[1]){F[0]=L[0]-d*Math.sin(U);s[0]=A[0]+d*Math.cos(U)}else{F[0]=L[0]+d*Math.sin(U);s[0]=A[0]-d*Math.cos(U)}if(L[c]==L[c-1]){U=Math.PI/2}else{U=Math.atan((A[c]-A[c-1])/(L[c]-L[c-1]))}if(L[c]>=L[c-1]){F[c]=L[c]-d*Math.sin(U);s[c]=A[c]+d*Math.cos(U)}else{F[c]=L[c]+d*Math.sin(U);s[c]=A[c]-d*Math.cos(U)}var P,O,N,v,p,u,o,t,m;for(S=1;S<c;S++){v=L[S];p=A[S];u=L[S+1];o=A[S+1];t=L[S-1];m=A[S-1];if(u==v){P=Math.PI/2}else{P=Math.atan((o-p)/(u-v))}if(u<v){P=P+Math.PI}if(t==v){O=Math.PI/2}else{O=Math.atan((p-m)/(v-t))}if(v<t){O=O+Math.PI}x1=v-d*Math.sin(P);y1=p+d*Math.cos(P);x2=v-d*Math.sin(O);y2=p+d*Math.cos(O);xm=(x1+x2)*0.5;ym=(y1+y2)*0.5;if(xm==v){N=Math.PI/2}else{N=Math.atan((ym-p)/(xm-v))}x3=v-d*Math.sin(N+(Math.PI/2));y3=p+d*Math.cos(N+(Math.PI/2));if((xm-v)*(x3-v)<0&&(ym-p)*(y3-p)<0){x3=2*v-x3;y3=2*p-y3}if((xm==x1)&&(ym==y1)){x3=xm;y3=ym}F[S]=x3;s[S]=y3}if(L[c]==L[0]&&A[c]==A[0]){xm=(F[c]+F[0])*0.5;ym=(s[c]+s[0])*0.5;if(xm==L[0]){N=Math.PI/2}else{N=Math.atan((ym-A[0])/(xm-L[0]))}x3=L[0]+d*Math.sin(N+(Math.PI/2));y3=A[0]-d*Math.cos(N+(Math.PI/2));if((xm-L[0])*(x3-L[0])<0&&(ym-A[0])*(y3-A[0])<0){x3=2*L[0]-x3;y3=2*A[0]-y3}F[c]=x3;F[0]=x3;s[c]=y3;s[0]=y3}var M,C,l,E,k,D;var e=false;var B=c;for(S=B;S>0;S--){for(R=S-1;R>0;R--){if(F[S-1]==F[S]||F[R-1]==F[R]){continue}l=(s[S-1]-s[S])/(F[S-1]-F[S]);E=s[S]-l*F[S];k=(s[R-1]-s[R])/(F[R-1]-F[R]);D=s[R]-k*F[R];if(l!=k){M=(D-E)/(l-k);C=l*M+E;if(M>Math.min(F[S],F[S-1])&&M<Math.max(F[S],F[S-1])&&M>Math.min(F[R],F[R-1])&&M<Math.max(F[R],F[R-1])&&C>Math.min(s[S],s[S-1])&&C<Math.max(s[S],s[S-1])&&C>Math.min(s[R],s[R-1])&&C<Math.max(s[R],s[R-1])){c++;L[c]=F[S];A[c]=s[S];c++;L[c]=M;A[c]=C;S=R;e=true;break}else{continue}}else{continue}}if(!e){c++;L[c]=F[S];A[c]=s[S]}e=false}c++;L[c]=F[0];A[c]=s[0];c++;for(S=0;S<c;S++){if(J>T){L[S]=q+(L[S]*(I-q));A[S]=G+(A[S]*(g-G))*K}else{if(T>J){L[S]=q+(L[S]*(I-q))*K;A[S]=G+(A[S]*(g-G))}else{L[S]=q+(L[S]*(I-q));A[S]=G+(A[S]*(g-G))}}if((L[S]<=0)&&this.main_painter().options.Logx){L[S]=q}if((A[S]<=0)&&this.main_painter().options.Logy){A[S]=G}}var f=b.range(c).map(function(h){return{x:L[h],y:A[h]}});H.splice(0,H.length);x.splice(0,x.length);H=null;x=null;F.splice(0,F.length);s.splice(0,s.length);F=null;s=null;L.splice(0,L.length);A.splice(0,A.length);L=null;A=null;this.draw_g.append("svg:path").attr("d",r(f)).style("stroke","none").style("stroke-width",1).call(this.fillatt.func).style("opacity",0.75)};a.TGraphPainter.prototype.UpdateObject=function(c){if(c._typename!=this.graph._typename){return false}if(this.ownhisto){this.main_painter().UpdateObject(c.fHistogram)}this.graph.fX=c.fX;this.graph.fY=c.fY;this.graph.fNpoints=c.fNpoints;this.CreateBins();return true};a.Painter.drawGraph=function(f,e,d){var c=new a.TGraphPainter(e);c.CreateBins();c.SetDivId(f,-1);if(c.main_painter()==null){if(e.fHistogram==null){e.fHistogram=c.CreateHistogram()}a.Painter.drawHistogram1D(f,e.fHistogram);c.ownhisto=true}c.SetDivId(f);c.DecodeOptions(d);c.DrawBins();return c.DrawingReady()};a.TPavePainter=function(c){a.TObjectPainter.call(this,c);this.pavetext=c;this.Enabled=true};a.TPavePainter.prototype=Object.create(a.TObjectPainter.prototype);a.TPavePainter.prototype.GetObject=function(){return this.pavetext};a.TPavePainter.prototype.DrawPaveText=function(){var s=this.pavetext;var r=this.pad_width(),G=this.pad_height();if((s.fOption.indexOf("NDC")<0)&&!s.fInit){s.fInit=1;var J=this.root_pad();if(J!=null){if(J.fLogx){if(s.fX1>0){s.fX1=a.Math.log10(s.fX1)}if(s.fX2>0){s.fX2=a.Math.log10(s.fX2)}}if(J.fLogy){if(s.fY1>0){s.fY1=a.Math.log10(s.fY1)}if(s.fY2>0){s.fY2=a.Math.log10(s.fY2)}}s.fX1NDC=(s.fX1-J.fX1)/(J.fX2-J.fX1);s.fY1NDC=(s.fY1-J.fY1)/(J.fY2-J.fY1);s.fX2NDC=(s.fX2-J.fX1)/(J.fX2-J.fX1);s.fY2NDC=(s.fY2-J.fY1)/(J.fY2-J.fY1)}else{s.fX1NDC=0.1;s.fX2NDC=0.9;s.fY1NDC=0.1;s.fY2NDC=0.9}}var f=Math.round(s.fX1NDC*r);var c=Math.round((1-s.fY1NDC)*G);var C=Math.round(Math.abs(s.fX2NDC-s.fX1NDC)*r);var v=Math.round(Math.abs(s.fY2NDC-s.fY1NDC)*G);c-=v;var u=s.fLines.arr.length;var M=a.Painter.root_colors[s.fTextColor];var I=a.Painter.root_colors[s.fShadowColor];var m=this.createAttFill(s);var K=s.fBorderSize?s.fBorderSize:0;var e=a.Painter.createAttLine(s,K>0?1:0);var N=0,H=0;var g=new Array;for(var F=0;F<u;++F){var q=s.fLines.arr[F]["fTitle"];g.push(q);if(!this.IsStats()||(F==0)||(q.indexOf("|")<0)){continue}if(N===0){N=F}var B=q.split("|");if(B.length>H){H=B.length}}var o=this;this.RecreateDrawG(true,".stat_layer");this.draw_g.attr("x",f).attr("y",c).attr("width",C).attr("height",v).attr("transform","translate("+f+","+c+")");var i=this.draw_g.append("rect").attr("x",0).attr("y",0).attr("width",C).attr("height",v).call(m.func).call(e.func);var A=v/u,l=false;var L=s.fMargin*C;this.StartTextDrawing(s.fTextFont,v/(u*1.2));if(u==1){this.DrawText(s.fTextAlign,0,0,C,v,g[0],M)}else{for(var F=0;F<u;++F){var E=a.Painter.root_colors[s.fLines.arr[F]["fTextColor"]];if(s.fLines.arr[F]["fTextColor"]==0){E=M}var z=F*A;if(this.IsStats()){if((N>0)&&(F>=N)){var B=g[F].split("|");for(var y=0;y<B.length;y++){this.DrawText("middle",C*y/H,z,C/H,A,B[y],E)}}else{if(g[F].indexOf("=")<0){if(F==0){l=true}this.DrawText((F==0)?"middle":"start",L,z,C-2*L,A,g[F],E)}else{var B=g[F].split("="),p=0;for(var y=0;y<2;y++){p+=this.DrawText((y==0)?"start":"end",L,z,C-2*L,A,B[y],E)}this.TextScaleFactor(p/(C-2*L),this.draw_g)}}}else{this.DrawText(s.fTextAlign,L,z,C-2*L,A,g[F],E)}}}var d=this.FinishTextDrawing();if(s.fBorderSize&&l){this.draw_g.append("svg:line").attr("x1",0).attr("y1",A.toFixed(1)).attr("x2",C).attr("y2",A.toFixed(1)).call(e.func)}if((N>0)&&(H>1)){for(var D=N;D<u;D++){this.draw_g.append("svg:line").attr("x1",0).attr("y1",(D*A).toFixed(1)).attr("x2",C).attr("y2",(D*A).toFixed(1)).call(e.func)}for(var x=0;x<H-1;x++){this.draw_g.append("svg:line").attr("x1",(C/H*(x+1)).toFixed(1)).attr("y1",(N*A).toFixed(1)).attr("x2",(C/H*(x+1)).toFixed(1)).attr("y2",v).call(e.func)}}if(K&&K>1){this.draw_g.append("svg:line").attr("x1",C+(K/2)).attr("y1",K+1).attr("x2",C+(K/2)).attr("y2",v+K-1).style("stroke",e.color).style("stroke-width",K);this.draw_g.append("svg:line").attr("x1",K+1).attr("y1",v+(K/2)).attr("x2",C+K-1).attr("y2",v+(K/2)).style("stroke",e.color).style("stroke-width",K)}if((s.fLabel.length>0)&&!this.IsStats()){var k=this.draw_g.append("svg:g").attr("x",C*0.25).attr("y",-G*0.02).attr("width",C*0.5).attr("height",G*0.04).attr("transform","translate("+C*0.25+","+-G*0.02+")");var t=k.append("rect").attr("x",0).attr("y",0).attr("width",C*0.5).attr("height",G*0.04).call(m.func).call(e.func);this.StartTextDrawing(s.fTextFont,G*0.04/1.5,k);this.DrawText(22,0,0,C*0.5,G*0.04,s.fLabel,M,1,k);this.FinishTextDrawing(k)}this.AddDrag({obj:s,redraw:"DrawPaveText"})};a.TPavePainter.prototype.AddLine=function(c){this.pavetext.AddText(c)};a.TPavePainter.prototype.IsStats=function(){if(!this.pavetext){return false}return this.pavetext._typename=="TPaveStats"};a.TPavePainter.prototype.Format=function(e,c){if(!c){c="stat"}if(c=="stat"){c=this.pavetext.fStatFormat;if(!c){c=a.gStyle.StatFormat}}else{if(c=="fit"){c=this.pavetext.fFitFormat;if(!c){c=a.gStyle.FitFormat}}else{if(c=="entries"){if(e<1000000000){return e.toFixed(0)}c="14.7g"}else{if(c=="last"){c=this["lastformat"]}}}}delete this["lastformat"];if(!c){c="6.4g"}var d=a.FFormat(e,c);this["lastformat"]=a.lastFFormat;return d};a.TPavePainter.prototype.FillStatistic=function(){if(!this.IsStats()){return}if(this.pavetext.fName!="stats"){return}var c=new Number(this.pavetext.fOptStat);var d=new Number(this.pavetext.fOptFit);if(!c){c=a.gStyle.OptStat}if(!d){d=a.gStyle.OptFit}if("FillStatistic" in this.main_painter()){this.pavetext.Clear();this.main_painter().FillStatistic(this,c,d)}};a.TPavePainter.prototype.UpdateObject=function(c){if(c._typename!="TPaveText"){return false}this.pavetext.fLines=a.clone(c.fLines);return true};a.TPavePainter.prototype.Redraw=function(){if(this.Enabled){this.FillStatistic();this.DrawPaveText()}else{this.RemoveDrawG()}};a.Painter.drawPaveText=function(e,d){var c=new a.TPavePainter(d);c.SetDivId(e);c.FillStatistic();c.DrawPaveText();return c.DrawingReady()};a.TPadPainter=function(d,c){a.TObjectPainter.call(this,d);if(this.obj_typename==""){this.obj_typename=c?"TCanvas":"TPad"}this.pad=d;this.iscan=c;this.painters=new Array};a.TPadPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TPadPainter.prototype.GetStyleValue=function(c,d){var e=c.style(d);if(!e){return 0}e=parseFloat(e.replace("px",""));return isNaN(e)?0:e};a.TPadPainter.prototype.CreateCanvasSvg=function(e){var d=this.select_main();var k=d.node().getBoundingClientRect();var l=Math.round(k.width-this.GetStyleValue(d,"padding-left")-this.GetStyleValue(d,"padding-right"));var f=Math.round(k.height-this.GetStyleValue(d,"padding-top")-this.GetStyleValue(d,"padding-bottom"));var j=null;var g=null;if(e>0){g=this.svg_canvas();var i=g.property("last_width");var c=g.property("last_height");if((l<=0)&&(f<=0)){g.attr("visibility","hidden");return false}else{g.attr("visibility","visible")}if(e==1){if((g.attr("width")==l)&&(g.attr("height")==f)){return false}if((i==l)&&(c==f)){return false}}j=g.property("height_factor");if(j!=null){f=Math.round(l*j);d.style("height",f+"px")}if((e==1)&&(i>0)&&(c>0)&&!g.property("redraw_by_resize")){if((l/i>0.5)&&(l/i<2)&&(f/c>0.5)&&(f/c<2)){g.attr("width",l).attr("height",f);return false}}}else{if((f<10)&&(l>0)){j=0.66;if((this.pad!=null)&&("fCw" in this.pad)&&("fCh" in this.pad)&&(this.pad.fCw>0)){j=this.pad.fCh/this.pad.fCw;if((j<0.1)||(j>10)){j=0.66}}f=Math.round(l*j);d.style("height",f+"px")}var m=null;if(this.pad&&"fFillColor" in this.pad){m=this.createAttFill(this.pad)}else{m=this.createAttFill("white")}d.style("background-color",m.color);g=this.select_main().append("svg").attr("class","root_canvas").style("background-color",m.color).property("pad_painter",this).property("mainpainter",null).property("current_pad","");g.append("svg:g").attr("class","frame_layer");g.append("svg:g").attr("class","text_layer");g.append("svg:g").attr("class","stat_layer")}if((l<=0)||(f<=0)){g.attr("visibility","hidden");l=200;f=100}else{g.attr("visibility","visible")}g.attr("width",l).attr("height",f).attr("viewBox","0 0 "+l+" "+f).attr("preserveAspectRatio","none").property("height_factor",j).property("last_width",l).property("last_height",f).property("redraw_by_resize",false);return true};a.TPadPainter.prototype.CreatePadSvg=function(n){var d=Number(this.svg_canvas().attr("width")),l=Number(this.svg_canvas().attr("height"));var j=Math.round(this.pad.fAbsXlowNDC*d);var i=Math.round(l-this.pad.fAbsYlowNDC*l);var k=Math.round(this.pad.fAbsWNDC*d);var g=Math.round(this.pad.fAbsHNDC*l);i-=g;var m=this.createAttFill(this.pad);var c=a.Painter.createAttLine(this.pad);if(this.pad.fBorderMode==0){c.color="none"}var e=null,f=null;if(n){e=this.svg_pad();f=e.select(".root_pad_border")}else{e=this.svg_canvas().append("g").attr("class","root_pad").attr("pad",this.pad.fName).property("pad_painter",this).property("mainpainter",null);f=e.append("svg:rect").attr("class","root_pad_border");e.append("svg:g").attr("class","frame_layer");e.append("svg:g").attr("class","text_layer");e.append("svg:g").attr("class","stat_layer")}e.attr("width",k).attr("height",g).attr("viewBox",j+" "+i+" "+(j+k)+" "+(i+g)).attr("transform","translate("+j+","+i+")");f.attr("x",0).attr("y",0).attr("width",k).attr("height",g).call(m.func).call(c.func)};a.TPadPainter.prototype.CheckColors=function(d){if(d==null){return}for(var c in d.fPrimitives.arr){var e=d.fPrimitives.arr[c];if(e==null){continue}if((e._typename=="TObjArray")&&(e.name=="ListOfColors")){a.Painter.adoptRootColors(e);d.fPrimitives.arr.splice(c,1);d.fPrimitives.opt.splice(c,1);return}}};a.TPadPainter.prototype.DrawPrimitives=function(){if(this.pad==null){return}for(var d in this.pad.fPrimitives.arr){var c=a.draw(this.divid,this.pad.fPrimitives.arr[d],this.pad.fPrimitives.opt[d]);if(c){c._primitive=true}}};a.TPadPainter.prototype.Redraw=function(){if(this.iscan){this.CreateCanvasSvg(2)}else{this.CreatePadSvg(true)}for(var c in this.painters){this.painters[c].Redraw()}};a.TPadPainter.prototype.CheckCanvasResize=function(){if(!this.iscan){return}var d=this.CreateCanvasSvg(1);if(d){for(var c in this.painters){this.painters[c].Redraw()}}};a.TPadPainter.prototype.UpdateObject=function(g){if((g==null)||!("fPrimitives" in g)){return false}if(this.iscan){this.CheckColors(g)}if(g.fPrimitives.arr.length!=this.pad.fPrimitives.arr.length){return false}var e=false,f=0;for(var h in g.fPrimitives.arr){var d=g.fPrimitives.arr[h];while(f<this.painters.length){var c=this.painters[f++];if(!("_primitive" in c)){continue}if(c.UpdateObject(d)){e=true}break}}return e};a.Painter.drawCanvas=function(e,d){var c=new a.TPadPainter(d,true);c.SetDivId(e,-1);c.CreateCanvasSvg(0);c.SetDivId(e);if(d==null){a.Painter.drawFrame(e,null)}else{c.CheckColors(d);c.DrawPrimitives()}return c.DrawingReady()};a.Painter.drawPad=function(f,e){var c=new a.TPadPainter(e,false);c.SetDivId(f);c.CreatePadSvg();c.pad_name=e.fName;var d=c.svg_canvas().property("current_pad");c.svg_canvas().property("current_pad",e.fName);c.DrawPrimitives();c.svg_canvas().property("current_pad",d);return c.DrawingReady()};a.TPaletteAxisPainter=function(c){a.TObjectPainter.call(this,c);this.palette=c};a.TPaletteAxisPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TPaletteAxisPainter.prototype.GetObject=function(){return this.palette};a.TPaletteAxisPainter.prototype.DrawPalette=function(){var H=this.palette;var g=H.fAxis;var o=g.fNdiv%100;if(o<=0){o=8}var A=this.pad_width(),x=this.pad_height();var I=Math.round(Math.abs(H.fY2NDC-H.fY1NDC)*x);var j=g.fLabelOffset*A;var y=g.fTickSize*A;if(this.main_painter().fContour==null){this.main_painter().getValueColor(this.main_painter().minbin)}var B=this.main_painter().fContour;var p=null;if(this.main_painter().options.Logz){p=b.scale.log()}else{p=b.scale.linear()}p.domain([B[0],B[B.length-1]]).range([I,0]);var h=a.Painter.getFontDetails(g.fLabelFont,g.fLabelSize*x);var e=Math.round(H.fX1NDC*A);var d=Math.round(x*(1-H.fY1NDC));var n=Math.round(Math.abs(H.fX2NDC-H.fX1NDC)*A);d-=I;if(y>n*0.8){y=n*0.8}this.RecreateDrawG(true,".text_layer");this.draw_g.attr("x",e).attr("y",d).attr("width",n).attr("height",I).attr("transform","translate("+e+", "+d+")");for(var G=0;G<B.length-1;G++){var u=p(B[G]);var s=p(B[G+1]);var l=this.main_painter().getValueColor(B[G]);var v=this.draw_g.append("svg:rect").attr("x",0).attr("y",s.toFixed(1)).attr("width",n).attr("height",(u-s).toFixed(1)).attr("fill",l).property("fill0",l).attr("stroke",l);if(a.gStyle.Tooltip){v.on("mouseover",function(){if(a.gStyle.Tooltip){b.select(this).transition().duration(100).style("fill","grey")}}).on("mouseout",function(){b.select(this).transition().duration(100).style("fill",this["fill0"])}).append("svg:title").text(B[G].toFixed(2)+" - "+B[G+1].toFixed(2))}}var F=b.svg.axis().scale(p).orient("right").tickPadding(j).tickSize(-y,-y/2,0).ticks(o).tickFormat(function(i){return i});var K=this.draw_g.append("svg:g").attr("class","zaxis").attr("transform","translate("+n+", 0)").call(F);K.selectAll("text").call(h.func).attr("fill",a.Painter.root_colors[g.fLabelColor]);if((g.fTitle!="")&&(typeof g.fTextFont!="undefined")){var t=g.fTitleOffset*n;if("getBoundingClientRect" in this.draw_g.node()){var w=this.draw_g.node().getBoundingClientRect();t=g.fTitleOffset*(w.width-n)}t+=n+g.fTitleSize*x*1.3;if(e+t>A-3){t=A-3-e}var L=a.Painter.root_colors[g.fTextColor];this.StartTextDrawing(g.fTextFont,g.fTitleSize*x);this.DrawText(33,0,t,0,-270,g.fTitle,L);this.FinishTextDrawing()}this.AddDrag({obj:H,redraw:"DrawPalette"});if(!a.gStyle.Zooming){return}var k=this,m=null,J=false,D=0,C=0,c=null;function q(){if(!J){return}b.event.preventDefault();var i=b.mouse(m);if(i[1]<D){D=i[1]}else{C=i[1]}c.attr("y",D).attr("height",Math.abs(C-D))}function f(){if(!J){return}b.event.preventDefault();b.select(window).on("mousemove.colzoomRect",null).on("mouseup.colzoomRect",null);c.remove();c=null;J=false;var i=Math.min(p.invert(D),p.invert(C));var r=Math.max(p.invert(D),p.invert(C));k.main_painter().Zoom(0,0,0,0,i,r)}function E(){if(J){return}J=true;b.event.preventDefault();m=this;var i=b.mouse(m);D=C=i[1];c=k.draw_g.append("svg:rect").attr("class","zoom").attr("id","colzoomRect").attr("x","0").attr("width",n).attr("y",D).attr("height",5);b.select(window).on("mousemove.colzoomRect",q).on("mouseup.colzoomRect",f,true);b.event.stopPropagation()}this.draw_g.append("svg:rect").attr("x",n).attr("y",0).attr("width",20).attr("height",I).style("cursor","crosshair").style("opacity","0").on("mousedown",E)};a.TPaletteAxisPainter.prototype.Redraw=function(){var c=true;if("options" in this.main_painter()){c=(this.main_painter().options.Zscale>0)&&(this.main_painter().options.Color>0)}if(c){this.DrawPalette()}else{this.RemoveDrawG()}};a.Painter.drawPaletteAxis=function(e,d){var c=new a.TPaletteAxisPainter(d);c.SetDivId(e);c.DrawPalette();return c};a.THistPainter=function(c){a.TObjectPainter.call(this,c);this.histo=c;this.shrink_frame_left=0;this.draw_content=true;this.nbinsx=0;this.nbinsy=0;this.x_kind="normal";this.y_kind="normal"};a.THistPainter.prototype=Object.create(a.TObjectPainter.prototype);a.THistPainter.prototype.GetObject=function(){return this.histo};a.THistPainter.prototype.IsTProfile=function(){return this.histo&&this.histo._typename=="TProfile"};a.THistPainter.prototype.IsTH2Poly=function(){return this.histo&&this.histo._typename.match(/^TH2Poly/)};a.THistPainter.prototype.Dimension=function(){if(!this.histo){return 0}if("fDimension" in this.histo){return this.histo.fDimension}if(this.histo._typename.match(/^TH2/)){return 2}if(this.histo._typename.match(/^TH3/)){return 3}return 1};a.THistPainter.prototype.DecodeOptions=function(d){if((d==null)||(d=="")){d=this.histo.fOption}var g=this.Dimension();var i={Axis:0,Bar:0,Curve:0,Error:0,Hist:0,Line:0,Mark:0,Fill:0,Same:0,Scat:0,Func:0,Star:0,Arrow:0,Box:0,Text:0,Char:0,Color:0,Contour:0,Lego:0,Surf:0,Off:0,Tri:0,Proj:0,AxisPos:0,Spec:0,Pie:0,List:0,Zscale:0,FrontBox:1,BackBox:1,System:a.Painter.Coord.kCARTESIAN,AutoColor:0,NoStat:0,AutoZoom:false,HighRes:0,Zero:0,Logx:0,Logy:0,Logz:0,Gridx:0,Gridy:0};var h=d.toUpperCase();h=a.Painter.clearCuts(h);if(g>1){i.Scat=1}if((g==1)&&(this.histo.fSumw2.length>0)){i.Error=2}if("fFunctions" in this.histo){i.Func=1}if(h.indexOf("AUTOCOL")!=-1){i.AutoColor=1;i.Hist=1;h=h.replace("AUTOCOL","")}if(h.indexOf("AUTOZOOM")!=-1){i.AutoZoom=1;i.Hist=1;h=h.replace("AUTOZOOM","")}if(h.indexOf("NOSTAT")!=-1){i.NoStat=1;h=h.replace("NOSTAT","")}if(h.indexOf("LOGX")!=-1){i.Logx=1;h=h.replace("LOGX","")}if(h.indexOf("LOGY")!=-1){i.Logy=1;h=h.replace("LOGY","")}if(h.indexOf("LOGZ")!=-1){i.Logz=1;h=h.replace("LOGZ","")}h=h.trim();while((h.length>0)&&(h[0]==","||h[0]==";")){h=h.substr(1)}var k=h.length;if(!k){i.Hist=1}var f=h.indexOf("SPEC");if(f!=-1){i.Scat=0;h=h.replace("SPEC","    ");var j=0;f=h.indexOf("BF(");if(f!=-1){j=parseInt(h)}i.Spec=Math.max(1600,j);return i}if(h.indexOf("GL")!=-1){h=h.replace("GL","  ")}if(h.indexOf("X+")!=-1){i.AxisPos=10;h=h.replace("X+","  ")}if(h.indexOf("Y+")!=-1){i.AxisPos+=1;h=h.replace("Y+","  ")}if((i.AxisPos==10||i.AxisPos==1)&&(k==2)){i.Hist=1}if(i.AxisPos==11&&k==4){i.Hist=1}if(h.indexOf("SAMES")!=-1){if(k==5){i.Hist=1}i.Same=2;h=h.replace("SAMES","     ")}if(h.indexOf("SAME")!=-1){if(k==4){i.Hist=1}i.Same=1;h=h.replace("SAME","    ")}if(h.indexOf("PIE")!=-1){i.Pie=1;h=h.replace("PIE","   ")}f=h.indexOf("LEGO");if(f!=-1){i.Scat=0;i.Lego=1;h=h.replace("LEGO","    ");if(h[f+4]=="1"){i.Lego=11;h[f+4]=" "}if(h[f+4]=="2"){i.Lego=12;h[f+4]=" "}if(h[f+4]=="3"){i.Lego=13;h[f+4]=" "}f=h.indexOf("FB");if(f!=-1){i.FrontBox=0;h=h.replace("FB","  ")}f=h.indexOf("BB");if(f!=-1){i.BackBox=0;h=h.replace("BB","  ")}f=h.indexOf("0");if(f!=-1){i.Zero=1;h=h.replace("0"," ")}}f=h.indexOf("SURF");if(f!=-1){i.Scat=0;i.Surf=1;h=h.replace("SURF","    ");if(h[f+4]=="1"){i.Surf=11;h[f+4]=" "}if(h[f+4]=="2"){i.Surf=12;h[f+4]=" "}if(h[f+4]=="3"){i.Surf=13;h[f+4]=" "}if(h[f+4]=="4"){i.Surf=14;h[f+4]=" "}if(h[f+4]=="5"){i.Surf=15;h[f+4]=" "}if(h[f+4]=="6"){i.Surf=16;h[f+4]=" "}if(h[f+4]=="7"){i.Surf=17;h[f+4]=" "}f=h.indexOf("FB");if(f!=-1){i.FrontBox=0;h=h.replace("FB","  ")}f=h.indexOf("BB");if(f!=-1){i.BackBox=0;h=h.replace("BB","  ")}}f=h.indexOf("TF3");if(f!=-1){f=h.indexOf("FB");if(f!=-1){i.FrontBox=0;h=h.replace("FB","  ")}f=h.indexOf("BB");if(f!=-1){i.BackBox=0;h=h.replace("BB","  ")}}f=h.indexOf("ISO");if(f!=-1){f=h.indexOf("FB");if(f!=-1){i.FrontBox=0;h=h.replace("FB","  ")}f=h.indexOf("BB");if(f!=-1){i.BackBox=0;h=h.replace("BB","  ")}}f=h.indexOf("LIST");if(f!=-1){i.List=1;h=h.replace("LIST","  ")}f=h.indexOf("CONT");if(f!=-1){h=h.replace("CONT","    ");if(g>1){i.Scat=0;i.Contour=1;if(h[f+4]=="1"){i.Contour=11;h[f+4]=" "}if(h[f+4]=="2"){i.Contour=12;h[f+4]=" "}if(h[f+4]=="3"){i.Contour=13;h[f+4]=" "}if(h[f+4]=="4"){i.Contour=14;h[f+4]=" "}if(h[f+4]=="5"){i.Contour=15;h[f+4]=" "}}else{i.Hist=1}}f=h.indexOf("HBAR");if(f!=-1){i.Hist=0;i.Bar=20;h=h.replace("HBAR","    ");if(h[f+4]=="1"){i.Bar=21;h[f+4]=" "}if(h[f+4]=="2"){i.Bar=22;h[f+4]=" "}if(h[f+4]=="3"){i.Bar=23;h[f+4]=" "}if(h[f+4]=="4"){i.Bar=24;h[f+4]=" "}}f=h.indexOf("BAR");if(f!=-1){i.Hist=0;i.Bar=10;h=h.replace("BAR","   ");if(h[f+3]=="1"){i.Bar=11;h[f+3]=" "}if(h[f+3]=="2"){i.Bar=12;h[f+3]=" "}if(h[f+3]=="3"){i.Bar=13;h[f+3]=" "}if(h[f+3]=="4"){i.Bar=14;h[f+3]=" "}}f=h.indexOf("ARR");if(f!=-1){h=h.replace("ARR","   ");if(g>1){i.Arrow=1;i.Scat=0}else{i.Hist=1}}f=h.indexOf("BOX");if(f!=-1){h=h.replace("BOX","   ");if(g>1){Hoption.Scat=0;Hoption.Box=1;if(h[f+3]=="1"){i.Box=11;h[f+3]=" "}}else{i.Hist=1}}f=h.indexOf("COL");if(f!=-1){var c="COL";if(h.charAt(f+3)=="1"){i.Color=1;c+="1";f++}else{if(h.charAt(f+3)=="2"){i.Color=2;c+="2";f++}else{if(h.charAt(f+3)=="3"){i.Color=3;c+="3";f++}else{i.Color=a.gStyle.DefaultCol}}}if(h.charAt(f+4)=="Z"){i.Zscale=1;c+="Z"}h=h.replace(c,"");if(g==1){i.Hist=1}else{i.Scat=0}}if(h.indexOf("CHAR")!=-1){i.Char=1;h=h.replace("CHAR","    ");i.Scat=0}f=h.indexOf("FUNC");if(f!=-1){i.Func=2;h=h.replace("FUNC","    ");i.Hist=0}f=h.indexOf("HIST");if(f!=-1){i.Hist=2;h=h.replace("HIST","    ");i.Func=0;i.Error=0}if(h.indexOf("AXIS")!=-1){i.Axis=1;h=h.replace("AXIS","    ")}if(h.indexOf("AXIG")!=-1){i.Axis=2;h=h.replace("AXIG","    ")}if(h.indexOf("SCAT")!=-1){i.Scat=1;h=h.replace("SCAT","    ")}f=h.indexOf("TEXT");if(f!=-1){var e=parseInt(h);if(!isNaN(e)){if(e<0){e=0}if(e>90){e=90}i.Text=1000+e}else{i.Text=1}h=h.replace("TEXT","    ");f=h.indexOf("N");if(f!=-1&&this.IsTH2Poly()){i.Text+=3000}i.Scat=0}if(h.indexOf("POL")!=-1){i.System=a.Painter.Coord.kPOLAR;h=h.replace("POL","   ")}if(h.indexOf("CYL")!=-1){i.System=a.Painter.Coord.kCYLINDRICAL;h=h.replace("CYL","   ")}if(h.indexOf("SPH")!=-1){i.System=a.Painter.Coord.kSPHERICAL;h=h.replace("SPH","   ")}f=h.indexOf("PSR");if(f!=-1){i.System=a.Painter.Coord.kRAPIDITY;h=h.replace("PSR","   ")}f=h.indexOf("TRI");if(f!=-1){i.Scat=0;i.Color=0;i.Tri=1;h=h.replace("TRI","   ");f=h.indexOf("FB");if(f!=-1){i.FrontBox=0;h=h.replace("FB","  ")}f=h.indexOf("BB");if(f!=-1){i.BackBox=0;h=h.replace("BB","  ")}f=h.indexOf("ERR");if(f!=-1){h=h.replace("ERR","   ")}}f=h.indexOf("AITOFF");if(f!=-1){Hoption.Proj=1;h=h.replace("AITOFF","      ")}f=h.indexOf("MERCATOR");if(f!=-1){i.Proj=2;h=h.replace("MERCATOR","        ")}f=h.indexOf("SINUSOIDAL");if(f!=-1){i.Proj=3;h=h.replace("SINUSOIDAL","         ")}f=h.indexOf("PARABOLIC");if(f!=-1){i.Proj=4;h=h.replace("PARABOLIC","         ")}if(i.Proj>0){i.Scat=0;i.Contour=14}if(h.indexOf("A")!=-1){i.Axis=-1}if(h.indexOf("B")!=-1){i.Bar=1}if(h.indexOf("C")!=-1){i.Curve=1;i.Hist=-1}if(h.indexOf("F")!=-1){i.Fill=1}if(h.indexOf("][")!=-1){i.Off=1;i.Hist=1}if(h.indexOf("F2")!=-1){i.Fill=2}if(h.indexOf("L")!=-1){i.Line=1;i.Hist=-1}if(h.indexOf("P")!=-1){i.Mark=1;i.Hist=-1;if(h.indexOf("P0")!=-1){i.Mark=10}}if(h.indexOf("Z")!=-1){i.Zscale=1}if(h.indexOf("*")!=-1){i.Star=1}if(h.indexOf("H")!=-1){i.Hist=2}if(this.IsTH2Poly()){if(i.Fill+i.Line+i.Mark!=0){i.Scat=0}}if(h.indexOf("E")!=-1){if(g==1){i.Error=1;if(h.indexOf("E0")!=-1){i.Error=10}if(h.indexOf("E1")!=-1){i.Error=11}if(h.indexOf("E2")!=-1){i.Error=12}if(h.indexOf("E3")!=-1){i.Error=13}if(h.indexOf("E4")!=-1){i.Error=14}if(h.indexOf("E5")!=-1){i.Error=15}if(h.indexOf("E6")!=-1){i.Error=16}if(h.indexOf("X0")!=-1){if(i.Error==1){i.Error+=20}i.Error+=10}if(i.Text&&this.IsTProfile()){i.Text+=2000;i.Error=0}}else{if(i.Error==0){i.Error=100;i.Scat=0}if(i.Text){i.Text+=2000;i.Error=0}}}if(h.indexOf("9")!=-1){i.HighRes=1}if(i.Surf==15){if(i.System==a.Painter.Coord.kPOLAR||i.System==a.Painter.Coord.kCARTESIAN){i.Surf=13}}if(i.Bar==1){i.Hist=-1}return i};a.THistPainter.prototype.GetAutoColor=function(c){if(this.options.AutoColor<=0){return c}var d=this.options.AutoColor;this.options.AutoColor=d%8+1;return a.Painter.root_colors[d]};a.THistPainter.prototype.ScanContent=function(){alert("HistPainter.prototype.ScanContent not implemented")};a.THistPainter.prototype.CheckPadOptions=function(){var c=this.root_pad();if(c!=null){this.options.Logx=c.fLogx;this.options.Logy=c.fLogy;this.options.Logz=c.fLogz;this.options.Gridx=c.fGridx;this.options.Gridy=c.fGridy}if(this.main_painter()!==this){return}this["zoom_xmin"]=0;this["zoom_xmax"]=0;this["zoom_ymin"]=0;this["zoom_ymax"]=0;this["zoom_zmin"]=0;this["zoom_zmax"]=0;if((c!=null)&&("fUxmin" in c)&&!this.create_canvas){this["zoom_xmin"]=c.fUxmin;this["zoom_xmax"]=c.fUxmax;this["zoom_ymin"]=c.fUymin;this["zoom_ymax"]=c.fUymax;if(c.fLogx>0){this["zoom_xmin"]=Math.exp(this["zoom_xmin"]*Math.log(10));this["zoom_xmax"]=Math.exp(this["zoom_xmax"]*Math.log(10))}if(c.fLogy>0){this["zoom_ymin"]=Math.exp(this["zoom_ymin"]*Math.log(10));this["zoom_ymax"]=Math.exp(this["zoom_ymax"]*Math.log(10))}}};a.THistPainter.prototype.UpdateObject=function(c){if(c._typename!=this.histo._typename){alert("JSROOT.THistPainter.UpdateObject - wrong class "+c._typename+" expected "+this.histo._typename);return false}this.histo.fArray=c.fArray;this.histo.fNcells=c.fNcells;this.histo.fTitle=c.fTitle;this.histo.fMinimum=c.fMinimum;this.histo.fMaximum=c.fMaximum;this.histo.fXaxis["fNbins"]=c.fXaxis["fNbins"];this.histo.fXaxis["fXmin"]=c.fXaxis["fXmin"];this.histo.fXaxis["fXmax"]=c.fXaxis["fXmax"];this.histo.fYaxis["fXmin"]=c.fYaxis["fXmin"];this.histo.fYaxis["fXmax"]=c.fYaxis["fXmax"];if(this.IsTProfile()){this.histo.fBinEntries=c.fBinEntries;this.histo.fSumw2=c.fSumw2}this.ScanContent();return true};a.THistPainter.prototype.CreateXY=function(){if(!this.is_main_painter()){this["x"]=this.main_painter()["x"];this["y"]=this.main_painter()["y"];return}var c=this.frame_width(),e=this.frame_height();if(this.histo.fXaxis["fTimeDisplay"]){this.x_kind="time";this["timeoffsetx"]=a.Painter.getTimeOffset(this.histo.fXaxis);this["ConvertX"]=function(h){return new Date(this.timeoffsetx+h*1000)};this["RevertX"]=function(h){return(this.x.invert(h)-this.timeoffsetx)/1000}}else{this.x_kind=(this.histo.fXaxis.fLabels==null)?"normal":"labels";this["ConvertX"]=function(h){return h};this["RevertX"]=function(h){return this.x.invert(h)}}this["scale_xmin"]=this.xmin;this["scale_xmax"]=this.xmax;if(this.zoom_xmin!=this.zoom_xmax){this["scale_xmin"]=this.zoom_xmin;this["scale_xmax"]=this.zoom_xmax}if(this.x_kind=="time"){this["x"]=b.time.scale()}else{if(this.options.Logx){if(this.scale_xmax<=0){this.scale_xmax=0}if((this.scale_xmin<=0)&&(this.nbinsx>0)){for(var d=0;d<this.nbinsx;d++){var f=this.GetBinX(d);if(f>0){this.scale_xmin=f;break}}}if((this.scale_xmin<=0)||(this.scale_xmin>=this.scale_xmax)){this.scale_xmin=this.scale_xmax*0.0001}this["x"]=b.scale.log()}else{this["x"]=b.scale.linear()}}this.x.domain([this.ConvertX(this.scale_xmin),this.ConvertX(this.scale_xmax)]).range([0,c]);if(this.x_kind=="time"){this["grx"]=function(h){return this.x(this.ConvertX(h))}}else{if(this.options.Logx){this["grx"]=function(h){return(h<this.scale_xmin)?-5:this.x(h)}}else{this["grx"]=this.x}}this["scale_ymin"]=this.ymin;this["scale_ymax"]=this.ymax;if((this.Dimension()==1)&&(this.histo.fMinimum!=-1111)&&(this.histo.fMaximum!=-1111)){this["scale_ymin"]=this.histo.fMinimum;this["scale_ymax"]=this.histo.fMaximum}if(this.zoom_ymin!=this.zoom_ymax){this["scale_ymin"]=this.zoom_ymin;this["scale_ymax"]=this.zoom_ymax}if(this.histo.fYaxis["fTimeDisplay"]){this.y_kind="time";this["timeoffsety"]=a.Painter.getTimeOffset(this.histo.fYaxis);this["ConvertY"]=function(h){return new Date(this.timeoffsety+h*1000)};this["RevertY"]=function(h){return(this.y.invert(h)-this.timeoffsety)/1000}}else{this.y_kind=((this.Dimension()==2)&&(this.histo.fYaxis.fLabels!=null))?"labels":"normal";this["ConvertY"]=function(h){return h};this["RevertY"]=function(h){return this.y.invert(h)}}if(this.options.Logy){if(this.scale_ymax<=0){this.scale_ymax=1}if((this.scale_ymin<=0)&&(this.nbinsy>0)){for(var d=0;d<this.nbinsy;d++){var g=this.GetBinY(d);if(g>0){this.scale_ymin=g;break}}}if((this.scale_ymin<=0)&&("ymin_nz" in this)&&(this.ymin_nz>0)){this.scale_ymin=0.3*this.ymin_nz}if((this.scale_ymin<=0)||(this.scale_ymin>=this.scale_ymax)){this.scale_ymin=0.000001*this.scale_ymax}this["y"]=b.scale.log()}else{if(this.y_kind=="time"){this["y"]=b.time.scale()}else{this["y"]=b.scale.linear()}}this["y"].domain([this.ConvertY(this.scale_ymin),this.ConvertY(this.scale_ymax)]).range([e,0]);if(this.y_kind=="time"){this["gry"]=function(h){return this.y(this.ConvertY(h))}}else{if(this.options.Logy){this["gry"]=function(h){return(h<this.scale_ymin)?e+5:this.y(h)}}else{this["gry"]=this.y}}};a.THistPainter.prototype.DrawGrids=function(){if(!this.is_main_painter()){return}var d=this.svg_frame().select(".grid_layer");d.selectAll(".xgrid").remove();d.selectAll(".ygrid").remove();if(this.options.Gridx){var e=this.frame_height();var g=this.x.ticks(this.x_nticks);d.selectAll(".xgrid").data(g).enter().append("svg:line").attr("class","xgrid").attr("x1",this.x).attr("y1",e).attr("x2",this.x).attr("y2",0).style("stroke","black").style("stroke-width",1).style("stroke-dasharray",a.Painter.root_line_styles[11])}if(this.options.Gridy){var c=this.frame_width();var f=this.y.ticks(this.y_nticks);d.selectAll(".ygrid").data(f).enter().append("svg:line").attr("class","ygrid").attr("x1",0).attr("y1",this.y).attr("x2",c).attr("y2",this.y).style("stroke","black").style("stroke-width",1).style("stroke-dasharray",a.Painter.root_line_styles[11])}};a.THistPainter.prototype.DrawBins=function(){alert("HistPainter.DrawBins not implemented")};a.THistPainter.prototype.AxisAsText=function(e,g){if(e=="x"){if(this.x_kind=="time"){g=this.ConvertX(g);if("formatx" in this){return this.formatx(g)}return g.toString()}if(this.x_kind=="labels"){var f=parseInt(g)+1;if((f<1)||(f>this.histo.fXaxis.fNbins)){return null}for(var d in this.histo.fXaxis.fLabels.arr){var c=this.histo.fXaxis.fLabels.arr[d];if(c.fUniqueID==f){return c.fString}}}if(Math.abs(g)<1e-14){if(Math.abs(this.xmax-this.xmin)>0.00001){g=0}}return g.toPrecision(4)}if(e=="y"){if(this.y_kind=="labels"){var f=parseInt(g)+1;if((f<1)||(f>this.histo.fYaxis.fNbins)){return null}for(var d in this.histo.fYaxis.fLabels.arr){var c=this.histo.fYaxis.fLabels.arr[d];if(c.fUniqueID==f){return c.fString}}return null}if("dfy" in this){return this.dfy(new Date(this.timeoffsety+g*1000))}if(Math.abs(g)<1e-14){if(Math.abs(this.ymax-this.ymin)>0.00001){g=0}}return g.toPrecision(4)}return g.toPrecision(4)};a.THistPainter.prototype.DrawAxes=function(l){if(!this.is_main_painter()){return}var Q=this.frame_width(),S=this.frame_height();var U=this.svg_frame().selectAll(".xaxis_container");if(U.empty()){U=this.svg_frame().select(".axis_layer").append("svg:g").attr("class","xaxis_container")}U.selectAll("*").remove();U.attr("transform","translate(0,"+S+")");var N=this.svg_frame().selectAll(".yaxis_container");if(N.empty()){N=this.svg_frame().select(".axis_layer").append("svg:g").attr("class","yaxis_container")}N.selectAll("*").remove();var d=this.histo.fXaxis["fNdivisions"];this["x_nticks"]=d%100;var A=(d%10000-this.x_nticks)/100;var s=d/10000;var c=this.histo.fYaxis["fNdivisions"];this["y_nticks"]=c%100;var y=(c%10000-this.y_nticks)/100;var r=c/10000;var m=a.Painter.getFontDetails(this.histo.fXaxis["fLabelFont"],this.histo.fXaxis["fLabelSize"]*S);var L=3+(this.histo.fXaxis["fLabelOffset"]*S);if(this.histo.fXaxis["fTitle"].length>0){this.StartTextDrawing(this.histo.fXaxis["fTitleFont"],this.histo.fXaxis["fTitleSize"]*S,U);var J=this.DrawText("end",Q,L+m.size*(1+this.histo.fXaxis["fTitleOffset"]),0,0,this.histo.fXaxis["fTitle"],null,1,U);if(J<=0){l=true}this.FinishTextDrawing(U)}var I=3+(this.histo.fYaxis["fLabelOffset"]*Q);var z=a.Painter.getFontDetails(this.histo.fYaxis["fLabelFont"],this.histo.fYaxis["fLabelSize"]*S);if(this.histo.fYaxis["fTitle"].length>0){this.StartTextDrawing(this.histo.fYaxis["fTitleFont"],this.histo.fYaxis["fTitleSize"]*S,N);var J=this.DrawText("end",0,-I-(1+this.histo.fYaxis["fTitleOffset"])*z.size-N.property("text_font").size,0,-270,this.histo.fYaxis["fTitle"],null,1,N);if(J<=0){l=true}this.FinishTextDrawing(N)}var T=this.histo.fXaxis["fAxisColor"];var n=this.histo.fXaxis["fTickLength"]*S;var g=this.histo.fYaxis["fAxisColor"];var D=this.histo.fYaxis["fTickLength"]*Q;var B=this;delete this["formatx"];if(this.x_kind=="time"){if(this.x_nticks>8){this.x_nticks=8}var K=this.scale_xmax-this.scale_xmin;var H=a.Painter.getTimeFormat(this.histo.fXaxis);if((H.length==0)||(K<0.1*(this.xmax-this.xmin))){H=a.Painter.chooseTimeFormat(K,this.x_nticks)}if(H.length>0){this["formatx"]=b.time.format(H)}}else{if(this.options.Logx){var j=this.histo.fXaxis.TestBit(a.EAxisBits.kNoExponent);if(this.scale_xmax<100&&this.scale_xmin>0&&this.scale_xmax/this.scale_xmin<100){j=true}var q=this.histo.fXaxis.TestBit(a.EAxisBits.kMoreLogLabels);this["formatx"]=function(V){var w=parseFloat(V);var h=Math.abs(a.Math.log10(w));if(q){if(h%1<0.7||h%1>0.9999){if(j){return w.toFixed()}else{return a.Painter.formatExp(w.toExponential(0))}}else{return null}}else{if(h%1<0.0001||h%1>0.9999){if(j){return w.toFixed()}else{return a.Painter.formatExp(w.toExponential(0))}}else{return null}}}}else{if(this.x_kind=="labels"){this.x_nticks=50;var K=this.scale_xmax-this.scale_xmin;if(this.x_nticks>K){this.x_nticks=parseInt(K)}}this["formatx"]=function(h){if(this.x_kind=="labels"){return this.AxisAsText("x",h)}if((Math.abs(h)<1e-14)&&(Math.abs(this.xmax-this.xmin)>0.00001)){h=0}return parseFloat(h.toPrecision(12))}}}var t=b.svg.axis().scale(this.x).orient("bottom").tickPadding(L).tickSize(-n,-n/2,-n/4).ticks(this.x_nticks);if("formatx" in this){t.tickFormat(function(h){return B.formatx(h)})}delete this["formaty"];if(this.y_kind=="time"){if(this.y_nticks>8){this.y_nticks=8}var F=a.Painter.getTimeFormat(this.histo.fYaxis);if((F.length==0)||(k<0.1*(this.ymax-this.ymin))){F=a.Painter.chooseTimeFormat(k,this.y_nticks)}if(F.length>0){this["formaty"]=b.time.format(F)}}else{if(this.options.Logy){var i=this.histo.fYaxis.TestBit(a.EAxisBits.kNoExponent);var p=this.histo.fYaxis.TestBit(a.EAxisBits.kMoreLogLabels);if(this.scale_ymax<100&&this.scale_ymin>0&&this.scale_ymax/this.scale_ymin<100){i=true}this["formaty"]=function(V){var w=parseFloat(V);var h=Math.abs(a.Math.log10(w));if(p){if(h%1<0.7||h%1>0.9999){if(i){return w.toFixed()}else{return a.Painter.formatExp(w.toExponential(0))}}else{return null}}else{if(h%1<0.0001||h%1>0.9999){if(i){return w.toFixed()}else{return a.Painter.formatExp(w.toExponential(0))}}else{return null}}}}else{if(this.y_kind=="labels"){this.y_nticks=50;var k=this.scale_ymax-this.scale_ymin;if(this.y_nticks>k){this.y_nticks=parseInt(k)}}else{if(this.y_nticks>=10){this.y_nticks-=2}}this["formaty"]=function(h){if(this.y_kind=="labels"){return this.AxisAsText("y",h)}if((Math.abs(h)<1e-14)&&(Math.abs(B.ymax-B.ymin)>0.00001)){h=0}return parseFloat(h.toPrecision(12))}}}var R=b.svg.axis().scale(this.y).orient("left").tickPadding(I).tickSize(-D,-D/2,-D/4).ticks(this.y_nticks);if("formaty" in this){R.tickFormat(function(h){return B.formaty(h)})}var f=U.append("svg:g").attr("class","xaxis").call(t).call(m.func);if(this.x_kind=="labels"){var O=0,v=0,G=10;f.selectAll(".tick text").each(function(){var h=B.GetBoundarySizes(b.select(this).node());if(h.width>O){O=h.width}v++});if((v>0)&&(O>0)){if(O<Q/v){G=parseInt((Q/v-O)/2)}else{G=1;m.size=parseInt(m.size*(Q/v-2)/O);if(m.size<2){m.size=2}f.call(m.func)}}f.selectAll(".tick text").style("text-anchor","start").attr("x",G).attr("y",6)}else{if((A>0)&&!this.options.Logx){var C=b.svg.axis().scale(this.x).orient("bottom").tickPadding(L).innerTickSize(-n/2).tickFormat(function(h){return}).ticks(this.x.ticks(this.x_nticks).length*A);U.append("svg:g").attr("class","xaxis").call(C)}}var e=N.append("svg:g").attr("class","yaxis").call(R).call(z.func);if(this.y_kind=="labels"){var o=0,v=0,G=3;f.selectAll(".tick text").each(function(){var h=B.GetBoundarySizes(b.select(this).node());if(h.height>o){o=h.height}v++});if((v>0)&&(o>0)){if(o<S/v){G=parseInt((S/v-o)/2);e.selectAll(".tick text").attr("y",-G).attr("dy","0")}else{G=1;z.size=parseInt(z.size*(S/v-2)/o);if(z.size<2){z.size=2}e.call(z.func);e.selectAll(".tick text").attr("dy",G)}}}else{if((y>0)&&!this.options.Logy){var M=b.svg.axis().scale(this.y).orient("left").tickPadding(I).innerTickSize(-D/2).tickFormat(function(h){return}).ticks(this.y.ticks(this.y_nticks).length*y);N.append("svg:g").attr("class","yaxis").call(M)}}if(a.gStyle.Zooming){U.append("svg:rect").attr("x",0).attr("y",0).attr("width",Q).attr("height",m.size+3).style("opacity","0").style("cursor","crosshair");N.append("svg:rect").attr("x",-2*z.size-3).attr("y",0).attr("width",2*z.size+3).attr("height",S).style("opacity","0").style("cursor","crosshair")}if((l==null)&&typeof N.node()["getBoundingClientRect"]=="function"){var x=N.node().getBoundingClientRect();var u=this.svg_pad().node().getBoundingClientRect();var P=x.left-u.left;var E=0;if(P<0){E=-P/Q+0.001;this.shrink_frame_left+=E}else{if((this.shrink_frame_left>0)&&(P/Q>this.shrink_frame_left)){E=-this.shrink_frame_left;this.shrink_frame_left=0}}if(E!=0){this.svg_frame().property("frame_painter").Shrink(E,0);this.svg_frame().property("frame_painter").Redraw();this.CreateXY();this.DrawAxes(true)}}};a.THistPainter.prototype.DrawTitle=function(){var c=this.FindPainterFor(null,"title");if(c!=null){c.pavetext.Clear();c.pavetext.AddText(this.histo.fTitle)}else{var d=a.Create("TPaveText");a.extend(d,{fName:"title",fX1NDC:0.2809483,fY1NDC:0.9339831,fX2NDC:0.7190517,fY2NDC:0.995});d.AddText(this.histo.fTitle);c=a.Painter.drawPaveText(this.divid,d)}};a.THistPainter.prototype.ToggleStat=function(){var c=this.FindStat();if(c==null){c=this.CreateStat();this.Redraw();return}var d=this.FindPainterFor(c);if(d==null){alert("Did not found painter for existing stat??");return}d.Enabled=!d.Enabled;d.Redraw()};a.THistPainter.prototype.IsAxisZoomed=function(c){var d=this.main_painter();if(d==null){d=this}if(c=="x"){return d.zoom_xmin!=d.zoom_xmax}if(c=="y"){return d.zoom_ymin!=d.zoom_ymax}return false};a.THistPainter.prototype.GetSelectIndex=function(e,d,h){var f=0;var g=this.main_painter();if(g==null){g=this}var c=0;if(!h){h=0}if(e=="x"){c=this.nbinsx;if(g.zoom_xmin!=g.zoom_xmax){if(d=="left"){f=Math.floor((g.zoom_xmin-this.xmin)/this.binwidthx+h)}else{f=Math.round((g.zoom_xmax-this.xmin)/this.binwidthx+0.5+h)}}else{f=(d=="left")?0:c}}else{if(e=="y"){c=this.nbinsy;if(g.zoom_ymin!=g.zoom_ymax){if(d=="left"){f=Math.floor((g.zoom_ymin-this.ymin)/this.binwidthy+h)}else{f=Math.round((g.zoom_ymax-this.ymin)/this.binwidthy+0.5+h)}}else{f=(d=="left")?0:c}}}if(d=="left"){if(f<0){f=0}}else{if(f>c){f=c}}return f};a.THistPainter.prototype.FindStat=function(){if("fFunctions" in this.histo){for(var c in this.histo.fFunctions.arr){var d=this.histo.fFunctions.arr[c];if(d._typename=="TPaveText"||d._typename=="TPaveStats"){return d}}}return null};a.THistPainter.prototype.CreateStat=function(){if(!this.draw_content){return null}if(this.FindStat()!=null){return null}var c=a.Create("TPaveStats");a.extend(c,{_AutoCreated:true,fName:"stats",fOptStat:a.gStyle.OptStat,fOptFit:a.gStyle.OptFit,fBorderSize:1});a.extend(c,a.gStyle.StatNDC);a.extend(c,a.gStyle.StatText);a.extend(c,a.gStyle.StatFill);if(this.histo._typename&&(this.histo._typename.match(/^TProfile/)||this.histo._typename.match(/^TH2/))){c.fY1NDC=0.67}c.AddText(this.histo.fName);if(!"fFunctions" in this.histo){this.histo.fFunctions=a.Create("TList")}this.histo.fFunctions.arr.push(c);return c};a.THistPainter.prototype.FindF1=function(){if(!("fFunctions" in this.histo)){return null}for(var c in this.histo.fFunctions.arr){var d=this.histo.fFunctions.arr[c];if(d._typename=="TF1"){return d}}return null};a.THistPainter.prototype.DrawFunctions=function(){if(!("fFunctions" in this.histo)){return}if(this.options.Same){return}var d=this.histo.TestBit(a.TH1StatusBits.kNoStats)||(this.options.NoStat==1);var k=this;var h=a.BIT(9);var c={kCanDelete:a.BIT(0),kMustCleanup:a.BIT(3),kObjInCanvas:a.BIT(3),kIsReferenced:a.BIT(4),kHasUUID:a.BIT(5),kCannotPick:a.BIT(6),kNoContextMenu:a.BIT(8),kInvalidObject:a.BIT(13)};for(var f in this.histo.fFunctions.arr){var j=this.histo.fFunctions.arr[f];var e=this.histo.fFunctions.opt[f];var g=this.FindPainterFor(j);if(g!=null){continue}if(j._typename=="TPaveText"||j._typename=="TPaveStats"){if(!d){g=a.Painter.drawPaveText(this.divid,j,e)}}else{if(j._typename=="TF1"){if(!j.TestBit(h)){g=a.Painter.drawFunction(this.divid,j,e)}}else{g=a.draw(this.divid,j,e)}}}};a.THistPainter.prototype.Redraw=function(){this.CreateXY();this.DrawAxes();this.DrawGrids();this.DrawBins();if(this.create_canvas){this.DrawTitle()}};a.THistPainter.prototype.Unzoom=function(g,e,c){var d=this.main_painter();if(!d){d=this}var f=false;if(g){if(d.zoom_xmin!=d.zoom_xmax){f=true}d.zoom_xmin=d.zoom_xmax=0}if(e){if(d.zoom_ymin!=d.zoom_ymax){f=true}d.zoom_ymin=d.zoom_ymax=0}if(c){if(d.zoom_zmin!=d.zoom_zmax){f=true}d.zoom_zmin=d.zoom_zmax=0}if(f){this.RedrawPad()}};a.THistPainter.prototype.Zoom=function(h,e,f,c,d,j){var i=this.main_painter();if(!i){i=this}var g=false;if((h!=e)&&(Math.abs(e-h)>i.binwidthx*2)){i.zoom_xmin=h;i.zoom_xmax=e;g=true}if((f!=c)&&(Math.abs(c-f)>(("binwidthy" in i)?(i.binwidthy*2):Math.abs(i.ymax-i.ymin)*0.000001))){i.zoom_ymin=f;i.zoom_ymax=c;g=true}if((d!=j)&&(d!=null)&&(j!=null)){i.zoom_zmin=d;i.zoom_zmax=j;g=true}if(g){this.RedrawPad()}};a.THistPainter.prototype.AddInteractive=function(){if(!a.gStyle.Zooming||!this.is_main_painter()){return}var r=this.frame_width(),p=this.frame_height();var u,v,t=null,d=null;var o=new Date(0);var j=0;var m=false;var i=this;function h(){a.Painter.closeMenu();if(d!=null){d.remove();d=null}j=0;if(m){a.gStyle.Tooltip=true;m=false}}function q(){b.event.preventDefault();if(j>100){return}var e=b.event;h();a.Painter.createMenu(function(w){w.painter=i;w.add("header:"+i.histo.fName);i.FillContextMenu(w);w.show(e)})}function g(){if(j!=0){b.event.preventDefault();b.event.stopPropagation();return}r=Number(i.svg_frame().attr("width"));p=Number(i.svg_frame().attr("height"));u=this;var w=b.touches(u);if(w.length==1){var x=new Date();var y=x.getTime()-o.getTime();if((y<300)&&(t!=null)&&(Math.abs(t[0]-w[0][0])<30)&&(Math.abs(t[1]-w[0][1])<30)){b.event.preventDefault();b.event.stopPropagation();h();i.Unzoom(true,true,true)}else{o=x;t=w[0]}}if(w.length!=2){return}b.event.preventDefault();h();var e=w[0];var z=w[1];t=new Array;v=new Array;t.push(Math.min(e[0],z[0]));t.push(Math.min(e[1],z[1]));v.push(Math.max(e[0],z[0]));v.push(Math.max(e[1],z[1]));if(t[0]<0){j=103;t[0]=0;v[0]=r}else{if(v[1]>p){j=102;t[1]=0;v[1]=p}else{j=101}}d=i.svg_frame().append("rect").attr("class","zoom").attr("id","zoomRect").attr("x",t[0]).attr("y",t[1]).attr("width",v[0]-t[0]).attr("height",v[1]-t[1]);b.select(window).on("touchmove.zoomRect",f).on("touchcancel.zoomRect",k).on("touchend.zoomRect",k,true);b.event.stopPropagation()}function f(){if(j<100){return}b.event.preventDefault();var w=b.touches(u);if(w.length!=2){h();j=0;return}var e=w[0];var x=w[1];if(j!=103){t[0]=Math.min(e[0],x[0]);v[0]=Math.max(e[0],x[0])}if(j!=102){t[1]=Math.min(e[1],x[1]);v[1]=Math.max(e[1],x[1])}d.attr("x",t[0]).attr("y",t[1]).attr("width",v[0]-t[0]).attr("height",v[1]-t[1]);if(a.gStyle.Tooltip&&((v[0]-t[0]>10)||(v[1]-t[1]>10))){a.gStyle.Tooltip=false;m=true}b.event.stopPropagation()}function k(){if(j<100){return}b.event.preventDefault();b.select(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);b.select("body").classed("noselect",false);var z=0,w=0,x=0,e=0;var y=false;if((j!=103)&&(Math.abs(t[0]-v[0])>10)){z=Math.min(i.RevertX(v[0]),i.RevertX(t[0]));w=Math.max(i.RevertX(v[0]),i.RevertX(t[0]));y=true}if((j!=102)&&(Math.abs(t[1]-v[1])>10)){x=Math.min(i.y.invert(v[1]),i.y.invert(t[1]));e=Math.max(i.y.invert(v[1]),i.y.invert(t[1]));y=true}b.select("body").style("-webkit-user-select","auto");if(m){a.gStyle.Tooltip=true}d.remove();d=null;j=0;if(y){i.Zoom(z,w,x,e)}b.event.stopPropagation()}function s(){if(j>100){return}b.event.preventDefault();r=Number(i.svg_frame().attr("width"));p=Number(i.svg_frame().attr("height"));h();u=this;v=b.mouse(u);t=new Array;t.push(Math.max(0,Math.min(r,v[0])));t.push(Math.max(0,Math.min(p,v[1])));if(v[0]<0){j=3;v[0]=0;v[1]=t[1];t[0]=r;t[1]+=1}else{if(v[1]>p){j=2;v[0]=t[0];v[1]=0;t[0]+=1;t[1]=p}else{j=1;v[0]=t[0];v[1]=t[1]}}d=i.svg_frame().append("rect").attr("class","zoom").attr("id","zoomRect");i.svg_frame().on("dblclick",n);b.select(window).on("mousemove.zoomRect",l).on("mouseup.zoomRect",c,true);b.event.stopPropagation()}function n(){b.event.preventDefault();var e=b.mouse(u);h();if(e[0]<0){i.Unzoom(false,true,false)}else{if(e[1]>p){i.Unzoom(true,false,false)}else{i.Unzoom(true,true,true);i.svg_frame().on("dblclick",null)}}}function l(){if((j==0)||(j>100)){return}b.event.preventDefault();var e=b.mouse(u);e[0]=Math.max(0,Math.min(r,e[0]));e[1]=Math.max(0,Math.min(p,e[1]));switch(j){case 1:t[0]=e[0];t[1]=e[1];break;case 2:t[0]=e[0];break;case 3:t[1]=e[1];break}d.attr("x",Math.min(v[0],t[0])).attr("y",Math.min(v[1],t[1])).attr("width",Math.abs(t[0]-v[0])).attr("height",Math.abs(t[1]-v[1]));if(a.gStyle.Tooltip&&((Math.abs(t[0]-v[0])>10)||(Math.abs(t[1]-v[1])>10))){a.gStyle.Tooltip=false;m=true}}function c(){if((j==0)||(j>100)){return}b.event.preventDefault();b.select(window).on("mousemove.zoomRect",null).on("mouseup.zoomRect",null);b.select("body").classed("noselect",false);var w=b.mouse(u);w[0]=Math.max(0,Math.min(r,w[0]));w[1]=Math.max(0,Math.min(p,w[1]));switch(j){case 1:t[0]=w[0];t[1]=w[1];break;case 2:t[0]=w[0];break;case 3:t[1]=w[1];break}var A=0,x=0,y=0,e=0;var z=false;if((j!=3)&&(Math.abs(t[0]-v[0])>10)){A=Math.min(i.RevertX(v[0]),i.RevertX(t[0]));x=Math.max(i.RevertX(v[0]),i.RevertX(t[0]));z=true}if((j!=2)&&(Math.abs(t[1]-v[1])>10)){y=Math.min(i.y.invert(v[1]),i.y.invert(t[1]));e=Math.max(i.y.invert(v[1]),i.y.invert(t[1]));z=true}b.select("body").style("-webkit-user-select","auto");if(m){a.gStyle.Tooltip=true;m=false}d.remove();d=null;j=0;if(z){i.Zoom(A,x,y,e)}}this.svg_frame().on("mousedown",s);this.svg_frame().on("touchstart",g);if(a.gStyle.ContextMenu){this.svg_frame().on("contextmenu",q)}};a.THistPainter.prototype.FillContextMenu=function(d){if(this.zoom_xmin!=this.zoom_xmax){d.add("Unzoom X",function(){d.painter.Unzoom(true,false,false)})}if(this.zoom_ymin!=this.zoom_ymax){d.add("Unzoom Y",function(){d.painter.Unzoom(false,true,false)})}if(this.zoom_zmin!=this.zoom_zmax){d.add("Unzoom Z",function(){d.painter.Unzoom(false,false,true)})}d.add("Unzoom",function(){d.painter.Unzoom(true,true,true)});d.add(a.gStyle.Tooltip?"Disable tooltip":"Enable tooltip",function(){a.gStyle.Tooltip=!a.gStyle.Tooltip;d.painter.RedrawPad()});if(this.options){var c=this.options.Logx>0?"Linear X":"Log X";d.add(c,function(){d.painter.options.Logx=1-d.painter.options.Logx;d.painter.RedrawPad()});c=this.options.Logy>0?"Linear Y":"Log Y";d.add(c,function(){d.painter.options.Logy=1-d.painter.options.Logy;d.painter.RedrawPad()});if(this.Dimension()==2){c=this.options.Logz>0?"Linear Z":"Log Z";d.add(c,function(){d.painter.options.Logz=1-d.painter.options.Logz;d.painter.RedrawPad()})}}if(this.draw_content){d.add("Toggle stat",function(){d.painter.ToggleStat()})}};a.TH1Painter=function(c){a.THistPainter.call(this,c)};a.TH1Painter.prototype=Object.create(a.THistPainter.prototype);a.TH1Painter.prototype.ScanContent=function(){this.fill=this.createAttFill(this.histo);if(this.fill.color=="white"){this.fill.color="none"}this.attline=a.Painter.createAttLine(this.histo);var f=this.main_painter();if(f!=null){this.attline.color=f.GetAutoColor(this.attline.color)}var e=0,c=0,j=0,h=0;var d=this.IsTProfile();this.nbinsx=this.histo.fXaxis["fNbins"];for(var g=0;g<this.nbinsx;++g){var k=this.histo.getBinContent(g+1);h+=d?this.histo.fBinEntries[g+1]:k;if(k>0){if((c==0)||(k<c)){c=k}}if(this.options.Error>0){k+=this.histo.getBinError(g+1)}if(g==0){e=j=k}if(k<e){e=k}else{if(k>j){j=k}}}if(d){h+=this.histo.fBinEntries[0]+this.histo.fBinEntries[this.nbinsx+1]}else{h+=this.histo.getBinContent(0)+this.histo.getBinContent(this.nbinsx+1)}this.stat_entries=h;this.xmin=this.histo.fXaxis["fXmin"];this.xmax=this.histo.fXaxis["fXmax"];this.binwidthx=(this.xmax-this.xmin);if(this.nbinsx>0){this.binwidthx=this.binwidthx/this.nbinsx}this["GetBinX"]=function(i){return this.xmin+i*this.binwidthx};this.ymin=this.histo.fYaxis["fXmin"];this.ymax=this.histo.fYaxis["fXmax"];this.ymin_nz=c;if((this.nbinsx==0)||((Math.abs(e)<1e-300&&Math.abs(j)<1e-300))){if(this.histo.fMinimum!=-1111){this.ymin=this.histo.fMinimum}if(this.histo.fMaximum!=-1111){this.ymax=this.histo.fMaximum}this.draw_content=false}else{if(this.histo.fMinimum!=-1111){e=this.histo.fMinimum}if(this.histo.fMaximum!=-1111){j=this.histo.fMaximum}if(e>=j){if(e==0){this.ymax=0;this.ymax=1}else{if(e<0){this.ymin=2*e;this.ymax=0}else{this.ymin=0;this.ymax=e*2}}}else{var l=(j-e)*0.1;this.ymin=e-l;if((this.ymin<0)&&(e>=0)){this.ymin=0}this.ymax=j+l}this.draw_content=true}if(this.options.Bar==0&&this.options.Hist==0&&this.options.Error==0&&this.options.Same==0){this.draw_content=false}if(this.options.Axis>0){this.draw_content=false}};a.TH1Painter.prototype.CountStat=function(o){var e=this.IsTProfile();var f=0,l=0,r=0,k=0,j=0;var d=this.GetSelectIndex("x","left");var q=this.GetSelectIndex("x","right");var c=0,p=0,h=null,n=null;for(var g=d;g<q;g++){c=this.GetBinX(g+0.5);if((o!=null)&&!o(c)){continue}if(e){p=this.histo.fBinEntries[g+1];k+=this.histo.fArray[g+1];j+=this.histo.fSumw2[g+1]}else{p=this.histo.getBinContent(g+1)}if((h==null)||(p>n)){h=c;n=p}f+=p;l+=p*c;r+=p*c*c}if(!this.IsAxisZoomed("x")&&(this.histo.fTsumw>0)){f=this.histo.fTsumw;l=this.histo.fTsumwx;r=this.histo.fTsumwx2}var m={meanx:0,meany:0,rmsx:0,rmsy:0,integral:f,entries:this.stat_entries,xmax:0,wmax:0};if(f>0){m.meanx=l/f;m.meany=k/f;m.rmsx=Math.sqrt(r/f-m.meanx*m.meanx);m.rmsy=Math.sqrt(j/f-m.meany*m.meany)}if(h!=null){m.xmax=h;m.wmax=n}return m};a.TH1Painter.prototype.FillStatistic=function(v,j,w){if(!this.histo){return false}var z=this.CountStat();var s=Math.floor(j%10);var f=Math.floor(j/10)%10;var l=Math.floor(j/100)%10;var x=Math.floor(j/1000)%10;var g=Math.floor(j/10000)%10;var k=Math.floor(j/100000)%10;var q=Math.floor(j/1000000)%10;var B=Math.floor(j/10000000)%10;var t=Math.floor(j/100000000)%10;if(s>0){v.AddLine(this.histo.fName)}if(this.IsTProfile()){if(f>0){v.AddLine("Entries = "+v.Format(z.entries,"entries"))}if(l>0){v.AddLine("Mean = "+v.Format(z.meanx));v.AddLine("Mean y = "+v.Format(z.meany))}if(x>0){v.AddLine("Std Dev = "+v.Format(z.rmsx));v.AddLine("Std Dev y = "+v.Format(z.rmsy))}}else{if(f>0){v.AddLine("Entries = "+v.Format(z.entries,"entries"))}if(l>0){v.AddLine("Mean = "+v.Format(z.meanx))}if(x>0){v.AddLine("Std Dev = "+v.Format(z.rmsx))}if(g>0){var A=0;if(this.histo.fArray.length>0){A=this.histo.fArray[0]}v.AddLine("Underflow = "+v.Format(A))}if(k>0){var A=0;if(this.histo.fArray.length>0){A=this.histo.fArray[this.histo.fArray.length-1]}v.AddLine("Overflow = "+v.Format(A))}if(q>0){v.AddLine("Integral = "+v.Format(z.integral,"entries"))}if(B>0){v.AddLine("Skew = <not avail>")}if(t>0){v.AddLine("Kurt = <not avail>")}}if(w!=0){var o=this.FindF1();if(o!=null){var c=w%10;var p=(w/10)%10;var d=(w/100)%10;var i=(w/1000)%10;if(d>0){v.AddLine("#chi^2 / ndf = "+v.Format(o.fChisquare,"fit")+" / "+o.fNDF)}if(i>0){v.AddLine("Prob = <not avail>")}if((c>0)||(p>0)){for(var m=0;m<o.fNpar;m++){var y=o.GetParName(m);var u=o.GetParValue(m);if(u!=null){u=v.Format(Number(u),"fit")}else{u="<not avail>"}var r="";if(o.fParErrors!=null){r=v.Format(o.fParErrors[m],"last");if((Number(r)==0)&&(o.fParErrors[m]!=0)){r=v.Format(o.fParErrors[m],"4.2g")}}if((p>0)&&(r.length>0)){v.AddLine(y+" = "+u+" #pm "+r)}else{v.AddLine(y+" = "+u)}}}}}var h=v.pavetext.fLines.arr.length;var e=h*a.gStyle.StatFontSize;if(e<=0||3==(a.gStyle.StatFont%10)){e=0.25*h*a.gStyle.StatH;v.pavetext.fY1NDC=0.93-e;v.pavetext.fY2NDC=0.93}return true};a.TH1Painter.prototype.CreateDrawBins=function(p,n,r){var g=this.GetSelectIndex("x","left",-1);var v=this.GetSelectIndex("x","right",2);var d=new Array;var w=((a.gStyle.OptimizeDraw>0)&&(v-g>5000))||((a.gStyle.OptimizeDraw>1)&&(v-g>2*p));var u,t=this.GetBinX(g);var h=-1111,e=-1111,f;var q=null;var j=false;var l=this.main_painter();var x=this.GetItemName();if((x==null)||(x=="")){x=this.histo.fName}for(var s=g;s<v;s++){u=t;t=this.GetBinX(s+1);if(this.options.Logx&&(u<=0)){continue}h=e;e=l.grx(t);if(h<0){h=l.grx(u)}var m=s,c=this.histo.getBinContent(s+1);if(w){j=!j;while((s+1<v)&&(l.grx(this.GetBinX(s+2))<e+0.5)){s++;t=this.GetBinX(s+1);var k=this.histo.getBinContent(s+1);if(j?k>c:k<c){c=k;m=s}}e=l.grx(t)}if(r&&(c==0)){continue}if(this.options.Logy&&(c<this.scale_ymin)){f=n+10}else{f=l.gry(c)}q={x:h,y:f};if(this.options.Error>0){q.xerr=(e-h)/2;q.yerr=f-l.gry(c+this.histo.getBinError(m+1))}if(this.options.Error>0){q.x=(h+e)/2;q.tip=x+"\nx = "+this.AxisAsText("x",(u+t)/2)+"\ny = "+this.AxisAsText("y",c)+"\nerror x = "+((t-u)/2).toPrecision(4)+"\nerror y = "+this.histo.getBinError(m+1).toPrecision(4)}else{q.width=e-h;q.tip=x+"\nbin = "+(m+1)+"\n";if(l.x_kind=="labels"){q.tip+=("x = "+this.AxisAsText("x",u)+"\n")}else{q.tip+=("x = ["+this.AxisAsText("x",u)+", "+this.AxisAsText("x",t)+"]\n")}q.tip+=("entries = "+a.FFormat(c,a.gStyle.StatFormat))}d.push(q)}if((v==this.nbinsx)&&(this.options.Error==0)&&(q!=null)){var o=a.extend({},q);o.x=e;d.push(o)}return d};a.TH1Painter.prototype.DrawAsMarkers=function(g,d,f){var g=this.CreateDrawBins(d,f,(this.options.Error!=10)&&(this.options.Mark!=10));var e=this.draw_g.selectAll("g").data(g).enter().append("svg:g").attr("transform",function(h){return"translate("+h.x.toFixed(1)+","+h.y.toFixed(1)+")"});if(a.gStyle.Tooltip){e.append("svg:title").text(function(h){return h.tip})}if(this.options.Error==12){e.append("svg:rect").attr("x",function(h){return(-h.xerr).toFixed(1)}).attr("y",function(h){return(-h.yerr).toFixed(1)}).attr("width",function(h){return(2*h.xerr).toFixed(1)}).attr("height",function(h){return(2*h.yerr).toFixed(1)}).call(this.fill.func).style("pointer-events","visibleFill").property("fill0",this.fill.color).on("mouseover",function(){if(a.gStyle.Tooltip){b.select(this).transition().duration(100).style("fill","grey")}}).on("mouseout",function(){b.select(this).transition().duration(100).style("fill",this["fill0"])})}else{if(this.options.Error>0){e.append("svg:line").attr("x1",function(h){return(-h.xerr).toFixed(1)}).attr("y1",0).attr("x2",function(h){return h.xerr.toFixed(1)}).attr("y2",0).call(this.attline.func);e.append("svg:line").attr("x1",0).attr("y1",function(h){return(-h.yerr).toFixed(1)}).attr("x2",0).attr("y2",function(h){return h.yerr.toFixed(1)}).call(this.attline.func)}}if(this.options.Error==11){e.append("svg:line").attr("y1",-3).attr("x1",function(h){return(-h.xerr).toFixed(1)}).attr("y2",3).attr("x2",function(h){return(-h.xerr).toFixed(1)}).call(this.attline.func);e.append("svg:line").attr("y1",-3).attr("x1",function(h){return h.xerr.toFixed(1)}).attr("y2",3).attr("x2",function(h){return h.xerr.toFixed(1)}).call(this.attline.func);e.append("svg:line").attr("x1",-3).attr("y1",function(h){return(-h.yerr).toFixed(1)}).attr("x2",3).attr("y2",function(h){return(-h.yerr).toFixed(1)}).call(this.attline.func);e.append("svg:line").attr("x1",-3).attr("y1",function(h){return h.yerr.toFixed(1)}).attr("x2",3).attr("y2",function(h){return h.yerr.toFixed(1)}).call(this.attline.func)}if(this.options.Mark>0){var c=a.Painter.createAttMarker(this.histo);e.append("svg:path").call(c.func)}};a.TH1Painter.prototype.DrawBins=function(){var e=this.frame_width(),c=this.frame_height();if(!this.draw_content||(e<=0)||(c<=0)){this.RemoveDrawG();return}this.RecreateDrawG(false,".main_layer",false);if((this.options.Error>0)||(this.options.Mark>0)){return this.DrawAsMarkers(e,c)}var g=this.CreateDrawBins(e,c);if(this.fill.color!="none"){var f=b.svg.area().x(function(h){return h.x.toFixed(1)}).y0(function(h){return h.y.toFixed(1)}).y1(function(h){return c}).interpolate("step-after");this.draw_g.append("svg:path").attr("d",f(g)).style("pointer-events","none").call(this.attline.func).call(this.fill.func)}else{var d=b.svg.line().x(function(h){return h.x.toFixed(1)}).y(function(h){return h.y.toFixed(1)}).interpolate("step-after");this.draw_g.append("svg:path").attr("d",d(g)).call(this.attline.func).style("fill","none")}if(a.gStyle.Tooltip){this.draw_g.selectAll("selections").data(g).enter().append("svg:line").attr("x1",function(h){return h.x+h.width/2}).attr("y1",function(h){return Math.max(0,h.y)}).attr("x2",function(h){return h.x+h.width/2}).attr("y2",function(h){return c}).style("opacity",0).style("stroke","#4572A7").style("stroke-width",function(h){return h.width}).on("mouseover",function(){if(a.gStyle.Tooltip&&(b.select(this).style("opacity")=="0")){b.select(this).transition().duration(100).style("opacity","0.3")}}).on("mouseout",function(){b.select(this).transition().duration(100).style("opacity","0")}).append("svg:title").text(function(h){return h.tip})}};a.TH1Painter.prototype.FillContextMenu=function(c){a.THistPainter.prototype.FillContextMenu.call(this,c);if(this.draw_content){c.add("Auto zoom-in",function(){c.painter.AutoZoom()})}};a.TH1Painter.prototype.AutoZoom=function(){var f=this.GetSelectIndex("x","left",-1);var d=this.GetSelectIndex("x","right",1);var g=(d-f);if(g==0){return}var c=this.histo.getBinContent(f+1);for(var e=f;e<d;e++){if(this.histo.getBinContent(e+1)<c){c=this.histo.getBinContent(e+1)}}if(c>0){return}while((f<d)&&(this.histo.getBinContent(f+1)<=c)){f++}while((f<d)&&(this.histo.getBinContent(d)<=c)){d--}if((d-f<g)&&(f<d)){this.Zoom(this.GetBinX(f),this.GetBinX(d),0,0)}};a.Painter.drawHistogram1D=function(f,d,e){var c=new a.TH1Painter(d);c.SetDivId(f,1);c.options=c.DecodeOptions(e);c.CheckPadOptions();c.ScanContent();c.CreateXY();c.DrawAxes();c.DrawGrids();c.DrawBins();if(c.create_canvas){c.DrawTitle()}if(a.gStyle.AutoStat&&c.create_canvas){c.CreateStat()}c.DrawFunctions();c.AddInteractive();if(c.options.AutoZoom){c.AutoZoom()}return c.DrawingReady()};a.TH2Painter=function(c){a.THistPainter.call(this,c);this.fContour=null;this.fUserContour=false};a.TH2Painter.prototype=Object.create(a.THistPainter.prototype);a.TH2Painter.prototype.FillContextMenu=function(c){a.THistPainter.prototype.FillContextMenu.call(this,c);c.add("Auto zoom-in",function(){c.painter.AutoZoom()});c.add("Draw in 3D",function(){c.painter.Draw3D()});c.add("Toggle col",function(){if(c.painter.options.Color==0){c.painter.options.Color=a.gStyle.DefaultCol}else{c.painter.options.Color=-1*c.painter.options.Color}c.painter.RedrawPad()});if(this.options.Color>0){c.add("Toggle colz",function(){c.painter.ToggleColz()})}};a.TH2Painter.prototype.FindPalette=function(c){if("fFunctions" in this.histo){for(var d in this.histo.fFunctions.arr){var e=this.histo.fFunctions.arr[d];if(e._typename!="TPaletteAxis"){continue}if(c){this.histo.fFunctions.RemoveAt(d);return null}return e}}return null};a.TH2Painter.prototype.ToggleColz=function(){if(this.FindPalette()==null){var c=this.CreatePalette(0.04);this.svg_frame().property("frame_painter").Shrink(0,c);this.options.Zscale=1;a.Painter.drawPaletteAxis(this.divid,this.FindPalette())}else{if(this.options.Zscale>0){this.options.Zscale=0}else{this.options.Zscale=1}}this.RedrawPad()};a.TH2Painter.prototype.AutoZoom=function(){var k=this.GetSelectIndex("x","left",-1);var h=this.GetSelectIndex("x","right",1);var s=this.GetSelectIndex("y","left",-1);var r=this.GetSelectIndex("y","right",1);if((k==h)||(s==r)){return}var m=this.histo.getBinContent(k+1,s+1);for(var p=k;p<h;p++){for(var n=s;n<r;n++){if(this.histo.getBinContent(p+1,n+1)<m){m=this.histo.getBinContent(p+1,n+1)}}}if(m>0){return}var f=h,e=k,c=r,l=s;for(var p=k;p<h;p++){for(var n=s;n<r;n++){if(this.histo.getBinContent(p+1,n+1)>m){if(p<f){f=p}if(p>=e){e=p+1}if(n<c){c=n}if(n>=l){l=n+1}}}}var d=0,o=0,q=0,g=0;if((f>k||e<h)&&(f<e-1)){d=this.GetBinX(f);o=this.GetBinX(e)}if((c>s||l<r)&&(c<l-1)){q=this.GetBinY(c);g=this.GetBinY(l)}this.Zoom(d,o,q,g)};a.TH2Painter.prototype.CreatePalette=function(o){if(this.FindPalette()!=null){return 0}if(!o||o<=0){o=0.04}var p={};p._typename="TPaletteAxis";p.fName="palette";p._AutoCreated=true;var n=this.svg_frame().property("NDC");p.fX1NDC=n.fX2NDC-o;p.fY1NDC=n.fY1NDC;p.fX2NDC=n.fX2NDC;p.fY2NDC=n.fY2NDC;p.fInit=1;p.fShadowColor=1;p.fCorenerRadius=0;p.fResizing=false;p.fBorderSize=4;p.fName="TPave";p.fOption="br";p.fLineColor=1;p.fLineSyle=1;p.fLineWidth=1;p.fFillColor=1;p.fFillSyle=1;var g={};g._typename="TGaxis";g.fTickSize=0.03;g.fLabelOffset=0.005;g.fLabelSize=0.035;g.fTitleOffset=1;g.fTitleSize=0.035;g.fNdiv=8;g.fLabelColor=1;g.fLabelFont=42;g.fChopt="";g.fName="";g.fTitle=this.histo.fZaxis.fTitle;g.fTimeFormat="";g.fFunctionName="";g.fWmin=0;g.fWmax=100;g.fLineColor=1;g.fLineSyle=1;g.fLineWidth=1;g.fTextAngle=0;g.fTextSize=0.04;g.fTextAlign=11;g.fTextColor=1;g.fTextFont=42;p.fAxis=g;if(!"fFunctions" in this.histo){this.histo.fFunctions=a.Create("TList")}this.histo.fFunctions.AddFirst(p);var d=this.frame_width(),q=this.frame_height();var l=Math.round(g.fLabelOffset*d);var j=Math.round(g.fTickSize*d);var c=a.Painter.getFontDetails(g.fLabelFont,g.fLabelSize*q);var m=b.scale.linear().clamp(true).domain([this.gminbin,this.gmaxbin]).range([q,0]).nice().ticks(g.fNdiv%100);var f=0;for(var h in m){var k=c.stringWidth(this.svg_frame(),m[h]);if(k>f){f=k}}var r=(f+5+l)/d;if(p.fX2NDC+r>0.98){var e=p.fX2NDC+r-0.98;p.fX1NDC-=e;p.fX2NDC-=e;o+=e}return o+0.01};a.TH2Painter.prototype.ScanContent=function(){this.fillcolor=a.Painter.root_colors[this.histo.fFillColor];this.attline=a.Painter.createAttLine(this.histo);if(this.attline.color=="none"){this.attline.color="#4572A7"}this.nbinsx=this.histo.fXaxis["fNbins"];this.nbinsy=this.histo.fYaxis["fNbins"];this.xmin=this.histo.fXaxis["fXmin"];this.xmax=this.histo.fXaxis["fXmax"];this.ymin=this.histo.fYaxis["fXmin"];this.ymax=this.histo.fYaxis["fXmax"];this.binwidthx=(this.xmax-this.xmin);if(this.nbinsx>0){this.binwidthx=this.binwidthx/this.nbinsx}this["GetBinX"]=function(f){return this.xmin+f*this.binwidthx};this.binwidthy=(this.ymax-this.ymin);if(this.nbinsy>0){this.binwidthy=this.binwidthy/this.nbinsy}this["GetBinY"]=function(f){return this.ymin+f*this.binwidthy};this.gmaxbin=this.histo.getBinContent(1,1);this.gminbin=this.gmaxbin;for(var d=0;d<this.nbinsx;++d){for(var c=0;c<this.nbinsy;++c){var e=this.histo.getBinContent(d+1,c+1);if(e<this.gminbin){this.gminbin=e}else{if(e>this.gmaxbin){this.gmaxbin=e}}}}this.draw_content=this.gmaxbin>0};a.TH2Painter.prototype.CountStat=function(i){var e=0,h=0,p=0,g=0,o=0,s=0;var w={entries:0,integral:0,meanx:0,meany:0,rmsx:0,rmsy:0,matrix:[],xmax:0,ymax:0,wmax:null};for(var m=0;m<9;m++){w.matrix.push(0)}var d=this.GetSelectIndex("x","left");var l=this.GetSelectIndex("x","right");var t=this.GetSelectIndex("y","left");var r=this.GetSelectIndex("y","right");for(var k=0;k<=this.nbinsx+1;k++){var c=(k<=d)?0:(k>l?2:1);var f=this.GetBinX(k-0.5);for(var v=0;v<=this.nbinsx+1;v++){var q=(v<=t)?0:(v>r?2:1);var j=this.ymin+(v-0.5)*this.binwidthy;var u=this.histo.getBinContent(k,v);w.entries+=u;w.matrix[q*3+c]+=u;if((c!=1)||(q!=1)){continue}if((i!=null)&&!i(f,j)){continue}if((w.wmax==null)||(u>w.wmax)){w.wmax=u;w.xmax=f;w.ymax=j}e+=u;h+=f*u;p+=j*u;g+=f*f*u;o+=j*j*u;s+=f*j*u}}if(!this.IsAxisZoomed("x")&&!this.IsAxisZoomed("y")&&(this.histo.fTsumw>0)){e=this.histo.fTsumw;h=this.histo.fTsumwx;g=this.histo.fTsumwx2;p=this.histo.fTsumwy;o=this.histo.fTsumwy2;s=this.histo.fTsumwxy}if(e>0){w.meanx=h/e;w.meany=p/e;w.rmsx=Math.sqrt(g/e-w.meanx*w.meanx);w.rmsy=Math.sqrt(o/e-w.meany*w.meany)}if(w.wmax==null){w.wmax=0}w.integral=e;return w};a.TH2Painter.prototype.FillStatistic=function(i,j,s){if(!this.histo){return false}var h=this.CountStat();var n=Math.floor(j%10);var p=Math.floor(j/10)%10;var l=Math.floor(j/100)%10;var q=Math.floor(j/1000)%10;var c=Math.floor(j/10000)%10;var d=Math.floor(j/100000)%10;var f=Math.floor(j/1000000)%10;var k=Math.floor(j/10000000)%10;var g=Math.floor(j/100000000)%10;if(n>0){i.AddLine(this.histo.fName)}if(p>0){i.AddLine("Entries = "+i.Format(h.entries,"entries"))}if(l>0){i.AddLine("Mean x = "+i.Format(h.meanx));i.AddLine("Mean y = "+i.Format(h.meany))}if(q>0){i.AddLine("Std Dev x = "+i.Format(h.rmsx));i.AddLine("Std Dev y = "+i.Format(h.rmsy))}if(f>0){i.AddLine("Integral = "+i.Format(h.matrix[4],"entries"))}if(k>0){i.AddLine("Skewness x = <undef>");i.AddLine("Skewness y = <undef>")}if(g>0){i.AddLine("Kurt = <undef>")}if((c>0)||(d>0)){var e=h.matrix;i.AddLine(""+e[6].toFixed(0)+" | "+e[7].toFixed(0)+" | "+e[7].toFixed(0));i.AddLine(""+e[3].toFixed(0)+" | "+e[4].toFixed(0)+" | "+e[5].toFixed(0));i.AddLine(""+e[0].toFixed(0)+" | "+e[1].toFixed(0)+" | "+e[2].toFixed(0))}var o=i.pavetext.fLines.arr.length;var r=o*a.gStyle.StatFontSize;if(r<=0||3==(a.gStyle.StatFont%10)){r=0.25*o*a.gStyle.StatH;i.pavetext.fY1NDC=0.93-r;i.pavetext.fY2NDC=0.93}return true};a.TH2Painter.prototype.getValueColor=function(e){if(this.fContour==null){this.fUserContour=false;if((this.histo.fContour!=null)&&(this.histo.fContour.length>0)&&this.histo.TestBit(a.TH1StatusBits.kUserContour)){this.fContour=a.clone(this.histo.fContour);this.fUserContour=true}else{var i=20;if(this.histo.fContour!=null){i=this.histo.fContour.length}if(i<1){i=20}this.fContour=[];this.zmin=this.minbin;this.zmax=this.maxbin;if(this.zoom_zmin!=this.zoom_zmax){this.zmin=this.zoom_zmin;this.zmax=this.zoom_zmax}if(this.options.Logz){if(this.zmax<=0){this.zmax=1}if(this.zmin<=0){this.zmin=0.001*this.zmax}var m=Math.log(this.zmin)/Math.log(10);var f=Math.log(this.zmax)/Math.log(10);var l=(f-m)/i;this.fContour.push(this.zmin);for(var c=1;c<i;c++){this.fContour.push(Math.exp((m+l*c)*Math.log(10)))}this.fContour.push(this.zmax)}else{if((this.zmin==this.zmax)&&(this.zmin!=0)){this.zmax+=0.01*Math.abs(this.zmax);this.zmin-=0.01*Math.abs(this.zmin)}var l=(this.zmax-this.zmin)/i;for(var c=0;c<=i;c++){this.fContour.push(this.zmin+l*c)}}}}var g=-1;if(this.fUserContour||this.options.Logz){for(var h in this.fContour){if(e>=this.fContour[h]){g++}}}else{g=Math.floor(0.01+(e-this.zmin)*(this.fContour.length-1)/(this.zmax-this.zmin))}if(g<0){return null}var d=a.gStyle.GetColorPalette();var j=Math.floor((g+0.99)*d.length/(this.fContour.length-1));if(j>d.length-1){j=d.length-1}return d[j]};a.TH2Painter.prototype.CreateDrawBins=function(o,A,k,C){var u=this.GetSelectIndex("x","left",0);var s=this.GetSelectIndex("x","right",0);var d=this.GetSelectIndex("y","left",0);var c=this.GetSelectIndex("y","right",0);var D,f,B,e,l,r,g,q,m,F,E,p,t,H,G;this.maxbin=this.minbin=this.histo.getBinContent(u+1,d+1);for(var x=u;x<s;x++){for(var v=d;v<c;v++){p=this.histo.getBinContent(x+1,v+1);if(p>this.maxbin){this.maxbin=p}else{if(p<this.minbin){this.minbin=p}}}}var n=1,z=1;if(k==1){n=0.5*o/(s-u)/(this.maxbin-this.minbin);z=0.5*A/(c-d)/(this.maxbin-this.minbin)}this.fContour=null;this.fUserContour=false;var y=new Array;B=this.GetBinX(u);g=-11111;for(var x=u;x<s;x++){D=B;B=this.GetBinX(x+1);if(this.options.Logx&&(D<=0)){continue}l=g;if(l<0){l=this.grx(D)}g=this.grx(B);e=this.GetBinY(d);q=-1111;for(var v=d;v<c;v++){f=e;e=this.GetBinY(v+1);if(this.options.Logy&&(f<=0)){continue}r=q;if(r<0){r=this.gry(f)}q=this.gry(e);p=this.histo.getBinContent(x+1,v+1);if((p==0)||(p<this.minbin)){continue}t=null;switch(k){case 0:m=this.getValueColor(p);if(m!=null){t={x:l,y:q,width:g-l+1,height:r-q+1,stroke:"none",fill:m,tipcolor:(m=="black")?"grey":"black"}}break;case 1:F=n*(this.maxbin-p);E=z*(this.maxbin-p);t={x:l+F,y:q+E,width:g-l-2*F,height:r-q-2*E,stroke:this.attline.color,fill:this.fillcolor};t.tipcolor=(t.fill=="black")?"grey":"black";break;case 2:t={x:(D+B)/2,y:(f+e)/2,z:p};break}if(t==null){continue}if(C==1){if(this.x_kind=="labels"){t.tip="x = "+this.AxisAsText("x",D)+"\n"}else{t.tip="x = ["+this.AxisAsText("x",D)+", "+this.AxisAsText("x",B)+"]\n"}if(this.y_kind=="labels"){t.tip+="y = "+this.AxisAsText("y",f)+"\n"}else{t.tip+="y = ["+this.AxisAsText("y",f)+", "+this.AxisAsText("y",e)+"]\n"}t.tip+="entries = "+a.FFormat(p,a.gStyle.StatFormat)}else{if(C==2){t.tip="x = "+this.AxisAsText("x",D)+"\ny = "+this.AxisAsText("y",f)+"\nentries = "+a.FFormat(p,a.gStyle.StatFormat)}}y.push(t)}}return y};a.TH2Painter.prototype.DrawSimpleCanvas=function(n,y){var u=this.GetSelectIndex("x","left",0);var t=this.GetSelectIndex("x","right",0);var e=this.GetSelectIndex("y","left",0);var d=this.GetSelectIndex("y","right",0);this.maxbin=this.minbin=this.histo.getBinContent(u+1,e+1);for(var x=u;x<t;x++){for(var v=e;v<d;v++){binz=this.histo.getBinContent(x+1,v+1);if(binz>this.maxbin){this.maxbin=binz}else{if(binz<this.minbin){this.minbin=binz}}}}var o=t-u,m=d-e;var l=this.draw_g.append("foreignObject").attr("width",n).attr("height",y);this.SetForeignObjectPosition(l,0,0);var g=l.append("xhtml:canvas").attr("width",o).attr("height",m).attr("style","width: "+n+"px; height: "+y+"px");var f=g.node().getContext("2d");var q=f.createImageData(o,m);var s=-1;for(var v=d-1;v>=e;v--){for(var x=u;x<t;x++){var r=this.histo.getBinContent(x+1,v+1);var k=r>this.minbin?this.getValueColor(r):"white";var z=b.rgb(k);q.data[++s]=z.r;q.data[++s]=z.g;q.data[++s]=z.b;q.data[++s]=255}}f.putImageData(q,0,0)};a.TH2Painter.prototype.DrawNormalCanvas=function(d,l){var k=this.CreateDrawBins(d,l,0,0);var j=this.draw_g.append("foreignObject").attr("width",d).attr("height",l);this.SetForeignObjectPosition(j,0,0);var e=j.append("xhtml:canvas").attr("width",d).attr("height",l);var c=e.node().getContext("2d");for(var g in k){var f=k[g];c.fillStyle=f.fill;c.fillRect(f.x,f.y,f.width,f.height)}c.stroke()};a.TH2Painter.prototype.DrawBins=function(){this.RecreateDrawG(false,".main_layer",false);var l=this.frame_width(),j=this.frame_height();if((this.options.Color==2)&&!a.browser.isIE){return this.DrawSimpleCanvas(l,j)}if((this.options.Color==3)&&!a.browser.isIE){return this.DrawNormalCanvas(l,j)}var g=(this.options.Scat>0&&this.histo.fMarkerStyle>1);var e=(this.options.Color>0)||g;var k=0;if(a.gStyle.Tooltip){k=g?2:1}var d=this.CreateDrawBins(l,j,e?0:1,k);if(g){var i=a.Painter.createAttMarker(this.histo);var f=this.draw_g.selectAll(".marker").data(d).enter().append("svg:path").attr("class","marker").attr("transform",function(h){return"translate("+h.x.toFixed(1)+","+h.y.toFixed(1)+")"}).call(i.func);if(a.gStyle.Tooltip){f.append("svg:title").text(function(h){return h.tip})}}else{var c=this.draw_g.selectAll(".bins").data(d).enter().append("svg:rect").attr("class","bins").attr("x",function(h){return h.x.toFixed(1)}).attr("y",function(h){return h.y.toFixed(1)}).attr("width",function(h){return h.width.toFixed(1)}).attr("height",function(h){return h.height.toFixed(1)}).style("stroke",function(h){return h.stroke}).style("fill",function(h){this["f0"]=h.fill;this["f1"]=h.tipcolor;return h.fill});if(a.gStyle.Tooltip){c.on("mouseover",function(){if(a.gStyle.Tooltip){b.select(this).transition().duration(100).style("fill",this["f1"])}}).on("mouseout",function(){b.select(this).transition().duration(100).style("fill",this["f0"])}).append("svg:title").text(function(h){return h.tip})}}delete d};a.TH2Painter.prototype.Draw2D=function(){if(this.options.Lego>0){this.options.Lego=0}if(this["done2d"]){return}if((this.FindPalette()==null)&&this.create_canvas&&(this.options.Zscale>0)){var c=this.CreatePalette(0.04);this.svg_frame().property("frame_painter").Shrink(0,c);this.svg_frame().property("frame_painter").Redraw();this.CreateXY()}else{if(this.options.Zscale==0){this.FindPalette(true)}}if(a.gStyle.AutoStat&&this.create_canvas){this.CreateStat()}this.DrawAxes();this.DrawGrids();this.DrawBins();if(this.create_canvas){this.DrawTitle()}this.DrawFunctions();this.AddInteractive();if(this.options.AutoZoom){this.AutoZoom()}this["done2d"]=true};a.TH2Painter.prototype.Draw3D=function(){if(this.options.Lego<=0){this.options.Lego=1}var c=this;a.AssertPrerequisites("3d",function(){a.Painter.real_drawHistogram2D(c)})};a.Painter.drawHistogram2D=function(f,d,e){var c=new a.TH2Painter(d);c.SetDivId(f,1);c.options=c.DecodeOptions(e);c.CheckPadOptions();c.ScanContent();c.CreateXY();if(c.options.Lego>0){c.Draw3D()}else{c.Draw2D()}return c.DrawingReady()};a.THStackPainter=function(c){a.TObjectPainter.call(this,c);this.stack=c;this.nostack=false;this.firstpainter=null;this.painters=new Array};a.THStackPainter.prototype=Object.create(a.TObjectPainter.prototype);a.THStackPainter.prototype.GetObject=function(){return this.stack};a.THStackPainter.prototype.drawStack=function(d){var g=this.root_pad();var l=this.stack.fHists;var s=l.arr.length;if(d==null){d=""}else{d=d.toLowerCase()}var k=false;if(d.indexOf("same")!=-1){k=true;d.replace("same","")}var n,o;var c=0,m=0,q=0,f=0;for(var n=0;n<s;++n){o=l.arr[n];if(n==0||o.fXaxis["fXmin"]<c){c=o.fXaxis["fXmin"]}if(n==0||o.fXaxis["fXmax"]>m){m=o.fXaxis["fXmax"]}if(n==0||o.fYaxis["fXmin"]<q){q=o.fYaxis["fXmin"]}if(n==0||o.fYaxis["fXmax"]>f){f=o.fYaxis["fXmax"]}}this.nostack=d.indexOf("nostack")==-1?false:true;if(!this.nostack){this.stack.buildStack()}var p,r;if(this.stack.fMaximum==-1111){r=this.stack.getMaximum(d)}else{r=this.stack.fMaximum}if(this.stack.fMinimum==-1111){p=this.stack.getMinimum(d);if(g&&g.fLogy){if(p>0){p*=0.9}else{p=r*0.001}}else{if(p>0){p=0}}}else{p=this.stack.fMinimum}if(!("fHistogram" in this.stack)){o=this.stack.fHists.arr[0];this.stack.fHistogram=a.Create("TH1I");this.stack.fHistogram["fName"]="unnamed";this.stack.fHistogram["fXaxis"]=a.clone(o.fXaxis);this.stack.fHistogram["fYaxis"]=a.clone(o.fYaxis);this.stack.fHistogram["fXaxis"]["fXmin"]=c;this.stack.fHistogram["fXaxis"]["fXmax"]=m;this.stack.fHistogram["fYaxis"]["fXmin"]=q;this.stack.fHistogram["fYaxis"]["fXmax"]=f}this.stack.fHistogram["fTitle"]=this.stack.fTitle;var j=this.stack.fHistogram;if(!j.TestBit(a.TH1StatusBits.kIsZoomed)){if(this.nostack&&this.stack.fMaximum!=-1111){j.fMaximum=this.stack.fMaximum}else{if(g&&g.fLogy){j.fMaximum=r*(1+0.2*a.Math.log10(r/p))}else{j.fMaximum=1.05*r}}if(this.nostack&&this.stack.fMinimum!=-1111){j.fMinimum=this.stack.fMinimum}else{if(g&&g.fLogy){j.fMinimum=p/(1+0.5*a.Math.log10(r/p))}else{j.fMinimum=p}}}if(!k){var t=j.fOption;if((d!="")&&(t.indexOf(d)==-1)){t+=d}if(j._typename.match(/^TH1/)){this.firstpainter=a.Painter.drawHistogram1D(this.divid,j,t)}else{if(j._typename.match(/^TH2/)){this.firstpainter=a.Painter.drawHistogram2D(this.divid,j,t)}}}for(var n=0;n<s;++n){if(this.nostack){o=l.arr[n]}else{o=this.stack.fStack.arr[s-n-1]}var t=o.fOption;if((d!="")&&(t.indexOf(d)==-1)){t+=d}t+="same";if(o._typename.match(/^TH1/)){var e=a.Painter.drawHistogram1D(this.divid,o,t);this.painters.push(e)}}};a.THStackPainter.prototype.UpdateObject=function(j){var g=false;if(this.firstpainter){if(this.firstpainter.UpdateObject(j.fHistogram)){g=true}}var d=j.fHists;var c=d.arr.length;for(var e=0;e<c;++e){var f=null;if(this.nostack){f=d.arr[e]}else{f=j.fStack.arr[c-e-1]}if(this.painters[e].UpdateObject(f)){g=true}}return g};a.Painter.drawHStack=function(f,c,e){if(!"fHists" in c){return}if(c.fHists.arr.length==0){return}var d=new a.THStackPainter(c);d.SetDivId(f);d.drawStack(e);return d.DrawingReady()};a.TLegendPainter=function(c){a.TObjectPainter.call(this,c);this.legend=c};a.TLegendPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TLegendPainter.prototype.GetObject=function(){return this.legend};a.TLegendPainter.prototype.drawLegend=function(){this.RecreateDrawG(true,".text_layer");var v=this.svg_pad();var m=this.legend;var o=0,n=0,r=0,C=0;if(m.fInit==0){o=m.fX1*Number(v.attr("width"));n=Number(v.attr("height"))-m.fY1*Number(v.attr("height"));r=(m.fX2-m.fX1)*Number(v.attr("width"));C=(m.fY2-m.fY1)*Number(v.attr("height"))}else{o=m.fX1NDC*Number(v.attr("width"));n=Number(v.attr("height"))-m.fY1NDC*Number(v.attr("height"));r=(m.fX2NDC-m.fX1NDC)*Number(v.attr("width"));C=(m.fY2NDC-m.fY1NDC)*Number(v.attr("height"))}n-=C;var D=m.fBorderSize?m.fBorderSize:0;var A=this.createAttFill(m);var G=a.Painter.createAttLine(m,D);var u=m.fPrimitives.arr.length;this.draw_g.attr("x",o).attr("y",n).attr("width",r).attr("height",C).attr("transform","translate("+o+","+n+")");this.StartTextDrawing(m.fTextFont,C/(u*1.2));this.draw_g.append("svg:rect").attr("x",0).attr("y",0).attr("width",r).attr("height",C).call(A.func).style("stroke-width",D?1:0).style("stroke",G.color);var I=a.Painter.root_colors[m.fTextColor];var j=Math.round(m.fMargin*r);var t=Math.round(0.03*r);var s=Math.round(0.03*C);var p=this;var q=(C-2*s)/u;for(var B=0;B<u;++B){var E=m.fPrimitives.arr[B];var f=E.fOption.toLowerCase();var c=Math.round(s+B*q);var H=Math.round(s+(B+0.5)*q);var k=E;var F=E;var e=E;var z=E.fObject;if((z!=null)&&(typeof z=="object")){if("fLineColor" in z){e=z}if("fFillColor" in z){k=z}if("fMarkerColor" in z){F=z}}var A=this.createAttFill(k);var g=a.Painter.createAttLine(e);if(f.indexOf("f")!=-1){this.draw_g.append("svg:rect").attr("x",t).attr("y",Math.round(c+q*0.1)).attr("width",j-2*t).attr("height",Math.round(q*0.8)).call(g.func).call(A.func)}if(f.indexOf("l")!=-1){this.draw_g.append("svg:line").attr("x1",t).attr("y1",H).attr("x2",j-t).attr("y2",H).call(g.func)}if(f.indexOf("e")!=-1&&(f.indexOf("l")==-1||f.indexOf("f")!=-1)){}if(f.indexOf("p")!=-1){var l=a.Painter.createAttMarker(F);this.draw_g.append("svg:path").attr("transform",function(h){return"translate("+j/2+","+H+")"}).call(l.func)}var d=j;if((f.indexOf("h")>=0)||(f.length==0)){d=t}this.DrawText("start",d,c,r-d-t,q,E.fLabel,I)}this.FinishTextDrawing();if(D&&D>1){this.draw_g.append("svg:line").attr("x1",r+(D/2)).attr("y1",D+1).attr("x2",r+(D/2)).attr("y2",C+D-1).call(G.func);this.draw_g.append("svg:line").attr("x1",D+1).attr("y1",C+(D/2)).attr("x2",r+D-1).attr("y2",C+(D/2)).call(G.func)}this.AddDrag({obj:m,redraw:"drawLegend"})};a.TLegendPainter.prototype.Redraw=function(){this.drawLegend()};a.Painter.drawLegend=function(f,e,d){var c=new a.TLegendPainter(e);c.SetDivId(f);c.Redraw();return c.DrawingReady()};a.TMultiGraphPainter=function(c){a.TObjectPainter.call(this,c);this.mgraph=c;this.firstpainter=null;this.painters=new Array};a.TMultiGraphPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TMultiGraphPainter.prototype.GetObject=function(){return this.mgraph};a.TMultiGraphPainter.prototype.UpdateObject=function(g){if((g==null)||(g._typename!="TMultiGraph")){return false}var d=g.fHistogram;var c=g.fGraphs;var f=false;if(this.firstpainter&&d){if(this.firstpainter.UpdateObject(d)){f=true}}for(var e in c.arr){if(e>=this.painters.length){break}if(this.painters[e].UpdateObject(c.arr[e])){f=true}}return f};a.TMultiGraphPainter.prototype.drawMultiGraph=function(c){var u,q,z=0,d=0,g=0,h=0,t=0,v=0,n,m;var o=this.mgraph.fHistogram;var l=this.mgraph.fGraphs;var k=1,j=1;var y=false,x=false;var e=true;var w=this.root_pad();if(w!=null){z=w.fUxmin;d=w.fUxmax;g=w.fUymin;h=w.fUymax;y=w.fLogx;x=w.fLogy}if(o!=null){q=o.fYaxis["fXmin"];u=o.fYaxis["fXmax"];if(w){t=a.Painter.padtoX(w,z);v=a.Painter.padtoX(w,d)}}else{for(var s=0;s<l.arr.length;++s){var p=l.arr[s].ComputeRange();if((s==0)||(p.xmin<z)){z=p.xmin}if((s==0)||(p.ymin<g)){g=p.ymin}if((s==0)||(p.xmax>d)){d=p.xmax}if((s==0)||(p.ymax>h)){h=p.ymax}}if(z==d){d+=1}if(g==h){h+=1}n=0.05*(d-z);m=0.05*(h-g);t=z-n;v=d+n;if(x){if(g<=0){g=0.001*h}q=g/(1+0.5*a.Math.log10(h/g));u=h*(1+0.2*a.Math.log10(h/g))}else{q=g-m;u=h+m}if(q<0&&g>=0){q=0}if(u>0&&h<=0){u=0}}if(this.mgraph.fMinimum!=-1111){g=q=this.mgraph.fMinimum}if(this.mgraph.fMaximum!=-1111){h=u=this.mgraph.fMaximum}if(t<0&&z>=0){if(y){t=0.9*z}}if(v>0&&d<=0){if(y){v=1.1*d}}if(q<0&&g>=0){if(x){q=0.9*g}}if(u>0&&h<=0){if(x){u=1.1*h}}if(q<=0&&x){q=0.001*u}if(t<=0&&y){if(v>1000){t=1}else{t=0.001*v}}g=q;h=u;if(o!=null){o.fYaxis["fXmin"]=g;o.fYaxis["fXmax"]=h}if(!o){o=a.Create("TH1I");o.fXaxis["fXmin"]=z;o.fXaxis["fXmax"]=d;o.fYaxis["fXmin"]=g;o.fYaxis["fXmax"]=h}this.firstpainter=a.Painter.drawHistogram1D(this.divid,o);for(var s in l.arr){var f=a.Painter.drawGraph(this.divid,l.arr[s]);this.painters.push(f)}};a.Painter.drawMultiGraph=function(f,e,d){var c=new a.TMultiGraphPainter(e);c.SetDivId(f);c.drawMultiGraph(d);return c.DrawingReady()};a.TTextPainter=function(c){a.TObjectPainter.call(this,c);this.text=c};a.TTextPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TTextPainter.prototype.GetObject=function(){return this.text};a.TTextPainter.prototype.drawPaveLabel=function(){this.RecreateDrawG(true,".text_layer");var i=this.text;var j=this.pad_width(),r=this.pad_height();if(i.fInit==0){i.fInit=1;var p=(i.fOption.indexOf("NDC")>=0);i.fX1NDC=this.ConvertToNDC("x",i.fX1,p);i.fX2NDC=this.ConvertToNDC("x",i.fX2,p);i.fY1NDC=this.ConvertToNDC("y",i.fY1,p);i.fY2NDC=this.ConvertToNDC("y",i.fY2,p)}var d=i.fX1NDC*j;var c=(1-i.fY1NDC)*r;var o=Math.abs(i.fX2NDC-i.fX1NDC)*j;var m=Math.abs(i.fY2NDC-i.fY1NDC)*r;c-=m;var e=this.createAttFill(i);var v=a.Painter.root_colors[i.fTextColor];var s=a.Painter.root_colors[i.fShadowColor];var q="start",k=Math.round(i.fTextAlign/10);var l="bottom",f=i.fTextAlign%10;if(k==1){q="start"}else{if(k==2){q="middle"}else{if(k==3){q="end"}}}if(f==1){l="bottom"}else{if(f==2){l="middle"}else{if(f==3){l="top"}}}var t=i.fBorderSize?i.fBorderSize:0;var u=a.Painter.createAttLine(i,t);var g=this.draw_g.attr("x",d.toFixed(1)).attr("y",c.toFixed(1)).attr("width",o.toFixed(1)).attr("height",m.toFixed(1)).attr("transform","translate("+d.toFixed(1)+","+c.toFixed(1)+")");g.append("svg:rect").attr("x",0).attr("y",0).attr("width",o.toFixed(1)).attr("height",m.toFixed(1)).call(e.func).style("stroke-width",t?1:0).style("stroke",u.color);this.StartTextDrawing(i.fTextFont,m/1.7);this.DrawText(q,0.02*o,0,0.96*o,m,i.fLabel,v);this.FinishTextDrawing();if(t&&t>1){g.append("svg:line").attr("x1",o+(t/2)).attr("y1",t+1).attr("x2",o+(t/2)).attr("y2",m+t-1).call(u.func);g.append("svg:line").attr("x1",t+1).attr("y1",m+(t/2)).attr("x2",o+t-1).attr("y2",m+(t/2)).call(u.func)}var n=this;this.AddDrag({obj:i,redraw:"drawPaveLabel"})};a.TTextPainter.prototype.drawText=function(){var j=a.BIT(14);var g=this.pad_width(),f=this.pad_height(),e=true;var d=this.text.fX,l=this.text.fY;if(this.text.TestBit(j)){d=d*g;l=(1-l)*f}else{if(this.main_painter()!=null){g=this.frame_width();f=this.frame_height();e=false;d=this.main_painter().grx(d);l=this.main_painter().gry(l)}else{if(this.root_pad()!=null){d=this.ConvertToNDC("x",d)*g;l=(1-this.ConvertToNDC("y",l))*f}else{a.console("Cannot draw text at x/y coordinates without real TPad object");d=g/2;l=f/2}}}this.RecreateDrawG(e,e?".text_layer":".upper_layer",true);var i=a.Painter.root_colors[this.text.fTextColor];var c=0,k=1;if(this.text._typename=="TLatex"){c=1;k=0.9}else{if(this.text._typename=="TMathText"){c=2;k=0.8}}this.StartTextDrawing(this.text.fTextFont,this.text.fTextSize*Math.min(g,f)*k);this.DrawText(this.text.fTextAlign,d,l,0,0,this.text.fTitle,i,c);this.FinishTextDrawing()};a.TTextPainter.prototype.UpdateObject=function(c){if(this.text._typename!=c._typename){return false}if(this.text._typename=="TPaveLabel"){this.text.fLabel=c.fLabel}else{this.text.fTitle=c.fTitle}return true};a.TTextPainter.prototype.Redraw=function(){if(this.text._typename=="TPaveLabel"){this.drawPaveLabel()}else{this.drawText()}};a.Painter.drawText=function(e,d){var c=new a.TTextPainter(d);c.SetDivId(e);c.Redraw();return c.DrawingReady()};a.Painter.drawStreamerInfo=function(e,d){b.select("#"+e).style("overflow","auto");var c=new a.HierarchyPainter("sinfo",e);c.ShowStreamerInfo(d);return c.DrawingReady()};a.RawTextPainter=function(c){a.TBasePainter.call(this);this.txt=c;return this};a.RawTextPainter.prototype=Object.create(a.TBasePainter.prototype);a.RawTextPainter.prototype.RedrawObject=function(c){this.txt=c;this.Draw();return true};a.RawTextPainter.prototype.Draw=function(){var e=this.txt.value;if(e==null){e="<undefined>"}var h="mathjax" in this.txt;if(!h&&!("as_is" in this.txt)){var d=e.split("\n");e="";for(var g in d){e+="<pre>"+d[g]+"</pre>"}}var j=this.select_main();var c=j.select("div");if(c.empty()){c=j.append("div").style("max-width","100%").style("max-height","100%").style("overflow","auto")}c.html(e);this.SetDivId(this.divid);if(h){if(this["loading_mathjax"]){return}this["loading_mathjax"]=true;var f=this;a.AssertPrerequisites("mathjax",function(){f.loading_mathjax=false;if(typeof MathJax=="object"){MathJax.Hub.Queue(["Typeset",MathJax.Hub,j.node()])}})}};a.Painter.drawRawText=function(f,c,e){var d=new a.RawTextPainter(c);d.SetDivId(f);d.Draw();return d.DrawingReady()};a.hpainter=null;a.HierarchyPainter=function(c,d){a.TBasePainter.call(this);this.name=c;this.frameid=d;this.h=null;this.files_monitoring=(d==null);if(a.hpainter==null){a.hpainter=this}};a.HierarchyPainter.prototype=Object.create(a.TBasePainter.prototype);a.HierarchyPainter.prototype.Cleanup=function(){this.clear(true)};a.HierarchyPainter.prototype.ListHierarchy=function(f,c){f._childs=[];for(var d in c.arr){var g=c.arr[d];var e={_name:g.fName,_kind:"ROOT."+g._typename,_readobj:g};f._childs.push(e)}};a.HierarchyPainter.prototype.StreamerInfoHierarchy=function(j,c){j._childs=[];for(var e in c.arr){var h=c.arr[e];if(typeof(h.fName)=="undefined"){a.console("strange element in StreamerInfo with name "+h.fName);continue}var g={_name:h.fName,_kind:"",_childs:[]};j._childs.push(g);g._childs.push({_name:"Checksum: "+h.fCheckSum});g._childs.push({_name:"Class version: "+h.fClassVersion});if(h.fTitle!=""){g._childs.push({_name:"Title: "+h.fTitle})}if(typeof h.fElements=="undefined"){continue}for(var d in h.fElements["arr"]){var f=h.fElements["arr"][d];if((f==null)||(typeof(f.fName)=="undefined")){continue}var k=f.fTypeName+" "+f.fName+";";if(f.fTitle!=""){k+=" // "+f.fTitle}g._childs.push({_name:k})}}};a.HierarchyPainter.prototype.TreeHierarchy=function(h,l){h._childs=[];for(var f in l.fBranches.arr){var g=l.fBranches.arr[f];var c=g.fLeaves.arr.length;if(c==1&&g.fLeaves.arr[0]["fName"]==g.fName){c=0}var d={_name:g.fName,_kind:c>0?"ROOT.TBranch":"ROOT.TLeafF"};h._childs.push(d);if(c>0){d._childs=[];for(var e=0;e<c;++e){var k={_name:g.fLeaves.arr[e]["fName"],_kind:"ROOT.TLeafF"};d._childs.push(k)}}}};a.HierarchyPainter.prototype.KeysHierarchy=function(c,k,e,g){c._childs=[];var h=this;for(var f in k){var j=k[f];var l={_name:j.fName+";"+j.fCycle,_kind:"ROOT."+j.fClassName,_title:j.fTitle,_keyname:j.fName,_readobj:null,_parent:c};if("fRealName" in j){l._realname=j.fRealName+";"+j.fCycle}if((j.fClassName=="TTree"||j.fClassName=="TNtuple")){l._more=true;l._expand=function(i,m){h.TreeHierarchy(i,m);return true}}else{if(j.fClassName=="TDirectory"||j.fClassName=="TDirectoryFile"){var d=null;if((g!=null)&&(e!=null)){d=e.GetDir(g+j.fName)}l._isdir=true;if(d==null){l._more=true;l._expand=function(i,m){h.KeysHierarchy(i,m.fKeys);return true}}else{l._name=j.fName;h.KeysHierarchy(l,d.fKeys,e,g+j.fName+"/")}}else{if((j.fClassName=="TList")&&(j.fName=="StreamerInfo")){l._name="StreamerInfo";l._kind="ROOT.TStreamerInfoList";l._title="List of streamer infos for binary I/O";l._readobj=e.fStreamerInfos}else{if(j.fClassName=="TList"||j.fClassName=="TObjArray"||j.fClassName=="TClonesArray"){l._more=true;l._expand=function(i,m){h.ListHierarchy(i,m);return true}}}}}c._childs.push(l)}};a.HierarchyPainter.prototype.FileHierarchy=function(d){var c=this;var e={_name:d.fFileName,_kind:"ROOT.TFile",_file:d,_fullurl:d.fFullURL,_had_direct_read:false,_get:function(g,j,i){var f=this;if((g!=null)&&(g._readobj!=null)){return a.CallBack(i,g,g._readobj)}if(g!=null){j=c.itemFullName(g,f)}function h(k){if(f._file==null){f._file=k}if(k==null){return a.CallBack(i,g,null)}k.ReadObject(j,function(o){if((g==null)&&(o!=null)){var l=c.Find({name:j,top:f,last_exists:true,check_keys:true});if((l!=null)&&(l!=f)){var m=k.GetDir(c.itemFullName(l,f));if(m){l._name=l._keyname;var n=c.itemFullName(l,f);c.KeysHierarchy(l,m.fKeys,k,n+"/")}}else{c.KeysHierarchy(f,k.fKeys,k,"")}g=c.Find({name:j,top:f})}if(g!=null){g._readobj=o;if("_expand" in g){g._name=g._keyname}}a.CallBack(i,g,o)})}if(f._file!=null){h(f._file)}else{new a.TFile(f._fullurl,h)}}};this.KeysHierarchy(e,d.fKeys,d,"");return e};a.HierarchyPainter.prototype.ForEach=function(e,d){if(d==null){d=this.h}if((d==null)||(typeof e!="function")){return}function c(f){e(f);if("_childs" in f){for(var g in f._childs){f._childs[g]._parent=f;c(f._childs[g])}}}c(d)};a.HierarchyPainter.prototype.Find=function(c){function d(k,g){if(!g||g.length==0){return k}var n=-1;function l(i){i._parent=k;if((n+1==g.length)||(n<0)){return i}return d(i,g.substr(n+1))}do{n=g.indexOf("/",n+1);var j=(n<0)?g:g.substr(0,n);for(var h in k._childs){if(k._childs[h]._name==j){return l(k._childs[h])}}if("check_keys" in c){for(var h in k._childs){if(k._childs[h]._name.indexOf(j+";")==0){return l(k._childs[h])}}}if("force" in c){if(!("_childs" in k)){k._childs=[]}var m={_name:j};k._childs.push(m);return l(m)}}while(n>0);return("last_exists" in c)?k:null}var e=this.h;var f="";if(typeof c=="string"){f=c;c={}}else{if(typeof c=="object"){f=c.name;if("top" in c){e=c.top}}else{return null}}return d(e,f)};a.HierarchyPainter.prototype.itemFullName=function(d,e){var c="";while("_parent" in d){if(c.length>0){c="/"+c}c=d._name+c;d=d._parent;if((e!=null)&&(d==e)){break}}return c};a.HierarchyPainter.prototype.ExecuteCommand=function(f,i){var k=this.Find(f);var c=f+"/cmd.json";var d=this;if("_numargs" in k){for(var e=0;e<k._numargs;e++){var g="arg"+(e+1);var j=null;if(e+2<arguments.length){j=arguments[e+2]}if((j==null)&&(typeof i=="object")){j=prompt("Input argument "+g+" for command "+k._name,"")}if(j==null){return}c+=((e==0)?"?":"&")+g+"="+j}}if((i!=null)&&(typeof i=="object")){i.css("background","yellow");if(k&&k._title){i.attr("title","Executing "+k._title)}}var h=a.NewHttpRequest(c,"text",function(m){if(typeof i=="function"){return i(m)}if((i!=null)&&(typeof i=="object")){var l=((m!=null)&&(m!="false"))?"green":"red";if(k&&k._title){i.attr("title",k._title+" lastres="+m)}i.animate({backgroundColor:l},2000,function(){i.css("background","")});if((l=="green")&&("_hreload" in k)){d.reload()}if((l=="green")&&("_update_item" in k)){d.updateItems(k._update_item.split(";"))}}});h.send()};a.HierarchyPainter.prototype.RefreshHtml=function(d){if(this.frameid==null){return a.CallBack(d)}var c=this;a.AssertPrerequisites("jq2d",function(){c.RefreshHtml(d)})};a.HierarchyPainter.prototype.toggle=function(d){var c=this;var e=function(f){if(f!=c.h){if(d){f._isopen=true}else{delete f._isopen}}if("_childs" in f){for(var g in f._childs){e(f._childs[g])}}};e(this.h);this.RefreshHtml()};a.HierarchyPainter.prototype.get=function(i,h,d){var f=this.Find(i);if(f==null){var e=this.Find({name:i,last_exists:true});while(e!=null){if("_get" in e){var c=this.itemFullName(e);if(c.length>0){i=i.substr(c.length+1)}break}if(!("_parent" in e)){e=null;break}e=e._parent}if(e==null){e=this.h}if("_get" in e){return e._get(null,i,h,d)}}var g=f;while(g!=null){if(("_get" in g)&&(typeof(g._get)=="function")){return g._get(f,null,h,d)}g=("_parent" in g)?g._parent:null}a.CallBack(h,f,null)};a.HierarchyPainter.prototype.draw=function(e,d,c){return a.draw(e,d,c)};a.HierarchyPainter.prototype.redraw=function(e,d,c){return a.redraw(e,d,c)};a.HierarchyPainter.prototype.player=function(h,d,g){var e=this.Find(h);if(!e||!("_player" in e)){return a.CallBack(g,null)}var f=this;var c=("_prereq" in e)?e._prereq:"";a.AssertPrerequisites(c,function(){var i=a.findFunction(e._player);if(i==null){return a.CallBack(g,null)}f.CreateDisplay(function(k){var j=null;if(k){j=i(f,h,d)}a.CallBack(g,j)})})};a.HierarchyPainter.prototype.display=function(i,d,g){var e=this;var c=null;function f(){a.CallBack(g,c,i)}e.CreateDisplay(function(n){if(!n){return f()}var j=e.Find(i);if((j!=null)&&("_player" in j)){return e.player(i,d,f)}var h=(typeof(d)=="string")&&(d.indexOf("update:")==0);if(h){d=d.substr(7);if((j==null)||("_doing_update" in j)){return f()}j._doing_update=true}if(j!=null){var k=a.getDrawHandle(j._kind,d);if((k==null)||!("func" in k)){return f()}}var m="";if((typeof(d)=="string")&&(d.indexOf("divid:")>=0)){var l=d.indexOf("divid:");m=d.slice(l+6);d=d.slice(0,l)}e.get(i,function(o,p){if(h&&o){delete o._doing_update}if(p==null){return f()}if(m.length>0){c=h?e.redraw(m,p,d):e.draw(m,p,d)}else{n.ForEachPainter(function(r,s){if(r.GetItemName()!=i){return}if(!h&&(d!=null)&&(r.GetItemDrawOpt()!=d)){return}c=r;n.ActivateFrame(s);c.RedrawObject(p)})}if(c==null){if(h){a.console("something went wrong - did not found painter when doing update of "+i)}else{var q=n.FindFrame(i,true);b.select(q).html("");n.ActivateFrame(q);c=e.draw(b.select(q).attr("id"),p,d);e.enable_dropping(q,i)}}if(c){c.SetItemName(i,h?null:d)}f()},d)})};a.HierarchyPainter.prototype.enable_dropping=function(c,d){};a.HierarchyPainter.prototype.dropitem=function(g,f,d){var c=this;var e=c.disp;c.get(g,function(i,j){if(j!=null){var h=c.draw(f,j,"same");if(h){h.SetItemName(g)}}a.CallBack(d)});return true};a.HierarchyPainter.prototype.updateItems=function(c){var f=this["disp"];if((f==null)||(c==null)){return}var d=[],e=[];f.ForEachPainter(function(g){var h=g.GetItemName();if((h==null)||(d.indexOf(h)>=0)){return}if(typeof c=="array"){if(c.indexOf(h)<0){return}}else{if(c!=h){return}}d.push(h);e.push("update:"+g.GetItemDrawOpt())},true);if(d.length>0){this.displayAll(d,e)}};a.HierarchyPainter.prototype.updateAll=function(e,f){var i=this["disp"];if(i==null){return}var h=[],d=[],g=this;i.ForEachPainter(function(n){var o=n.GetItemName();var j=n.GetItemDrawOpt();if((o==null)||(h.indexOf(o)>=0)){return}var l=g.Find(o);if((l==null)||("_not_monitor" in l)||("_player" in l)){return}var k=false;if("_always_monitor" in l){k=true}else{var m=a.getDrawHandle(l._kind);if(m&&("monitor" in m)){if((m.monitor===false)||(m.monitor=="never")){return}if(m.monitor==="always"){k=true}}}if(k||!e){h.push(o);d.push("update:"+j)}},true);var c=this;if(this.files_monitoring){this.ForEachRootFile(function(j){c.ForEach(function(k){delete k._readobj},j);delete j._file})}this.displayAll(h,d)};a.HierarchyPainter.prototype.displayAll=function(c,d,f){if((c==null)||(c.length==0)){return a.CallBack(f)}var e=this;e.CreateDisplay(function(m){if(!m){return a.CallBack(f)}if(d==null){d=[]}while(d.length<c.length){d.push("")}var k=new Array(c.length);for(var h in c){k[h]=null;if(e.Find(c[h])){continue}if(e.Find(c[h]+";1")){c[h]+=";1";continue}var l=c[h].indexOf("+");if(l>0){k[h]=c[h].split("+");c[h]=k[h].shift();for(var g in k[h]){var l=k[h][g].indexOf("_same_");if((l>0)&&(e.Find(k[h][g])==null)){k[h][g]=k[h][g].substr(0,l)+c[h].substr(l)}}}var l=c[h].indexOf("_same_");if((l>0)&&!e.Find(c[h])&&(h>0)){c[h]=c[h].substr(0,l)+c[0].substr(l)}}for(var h in c){if(d[h].indexOf("update:")!=0){m.CreateFrame(c[h])}}for(var h in c){e.display(c[h],d[h],function(i,o){var n=c.indexOf(o);if(n<0){return a.console("did not found item "+o)}c[n]="---";function j(){if((i!=null)&&(k[n]!=null)&&(k[n].length>0)){return e.dropitem(k[n].shift(),i.divid,j)}var q=false;for(var p in c){if(c[p]!="---"){q=true}}if(!q){a.CallBack(f)}}j()})}})};a.HierarchyPainter.prototype.reload=function(){var c=this;if("_online" in this.h){this.OpenOnline(this.h._online,function(){c.RefreshHtml()})}};a.HierarchyPainter.prototype.expand=function(c){alert("expand "+c+" can be used only jquery part loaded")};a.HierarchyPainter.prototype.GetTopOnlineItem=function(c){if(c!=null){while((c!=null)&&(!("_online" in c))){c=c._parent}return c}if(this.h==null){return null}if("_online" in this.h){return this.h}if((this.h._childs!=null)&&("_online" in this.h._childs[0])){return this.h._childs[0]}return null};a.HierarchyPainter.prototype.ForEachJsonFile=function(d){if(this.h==null){return}if("_jsonfile" in this.h){return a.CallBack(d,this.h)}if(this.h._childs!=null){for(var e in this.h._childs){var c=this.h._childs[e];if("_jsonfile" in c){a.CallBack(d,c)}}}};a.HierarchyPainter.prototype.OpenJsonFile=function(f,e){var d=false;this.ForEachJsonFile(function(g){if(g._jsonfile==f){d=true}});if(d){return a.CallBack(e)}var c=this;a.NewHttpRequest(f,"object",function(i){if(i==null){return a.CallBack(e)}var h={_jsonfile:f,_kind:"ROOT."+i._typename,_jsontmp:i,_name:f.split("/").pop()};if("fTitle" in i){h._title=i.fTitle}h._get=function(l,n,m){if("_jsontmp" in l){var k=l._jsontmp;delete l._jsontmp;return a.CallBack(m,l,k)}a.NewHttpRequest(l._jsonfile,"object",function(o){return a.CallBack(m,l,o)}).send(null)};if(c.h==null){c.h=h}else{if(c.h._kind=="TopFolder"){c.h._childs.push(h)}else{var j=c.h;var g=("_jsonfile" in j)?"Files":"Items";c.h={_name:g,_kind:"TopFolder",_childs:[j,h]}}}c.RefreshHtml(e)}).send(null)};a.HierarchyPainter.prototype.ForEachRootFile=function(d){if(this.h==null){return}if((this.h._kind=="ROOT.TFile")&&(this.h._file!=null)){return a.CallBack(d,this.h)}if(this.h._childs!=null){for(var e in this.h._childs){var c=this.h._childs[e];if((c._kind=="ROOT.TFile")&&("_fullurl" in c)){a.CallBack(d,c)}}}};a.HierarchyPainter.prototype.OpenRootFile=function(f,e){var d=false;this.ForEachRootFile(function(g){if(g._fullurl==f){d=true}});if(d){return a.CallBack(e)}var c=this;a.AssertPrerequisites("io",function(){new a.TFile(f,function(i){if(i==null){return a.CallBack(e)}var h=c.FileHierarchy(i);h._isopen=true;if(c.h==null){c.h=h}else{if(c.h._kind=="TopFolder"){c.h._childs.push(h)}else{var j=c.h;var g=(j._kind=="ROOT.TFile")?"Files":"Items";c.h={_name:g,_kind:"TopFolder",_childs:[j,h]}}}c.RefreshHtml(e)})})};a.HierarchyPainter.prototype.GetFileProp=function(e){var c=this.Find(e);if(c==null){return null}var d=c._name;while(c._parent!=null){c=c._parent;if("_file" in c){return{fileurl:c._file.fURL,itemname:d}}d=c._name+"/"+d}return null};a.MarkAsStreamerInfo=function(c,d,e){if((e!=null)&&(e._typename=="TList")){e._typename="TStreamerInfoList"}};a.HierarchyPainter.prototype.GetOnlineItemUrl=function(d){if((d!=null)&&(typeof d=="string")){d=this.Find(d)}var e=this.GetTopOnlineItem(d);if(d==null){return null}var c=this.itemFullName(d,e);if(e&&("_online" in e)&&(e._online!="")){c=e._online+c}return c};a.HierarchyPainter.prototype.GetOnlineItem=function(o,k,m,i){var d=k,g=false,l="",p="object",c=this,f=null;if(o!=null){d=this.GetOnlineItemUrl(o);var e=null;if("_kind" in o){f=a.getDrawHandle(o._kind)}if("_doing_expand" in o){g=true;l="h.json?compact=3"}else{if("_make_request" in o){e=a.findFunction(o._make_request)}else{if((f!=null)&&("make_request" in f)){e=f.make_request}}}if(typeof e=="function"){var j=e(c,o,d,i);if(j!=null){if(typeof j=="string"){l=j}else{if("req" in j){l=j.req}if("kind" in j){p=j.kind}}}}if((l.length==0)&&(o._kind.indexOf("ROOT.")!=0)){l="item.json.gz?compact=3"}}if((k==null)&&(o!=null)&&("_cached_draw_object" in this)&&(l.length==0)){var h=this["_cached_draw_object"];delete this["_cached_draw_object"];return a.CallBack(m,o,h)}if(l.length==0){l="root.json.gz?compact=3"}if(d.length>0){d+="/"}d+=l;var n=a.NewHttpRequest(d,p,function(s){var r=null;if(!g&&(o!=null)&&("_after_request" in o)){r=a.findFunction(o._after_request)}else{if((f!=null)&&("after_request" in f)){r=f.after_request}}if(typeof r=="function"){var q=r(c,o,s,i,n);if((q!=null)&&(typeof q=="object")){s=q}}a.CallBack(m,o,s)});n.send(null)};a.HierarchyPainter.prototype.OpenOnline=function(e,f){var c=this;function g(i){c.h=i;if(c.h==null){return}if(("_title" in c.h)&&(c.h._title!="")){document.title=c.h._title}i._isopen=true;c.h._online=e;c.h._get=function(l,n,m,k){c.GetOnlineItem(l,n,m,k)};c.h._expand=function(k,l){if((l!=null)&&(k!=null)&&("_childs" in l)){k._childs=l._childs;l._childs=null;return true}return false};var h="",j="";c.ForEach(function(l){if("_autoload" in l){var k=l._autoload.split(";");for(var m in k){if((k[m].length>3)&&((k[m].lastIndexOf(".js")==k[m].length-3)||(k[m].lastIndexOf(".css")==k[m].length-4))){if(h.indexOf(k[m])<0){h+=k[m]+";"}}else{if(j.indexOf(k[m])<0){j+=k[m]+";"}}}}});if(h.length>0){h="user:"+h}a.AssertPrerequisites(j+h,function(){c.ForEach(function(m){if(!("_drawfunc" in m)||!("_kind" in m)){return}var l="kind:"+m._kind;if(m._kind.indexOf("ROOT.")==0){l=m._kind.slice(5)}var k=m._drawopt;if(!a.canDraw(l)||(k!=null)){a.addDrawFunc({name:l,func:m._drawfunc,script:m._drawscript,opt:k})}});a.CallBack(f,c)})}if(!e){e=""}if(typeof e=="object"){var d=e;e="";return g(d)}a.NewHttpRequest(e+"h.json?compact=3","object",g).send(null)};a.HierarchyPainter.prototype.GetOnlineProp=function(e){var c=this.Find(e);if(c==null){return null}var d=c._name;while(c._parent!=null){c=c._parent;if("_online" in c){return{server:c._online,itemname:d}}d=c._name+"/"+d}return null};a.HierarchyPainter.prototype.FillOnlineMenu=function(d,k,i){var l=this;var e=this.Find(i);var c=a.getDrawOptions(e._kind,"nosame");var g=a.getDrawHandle(e._kind);var h=("_kind" in e)?e._kind.indexOf("ROOT.")==0:false;if(c!=null){d.addDrawMenu("Draw",c,function(m){l.display(i,m)})}if((e._childs==null)&&(("_more" in e)||h)){d.add("Expand",function(){l.expand(i)})}if(g&&("execute" in g)){d.add("Execute",function(){l.ExecuteCommand(i,d.tree_node)})}var j=k.server+k.itemname+"/draw.htm";var f="?";if(this.IsMonitoring()){j+=f+"monitoring="+this.MonitoringInterval();f="&"}if(c!=null){d.addDrawMenu("Draw in new window",c,function(m){window.open(j+f+"opt="+m)})}if((c!=null)&&(c.length>0)&&h){d.addDrawMenu("Draw as png",c,function(m){window.open(k.server+k.itemname+"/root.png?w=400&h=300&opt="+m)})}if("_player" in e){d.add("Player",function(){l.player(i)})}};a.HierarchyPainter.prototype.ShowStreamerInfo=function(c){this.h={_name:"StreamerInfo"};this.StreamerInfoHierarchy(this.h,c);this.RefreshHtml()};a.HierarchyPainter.prototype.Adopt=function(c){this.h=c;this.RefreshHtml()};a.HierarchyPainter.prototype.SetMonitoring=function(c){this["_monitoring_on"]=false;this["_monitoring_interval"]=3000;if((c!=null)&&(c!="0")){this["_monitoring_on"]=true;this["_monitoring_interval"]=parseInt(c);if(isNaN(this["_monitoring_interval"])||(this["_monitoring_interval"]<100)){this["_monitoring_interval"]=3000}}};a.HierarchyPainter.prototype.MonitoringInterval=function(c){return("_monitoring_interval" in this)?this["_monitoring_interval"]:3000};a.HierarchyPainter.prototype.EnableMonitoring=function(c){this["_monitoring_on"]=c};a.HierarchyPainter.prototype.IsMonitoring=function(){return this["_monitoring_on"]};a.HierarchyPainter.prototype.SetDisplay=function(d,c){if((c==null)&&(typeof d=="object")){this["disp"]=d;this["disp_kind"]="custom";this["disp_frameid"]=null}else{this["disp_kind"]=d;this["disp_frameid"]=c}};a.HierarchyPainter.prototype.GetLayout=function(){return this["disp_kind"]};a.HierarchyPainter.prototype.clear=function(c){if("disp" in this){this["disp"].Reset();delete this["disp"]}if(c){b.select("#"+this.frameid).html("");delete this.h}else{this.ForEach(function(d){if(("clear" in d)&&(typeof d.clear=="function")){d.clear()}})}};a.HierarchyPainter.prototype.GetDisplay=function(){return("disp" in this)?this["disp"]:null};a.HierarchyPainter.prototype.CreateDisplay=function(d){var c=this;if("disp" in this){if((c.disp.NumDraw()>0)||(c.disp_kind=="custom")){return a.CallBack(d,c.disp)}c.disp.Reset();delete c.disp}if(document.getElementById(this["disp_frameid"])==null){return a.CallBack(d,null)}if(c.disp_kind=="simple"){c.disp=new a.SimpleDisplay(c.disp_frameid)}else{if(c.disp_kind.search("grid")==0){c.disp=new a.GridDisplay(c.disp_frameid,c.disp_kind)}}if(c.disp!=null){a.CallBack(d,c.disp)}else{a.AssertPrerequisites("jq2d",function(){c.CreateDisplay(d)})}};a.HierarchyPainter.prototype.updateOnOtherFrames=function(c,e){var f=this["disp"];if(f==null){return false}var d=false;f.ForEachPainter(function(g,h){if((g===c)||(g.GetItemName()!=c.GetItemName())){return}f.ActivateFrame(h);g.RedrawObject(e);d=true});return d};a.HierarchyPainter.prototype.CheckResize=function(c){if("disp" in this){this["disp"].CheckResize()}};a.HierarchyPainter.prototype.StartGUI=function(n,h){var g=this;var j=a.GetUrlOptionAsArray("file;files");var p=a.GetUrlOptionAsArray("json");var f=a.GetUrlOption("path");if(f!=null){for(var k in j){j[k]=f+j[k]}for(var k in p){p[k]=f+p[k]}}var c=a.GetUrlOptionAsArray("item;items");var e=a.GetUrlOptionAsArray("opt;opts");var o=a.GetUrlOption("monitoring");if((p.length>0)&&(c.length==0)){c.push("")}var l=a.GetUrlOption("layout");if(!this["disp_kind"]||(l!=null)){this["disp_kind"]=(l&&l.length>0)?l:"simple"}if(a.GetUrlOption("files_monitoring")!=null){this.files_monitoring=true}a.RegisterForResize(this);this.SetMonitoring(o);function m(){if(p.length>0){g.OpenJsonFile(p.shift(),m)}else{if(j.length>0){g.OpenRootFile(j.shift(),m)}else{g.displayAll(c,e,function(){g.RefreshHtml();a.RegisterForResize(g);setInterval(function(){g.updateAll(!g.IsMonitoring())},g.MonitoringInterval());a.CallBack(h)})}}}function d(){if(("_monitoring" in g.h)&&(o==null)){g.SetMonitoring(g.h._monitoring)}if(("_layout" in g.h)&&(l==null)){g.disp_kind=g.h._layout}if(("_loadfile" in g.h)&&(j.length==0)){j=a.ParseAsArray(g.h._loadfile)}if(("_drawitem" in g.h)&&(c.length==0)){c=a.ParseAsArray(g.h._drawitem);e=a.ParseAsArray(g.h._drawopt)}m()}if(n!=null){g.OpenOnline(n,d)}else{m()}};a.BuildNobrowserGUI=function(){var c=b.select("#simpleGUI");var d=false,e=false;if(c.empty()){d=true;c=b.select("#onlineGUI");if(c.empty()){c=b.select("#drawGUI");e=true}if(c.empty()){return alert("no div for simple nobrowser gui found")}}a.Painter.readStyleFromURL();b.select("html").style("height","100%");b.select("body").style({"min-height":"100%",margin:"0px",overflow:"hidden"});c.style({position:"absolute",left:"1px",top:"1px",bottom:"1px",right:"1px"});var h=new a.HierarchyPainter("root",null);h.SetDisplay("simple",c.attr("id"));var f=null;if(d){var g=a.findFunction("GetCachedHierarchy");if(typeof g=="function"){f=g()}if(typeof f!="object"){f=""}}h.StartGUI(f,function(){if(!e){return}var j=a.findFunction("GetCachedObject");var k=(typeof j=="function")?a.JSONR_unref(j()):null;if(k!=null){h._cached_draw_object=k}var i=a.GetUrlOption("opt");h.display("",i)})};a.MDIDisplay=function(c){this.frameid=c;b.select("#"+this.frameid).property("mdi",this)};a.MDIDisplay.prototype.ForEachFrame=function(c,d){alert("ForEachFrame not implemented")};a.MDIDisplay.prototype.ForEachPainter=function(c,d){this.ForEachFrame(function(f){var e=new a.TObjectPainter();e.SetDivId(b.select(f).attr("id"),-1);e.ForEachPainter(function(g){c(g,f)})},d)};a.MDIDisplay.prototype.NumDraw=function(){var c=0;this.ForEachFrame(function(){c++});return c};a.MDIDisplay.prototype.FindFrame=function(d,e){var c=null;this.ForEachFrame(function(f){if(b.select(f).attr("title")==d){c=f}});if((c==null)&&e){c=this.CreateFrame(d)}return c};a.MDIDisplay.prototype.ActivateFrame=function(c){};a.MDIDisplay.prototype.CheckResize=function(d){var c=null;this.ForEachPainter(function(e,f){if((d!=null)&&(b.select(f).attr("id")!=d)){return}if((e.GetItemName()!=null)&&(typeof e.CheckResize=="function")){if(c===f){return}e.CheckResize();c=f}})};a.MDIDisplay.prototype.Reset=function(){this.ForEachPainter(function(c){if((c.GetItemName()!=null)&&(typeof c.Clenaup=="function")){c.Clenaup()}});b.select("#"+this.frameid).html("").property("mdi",null)};a.MDIDisplay.prototype.Draw=function(f,d,c){if(!d){return}if(!a.canDraw(d._typename,c)){return}var e=this.FindFrame(f,true);this.ActivateFrame(e);return a.redraw(b.select(e).attr("id"),d,c)};a.CustomDisplay=function(){a.MDIDisplay.call(this,"dummy");this.frames={}};a.CustomDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.CustomDisplay.prototype.AddFrame=function(d,c){if(!(d in this.frames)){this.frames[d]=""}this.frames[d]+=(c+";")};a.CustomDisplay.prototype.ForEachFrame=function(d,g){var f=Object.keys(this.frames);for(var c=0;c<f.length;c++){var e=b.select("#"+f[c]);if(!e.empty()){a.CallBack(d,e.node())}}};a.CustomDisplay.prototype.CreateFrame=function(e){var f=Object.keys(this.frames);for(var d=0;d<f.length;d++){var c=this.frames[f[d]];if(c.indexOf(e+";")>=0){return b.select("#"+f[d]).node()}}return null};a.CustomDisplay.prototype.Reset=function(){a.MDIDisplay.prototype.Reset.call(this);this.ForEachFrame(function(c){b.select(c).html("")})};a.SimpleDisplay=function(c){a.MDIDisplay.call(this,c)};a.SimpleDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.SimpleDisplay.prototype.ForEachFrame=function(c,e){var d=b.select("#"+this.frameid+"_simple_display");if(!d.empty()){a.CallBack(c,d.node())}};a.SimpleDisplay.prototype.CreateFrame=function(c){return b.select("#"+this.frameid).html("").append("div").attr("id",this.frameid+"_simple_display").style("width","100%").style("height","100%").style("overflow","hidden").property("title",c).node()};a.SimpleDisplay.prototype.Reset=function(){a.MDIDisplay.prototype.Reset.call(this);b.select("#"+this.frameid).html("")};a.GridDisplay=function(e,d,c){a.MDIDisplay.call(this,e);this.cnt=0;if(typeof d=="string"){if(d.search("grid")==0){d=d.slice(4).trim()}var f=d.search("x");if(f>0){c=parseInt(d.slice(f+1));d=parseInt(d.slice(0,f))}else{d=parseInt(d);c=d}if(isNaN(d)){d=3}if(isNaN(c)){c=3}}if(!d){d=3}if(!c){c=d}this.sizex=d;this.sizey=c};a.GridDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.GridDisplay.prototype.IsSingle=function(){return(this.sizex==1)&&(this.sizey==1)};a.GridDisplay.prototype.ForEachFrame=function(c,f){for(var d=0;d<this.sizex*this.sizey;d++){var e=this.IsSingle()?b.select("#"+this.frameid):b.select("#"+this.frameid+"_grid_"+d);if(!e.empty()&&e.property("title")!=""){a.CallBack(c,e.node())}}};a.GridDisplay.prototype.CreateFrame=function(n){var d=b.select("#"+this.frameid);if(d.empty()){return null}if(!this.IsSingle()){var g=this.frameid+"_grid";if(b.select("#"+g).empty()){var m=d.node().getBoundingClientRect();var k=Math.floor(m.height/this.sizey)-1;var o=Math.floor(m.width/this.sizex)-1;var l="<div style='width:100%; height:100%; margin:0; padding:0; border:0; overflow:hidden'>";l+="<table id='"+g+"' style='width:100%; height:100%; table-layout:fixed; border-collapse: collapse;'>";var c=0;for(var f=0;f<this.sizey;f++){l+="<tr>";for(var e=0;e<this.sizex;e++){l+="<td><div id='"+g+"_"+c+++"' class='grid_cell'></div></td>"}l+="</tr>"}l+="</table></div>";d.html(l);d.selectAll(".grid_cell").style({width:o+"px",height:k+"px",overflow:"hidden"})}d=b.select("#"+g+"_"+this.cnt);if(++this.cnt>=this.sizex*this.sizey){this.cnt=0}}return d.html("").property("title",n).node()};a.GridDisplay.prototype.Reset=function(){a.MDIDisplay.prototype.Reset.call(this);if(this.IsSingle()){b.select("#"+this.frameid).property("title",null)}this.cnt=0};a.GridDisplay.prototype.CheckResize=function(){if(!this.IsSingle()){var c=b.select("#"+this.frameid);var f=c.node().getBoundingClientRect();var e=Math.floor(f.height/this.sizey)-1;var d=Math.floor(f.width/this.sizex)-1;c.selectAll(".grid_cell").style({width:d+"px",height:e+"px"})}a.MDIDisplay.prototype.CheckResize.call(this)};a.RegisterForResize=function(f,d){var g=null;var i=-1;var c=d?d/2.5:100;if(c<20){c=20}function e(){if(i<0){return}i+=1;if(i<3){return}if(g!=null){clearInterval(g);g=null}i=-1;if(f==null){return}document.body.style.cursor="wait";if(typeof f=="function"){f()}else{if((typeof f=="object")&&(typeof f.CheckResize=="function")){f.CheckResize()}else{if(typeof f=="string"){var j=b.select("#"+f);if(!j.empty()){var m=j.property("mdi");if(m){m.CheckResize()}else{var k=new a.TObjectPainter();var l=true;k.SetDivId(f,-1);k.ForEachPainter(function(n){if(l&&(typeof n.CheckResize=="function")){l=false;n.CheckResize()}})}}}}}document.body.style.cursor="auto"}function h(){if(g==null){g=setInterval(e,c)}i=0}window.addEventListener("resize",h)};a.addDrawFunc({name:"TCanvas",icon:"img_canvas",func:a.Painter.drawCanvas});a.addDrawFunc({name:"TPad",func:a.Painter.drawPad});a.addDrawFunc({name:"TFrame",func:a.Painter.drawFrame});a.addDrawFunc({name:"TLegend",func:a.Painter.drawLegend});a.addDrawFunc({name:"TPaveText",func:a.Painter.drawPaveText});a.addDrawFunc({name:"TPaveStats",func:a.Painter.drawPaveText});a.addDrawFunc({name:"TLatex",func:a.Painter.drawText});a.addDrawFunc({name:"TMathText",func:a.Painter.drawText});a.addDrawFunc({name:"TText",func:a.Painter.drawText});a.addDrawFunc({name:"TPaveLabel",func:a.Painter.drawText});a.addDrawFunc({name:/^TH1/,icon:"img_histo1d",func:a.Painter.drawHistogram1D,opt:";P;P0;E;E1;E2;same"});a.addDrawFunc({name:"TProfile",icon:"img_profile",func:a.Painter.drawHistogram1D,opt:";E0;E1;E2;p;hist"});a.addDrawFunc({name:/^TH2/,icon:"img_histo2d",func:a.Painter.drawHistogram2D,opt:";COL;COLZ;COL3;LEGO;same"});a.addDrawFunc({name:/^TH3/,icon:"img_histo3d",prereq:"3d",func:"JSROOT.Painter.drawHistogram3D"});a.addDrawFunc({name:"THStack",func:a.Painter.drawHStack});a.addDrawFunc({name:"TF1",icon:"img_graph",func:a.Painter.drawFunction});a.addDrawFunc({name:/^TGraph/,icon:"img_graph",func:a.Painter.drawGraph,opt:";L;P"});a.addDrawFunc({name:"TCutG",icon:"img_graph",func:a.Painter.drawGraph,opt:";L;P"});a.addDrawFunc({name:/^RooHist/,icon:"img_graph",func:a.Painter.drawGraph,opt:";L;P"});a.addDrawFunc({name:/^RooCurve/,icon:"img_graph",func:a.Painter.drawGraph,opt:";L;P"});a.addDrawFunc({name:"TMultiGraph",func:a.Painter.drawMultiGraph});a.addDrawFunc({name:"TStreamerInfoList",icon:"img_question",func:a.Painter.drawStreamerInfo});a.addDrawFunc({name:"TPaletteAxis",func:a.Painter.drawPaletteAxis});a.addDrawFunc({name:"kind:Text",icon:"img_text",func:a.Painter.drawRawText});a.addDrawFunc({name:"TEllipse",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawEllipse"});a.addDrawFunc({name:"TLine",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawLine"});a.addDrawFunc({name:"TArrow",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawArrow"});a.addDrawFunc({name:"kind:Command",icon:"img_execute",execute:true});a.addDrawFunc({name:"TFolder",icon:"img_folder",icon2:"img_folderopen"});a.addDrawFunc({name:"TTree",icon:"img_tree"});a.addDrawFunc({name:"TNtuple",icon:"img_tree"});a.addDrawFunc({name:"TBranch",icon:"img_branch"});a.addDrawFunc({name:/^TLeaf/,icon:"img_leaf"});a.addDrawFunc({name:"TFile",icon:"img_file"});a.addDrawFunc({name:"TMemFile",icon:"img_file"});a.addDrawFunc({name:"Session",icon:"img_globe"});a.addDrawFunc({name:"kind:TopFolder",icon:"img_base"});a.getDrawHandle=function(e,f){if(typeof e!="string"){return null}if(f===""){f=null}var l=null;if((f==null)&&(e in a.DrawFuncs.cache)){return a.DrawFuncs.cache[e]}var n=(e.indexOf("ROOT.")==0)?e.substr(5):"kind:"+e;var d=0;for(var k in a.DrawFuncs.lst){var m=a.DrawFuncs.lst[k];if(typeof m.name=="string"){if(m.name!=n){continue}}else{if(!n.match(m.name)){continue}}if(f==null){if(!(e in a.DrawFuncs.cache)){a.DrawFuncs.cache[e]=m}return m}else{if(typeof f=="string"){if(l==null){l=m}if("opt" in m){var c=m.opt.split(";");for(var g in c){c[g]=c[g].toLowerCase()}if(c.indexOf(f.toLowerCase())>=0){return m}}}else{if(f===d){return m}}}d++}return l};a.getDrawOptions=function(g,c){if(typeof g!="string"){return null}var l=null,k=false;for(var e=0;e<1000;e++){var f=a.getDrawHandle(g,e);if(f==null){break}k=true;if(!("opt" in f)){continue}var j=f.opt.split(";");for(var d in j){j[d]=j[d].toLowerCase();if((c=="nosame")&&(j[d].indexOf("same")==0)){continue}if(l==null){l=[]}if(l.indexOf(j[d])<0){l.push(j[d])}}}if(k&&(l==null)){l=new Array;l.push("")}return l};a.canDraw=function(c){return a.getDrawHandle("ROOT."+c)!=null};a.draw=function(i,g,d){if((g==null)||(typeof g!="object")){return null}var h=null,j=null;if("_typename" in g){h=a.getDrawHandle("ROOT."+g._typename,d)}else{if("_kind" in g){h=a.getDrawHandle(g._kind,d)}}if((h==null)||!("func" in h)){return null}function c(){if((j==null)&&("painter_kind" in h)){j=(h.painter_kind=="base")?new a.TBasePainter():new a.TObjectPainter()}return h.func(i,g,d,j)}if(typeof h.func=="function"){return c()}var f="",k="";if(typeof h.func=="object"){if("func" in h.func){f=h.func.func}if("script" in h.func){k="user:"+h.func.script}}else{if(typeof h.func=="string"){f=h.func;if(("prereq" in h)&&(typeof h.prereq=="string")){k=h.prereq}if(("script" in h)&&(typeof h.script=="string")){k+=";user:"+h.script}}}if(f.length==0){return null}if(k.length>0){if(!("painter_kind" in h)){h.painter_kind=(f.indexOf("JSROOT.Painter")==0)?"object":"base"}j=(h.painter_kind=="base")?new a.TBasePainter():new a.TObjectPainter();a.AssertPrerequisites(k,function(){var m=a.findFunction(f);if(m==null){alert("Fail to find function "+f+" after loading "+k);return null}h.func=m;var l=c();if(l!==j){alert("Painter function "+f+" do not follow rules of dynamicaly loaded painters")}});return j}var e=a.findFunction(f);if(e==null){return null}h.func=e;return c()};a.redraw=function(j,g,e){if(g==null){return}var f=new a.TObjectPainter();f.SetDivId(j,-1);var c=f.pad_painter();if(c!=null){if(g._typename=="TCanvas"){c.RedrawObject(g);return c}for(var d in c.painters){var h=c.painters[d].GetObject();if((h!=null)&&(h._typename==g._typename)){if(c.painters[d].UpdateObject(g)){c.RedrawPad();return c.painters[d]}}}}if(c){a.console("Cannot find painter to update object of type "+g._typename)}f.select_main().html("");return a.draw(j,g,e)};return a}));