(function(a){if(typeof define==="function"&&define.amd){define(["d3","JSRootPainter"],a)}else{if(typeof d3!="object"){var b=new Error("This extension requires d3.v3.js");b.source="JSRootPainter.jquery.js";throw b}if(typeof JSROOT=="undefined"){var b=new Error("JSROOT is not defined");b.source="JSRootPainter.jquery.js";throw b}if(typeof JSROOT.Painter!="object"){var b=new Error("JSROOT.Painter not defined");b.source="JSRootPainter.jquery.js";throw b}a(d3,JSROOT)}}(function(b,a){a.Painter.drawEllipse=function(f,e,d,c){c.ellipse=e;c.SetDivId(f);c.UpdateObject=function(g){a.extend(this.ellipse,g)};c.Redraw=function(){var o=a.Painter.createAttLine(this.ellipse);var n=this.createAttFill(this.ellipse);this.RecreateDrawG(this.main_painter()==null);var s=this.AxisToSvg("x",this.ellipse.fX1);var q=this.AxisToSvg("y",this.ellipse.fY1);var j=this.AxisToSvg("x",this.ellipse.fX1+this.ellipse.fR1)-s;var h=q-this.AxisToSvg("y",this.ellipse.fY1+this.ellipse.fR2);if((this.ellipse.fPhimin==0)&&(this.ellipse.fPhimax==360)&&(this.ellipse.fTheta==0)){this.draw_g.append("svg:ellipse").attr("cx",s.toFixed(1)).attr("cy",q.toFixed(1)).attr("rx",j.toFixed(1)).attr("ry",h.toFixed(1)).call(o.func).call(n.func);return}var m=Math.cos(Math.PI*this.ellipse.fTheta/180);var v=Math.sin(Math.PI*this.ellipse.fTheta/180);var u=j*Math.cos(this.ellipse.fPhimin*Math.PI/180);var l=h*Math.sin(this.ellipse.fPhimin*Math.PI/180);var i=u*m-l*v;var r=-u*v-l*m;var t=j*Math.cos(this.ellipse.fPhimax*Math.PI/180);var k=h*Math.sin(this.ellipse.fPhimax*Math.PI/180);var g=t*m-k*v;var p=-t*v-k*m;this.draw_g.attr("transform","translate("+s.toFixed(1)+","+q.toFixed(1)+")").append("svg:path").attr("d","M 0,0 L "+i.toFixed(1)+","+r.toFixed(1)+" A "+j.toFixed(1)+" "+h.toFixed(1)+" "+-this.ellipse.fTheta.toFixed(1)+" 1 0 "+g.toFixed(1)+","+p.toFixed(1)+" L 0,0 Z").call(o.func).call(n.func)};c.Redraw();return c.DrawingReady()};a.Painter.drawLine=function(f,e,d,c){c.line=e;c.SetDivId(f);c.UpdateObject=function(g){a.extend(this.line,g)};c.Redraw=function(){var g=a.Painter.createAttLine(this.line);this.RecreateDrawG(this.main_painter()==null);var i=this.AxisToSvg("x",this.line.fX1);var k=this.AxisToSvg("y",this.line.fY1);var h=this.AxisToSvg("x",this.line.fX2);var j=this.AxisToSvg("y",this.line.fY2);this.draw_g.append("svg:line").attr("x1",i.toFixed(1)).attr("y1",k.toFixed(1)).attr("x2",h.toFixed(1)).attr("y2",j.toFixed(1)).call(g.func)};c.Redraw();return c.DrawingReady()};a.Painter.drawArrow=function(f,e,d,c){c.arrow=e;c.SetDivId(f);c.UpdateObject=function(g){a.extend(this.arrow,g)};c.Redraw=function(){var B=a.Painter.createAttLine(this.arrow);var v=this.createAttFill(this.arrow);var g=Math.max(this.pad_width(),this.pad_height())*this.arrow.fArrowSize;if(g<3){g=3}var w=g*Math.tan(this.arrow.fAngle/2*(Math.PI/180));this.RecreateDrawG(this.main_painter()==null);var z=this.AxisToSvg("x",this.arrow.fX1);var l=this.AxisToSvg("y",this.arrow.fY1);var y=this.AxisToSvg("x",this.arrow.fX2);var j=this.AxisToSvg("y",this.arrow.fY2);var h="M0,0 L"+g.toFixed(1)+","+w.toFixed(1)+" L0,"+(w*2).toFixed(1);var r="M"+g.toFixed(1)+", 0 L 0,"+w.toFixed(1)+" L "+g.toFixed(1)+","+(w*2).toFixed(1);var n=null,o=null,t=null,i=null;var s=this.arrow.fOption;var x=s.length;if(s.indexOf("<")==0){var k=(s.indexOf("<|")==0);if(!i){i=this.draw_g.append("defs")}n="jsroot_arrowmarker_"+a.Painter.arrowcnt++;var q=i.append("svg:marker").attr("id",n).attr("markerWidth",g.toFixed(1)).attr("markerHeight",(w*2).toFixed(1)).attr("refX","0").attr("refY",w.toFixed(1)).attr("orient","auto").attr("markerUnits","userSpaceOnUse").append("svg:path").style("fill","none").attr("d",r+(k?" Z":"")).call(B.func);if(k){q.call(v.func)}}var p=0;if(s.indexOf("->-")>=0){p=1}else{if(s.indexOf("-|>-")>=0){p=11}else{if(s.indexOf("-<-")>=0){p=2}else{if(s.indexOf("-<|-")>=0){p=12}}}}if(p>0){var k=p>10;if(!i){i=this.draw_g.append("defs")}o="jsroot_arrowmarker_"+a.Painter.arrowcnt++;var A=i.append("svg:marker").attr("id",o).attr("markerWidth",g.toFixed(1)).attr("markerHeight",(w*2).toFixed(1)).attr("refX",(g*0.5).toFixed(1)).attr("refY",w.toFixed(1)).attr("orient","auto").attr("markerUnits","userSpaceOnUse").append("svg:path").style("fill","none").attr("d",((p%10==1)?h:r)+((p>10)?" Z":"")).call(B.func);if(p>10){A.call(v.func)}}if(s.lastIndexOf(">")==x-1){var k=(s.lastIndexOf("|>")==x-2)&&(x>1);if(!i){i=this.draw_g.append("defs")}t="jsroot_arrowmarker_"+a.Painter.arrowcnt++;var m=i.append("svg:marker").attr("id",t).attr("markerWidth",g.toFixed(1)).attr("markerHeight",(w*2).toFixed(1)).attr("refX",g.toFixed(1)).attr("refY",w.toFixed(1)).attr("orient","auto").attr("markerUnits","userSpaceOnUse").append("svg:path").style("fill","none").attr("d",h+(k?" Z":"")).call(B.func);if(k){m.call(v.func)}}var u=this.draw_g.append("svg:path").attr("d","M"+z.toFixed(1)+","+l.toFixed(1)+((o==null)?"":"L"+(z/2+y/2).toFixed(1)+","+(l/2+j/2).toFixed(1))+" L"+y.toFixed(1)+","+j.toFixed(1)).call(B.func);if(n!=null){u.style("marker-start","url(#"+n+")")}if(o!=null){u.style("marker-mid","url(#"+o+")")}if(t!=null){u.style("marker-end","url(#"+t+")")}};if(!("arrowcnt" in a.Painter)){a.Painter.arrowcnt=0}c.Redraw();return c.DrawingReady()};return a.Painter}));